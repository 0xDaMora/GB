"use strict";var windowStacks=[];function windowCreate(t,e){var i=new windowStack(document.getElementById(t));return e&&i.show(),i}function windowStack(t){if(null!=t&&"object"==typeof t){this.lastOpacity=null,this.domObject=t,this.hadFocus=!0,this.hookedMouse=!1;var e=this;this.events=[["mousedown",function(t){e.dragEnable(t)}],["mousemove",function(t){e.drag(t)}],["mouseup",function(t){e.dragDisable()}]]}}function popupMenu(t,e){this.clickElement=t,this.menuElement=e;var i=this;this.eventHandle=[function(t){i.startPopup(t)},function(t){i.endPopup(t)}],this.open=!1,addEvent("click",this.clickElement,this.eventHandle[0])}windowStack.prototype.registerMouseEvents=function(){if(!this.hookedMouse){this.hookedMouse=!0;var t=null;for(t in this.events)addEvent(this.events[t][0],document,this.events[t][1]);this.center()}},windowStack.prototype.unregisterMouseEvents=function(){if(this.hookedMouse){this.hookedMouse=!1;var t=null;for(t in this.events)removeEvent(this.events[t][0],document,this.events[t][1])}},windowStack.prototype.getStyleFloatOf=function(t,e){try{var i=window.getComputedStyle(this.domObject,null).getPropertyValue(t)}catch(o){try{var i=this.domObject.currentStyle.getAttribute(e)}catch(s){cout(s.message,2)}}var n=parseFloat(null!=i&&i.length?i:"0");return isNaN(n)||-1==n?0:n},windowStack.prototype.dragEnable=function(t){var e=document.elementFromPoint(t.clientX,t.clientY);this.leftPos=this.getStyleFloatOf("left","left"),this.topPos=this.getStyleFloatOf("top","top");var i=this.leftPos+this.domObject.offsetWidth-document.documentElement.scrollLeft-document.getElementsByTagName("body")[0].scrollLeft,o=this.topPos+this.domObject.offsetHeight-document.documentElement.scrollTop-document.getElementsByTagName("body")[0].scrollTop,s=isSameNode(e,this.domObject);this.mousedInsideWindow=!s&&isDescendantOf(this.domObject,e),s||this.mousedInsideWindow?(this.movable=!0,this.leftLast=t.clientX,this.topLast=t.clientY,this.domObject.style.zIndex=2,i-this.leftLast<25&&o-this.topLast<25?this.resize=!0:this.resize=!1,this.coordDiffLeft=this.leftLast-this.leftPos,this.coordDiffTop=this.topLast-this.topPos,this.lastLeft=0,this.lastTop=0):this.lostFocus()},windowStack.prototype.drag=function(t){if(this.movable){if(this.lastLeft+=t.clientX-this.coordDiffLeft,this.lastTop+=t.clientY-this.coordDiffTop,this.resize){var e=this.domObject.clientWidth+t.clientX-this.leftLast-this.getStyleFloatOf("padding-left","paddingLeft")-this.getStyleFloatOf("padding-right","paddingRight"),i=this.domObject.clientHeight+t.clientY-this.topLast-this.getStyleFloatOf("padding-top","paddingTop")-this.getStyleFloatOf("padding-bottom","paddingBottom");this.getStyleFloatOf("min-width","minWidth")<=e&&this.getStyleFloatOf("min-height","minHeight")<=i&&(this.getStyleFloatOf("max-width","maxWidth")>=e||0==this.getStyleFloatOf("max-width","maxWidth"))&&(this.getStyleFloatOf("max-height","maxHeight")>=i||0==this.getStyleFloatOf("max-height","maxHeight"))&&(this.domObject.style.width=e+"px",this.domObject.style.height=i+"px")}else this.mousedInsideWindow||(this.domObject.style.left=this.lastLeft+"px",this.domObject.style.top=this.lastTop+"px");this.coordDiffLeft=this.leftLast=t.clientX,this.coordDiffTop=this.topLast=t.clientY}},windowStack.prototype.dragDisable=function(){this.movable=!1,this.hadFocus=!0},windowStack.prototype.lostFocus=function(){this.hadFocus&&(this.domObject.style.zIndex=1,this.hadFocus=!1)},windowStack.prototype.interceptOpacity=function(){if(null!=this.lastOpacity)return this.lastOpacity.bDoneRun=!0,this.lastOpacity.RefOpacityAREABegin;var t=100*this.getStyleFloatOf("opacity","opacity");return t>0?t:100},windowStack.prototype.center=function(){var t=Math.max(document.documentElement.clientWidth,document.getElementsByTagName("body")[0].clientWidth),e=Math.max(document.documentElement.clientHeight,document.getElementsByTagName("body")[0].clientHeight),i=Math.max(document.documentElement.scrollLeft,document.getElementsByTagName("body")[0].scrollLeft),o=Math.max(document.documentElement.scrollTop,document.getElementsByTagName("body")[0].scrollTop);this.domObject.style.left=Math.round((t-this.domObject.offsetWidth)/2+i)+"px",this.domObject.style.top=Math.round((e-this.domObject.offsetHeight)/2+o)+"px"},windowStack.prototype.hide=function(){this.domObject.style.display="none",this.unregisterMouseEvents()},windowStack.prototype.show=function(){this.domObject.style.display="block",this.registerMouseEvents()},popupMenu.prototype.startPopup=function(t){this.open||(this.open=!0,this.menuElement.style.display="block",removeEvent("click",this.clickElement,this.eventHandle[0]),this.position(t),addEvent("mouseout",this.menuElement,this.eventHandle[1]))},popupMenu.prototype.endPopup=function(t){this.open&&mouseLeaveVerify(this.menuElement,t)&&(this.open=!1,this.menuElement.style.display="none",removeEvent("mouseout",this.menuElement,this.eventHandle[1]),addEvent("click",this.clickElement,this.eventHandle[0]))},popupMenu.prototype.position=function(t){this.open&&(this.menuElement.style.left=pageXCoord(t)-5+"px",this.menuElement.style.top=pageYCoord(t)-5+"px")};