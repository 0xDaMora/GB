"use strict";function GameBoyCore(e,t){this.canvas=e,this.drawContext=null,this.ROMImage=t,this.registerA=1,this.FZero=!0,this.FSubtract=!1,this.FHalfCarry=!0,this.FCarry=!0,this.registerB=0,this.registerC=19,this.registerD=0,this.registerE=216,this.registersHL=333,this.stackPointer=65534,this.programCounter=256,this.CPUCyclesTotal=0,this.CPUCyclesTotalBase=0,this.CPUCyclesTotalCurrent=0,this.CPUCyclesTotalRoundoff=0,this.baseCPUCyclesPerIteration=0,this.remainingClocks=0,this.inBootstrap=!0,this.usedBootROM=!1,this.usedGBCBootROM=!1,this.halt=!1,this.skipPCIncrement=!1,this.stopEmulator=3,this.IME=!0,this.IRQLineMatched=0,this.interruptsRequested=0,this.interruptsEnabled=0,this.hdmaRunning=!1,this.CPUTicks=0,this.doubleSpeedShifter=0,this.JoyPad=255,this.CPUStopped=!1,this.memoryReader=[],this.memoryWriter=[],this.memoryHighReader=[],this.memoryHighWriter=[],this.ROM=[],this.memory=[],this.MBCRam=[],this.VRAM=[],this.GBCMemory=[],this.MBC1Mode=!1,this.MBCRAMBanksEnabled=!1,this.currMBCRAMBank=0,this.currMBCRAMBankPosition=-40960,this.cGBC=!1,this.gbcRamBank=1,this.gbcRamBankPosition=-53248,this.gbcRamBankPositionECHO=-61440,this.RAMBanks=[0,1,2,4,16],this.ROMBank1offs=0,this.currentROMBank=0,this.cartridgeType=0,this.name="",this.gameCode="",this.fromSaveState=!1,this.savedStateFileName="",this.STATTracker=0,this.modeSTAT=0,this.spriteCount=252,this.LYCMatchTriggerSTAT=!1,this.mode2TriggerSTAT=!1,this.mode1TriggerSTAT=!1,this.mode0TriggerSTAT=!1,this.LCDisOn=!1,this.LINECONTROL=[],this.DISPLAYOFFCONTROL=[function(e){}],this.LCDCONTROL=null,this.initializeLCDController(),this.RTCisLatched=!1,this.latchedSeconds=0,this.latchedMinutes=0,this.latchedHours=0,this.latchedLDays=0,this.latchedHDays=0,this.RTCSeconds=0,this.RTCMinutes=0,this.RTCHours=0,this.RTCDays=0,this.RTCDayOverFlow=!1,this.RTCHALT=!1,this.highX=127,this.lowX=127,this.highY=127,this.lowY=127,this.audioHandle=null,this.numSamplesTotal=0,this.dutyLookup=[[!1,!1,!1,!1,!1,!1,!1,!0],[!0,!1,!1,!1,!1,!1,!1,!0],[!0,!1,!1,!1,!1,!0,!0,!0],[!1,!0,!0,!0,!0,!0,!0,!1]],this.bufferContainAmount=0,this.LSFR15Table=null,this.LSFR7Table=null,this.noiseSampleTable=null,this.initializeAudioStartState(),this.soundMasterEnabled=!1,this.channel3PCM=null,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.leftChannel1=!1,this.leftChannel2=!1,this.leftChannel3=!1,this.leftChannel4=!1,this.rightChannel1=!1,this.rightChannel2=!1,this.rightChannel3=!1,this.rightChannel4=!1,this.audioClocksUntilNextEvent=1,this.audioClocksUntilNextEventCounter=1,this.channel1currentSampleLeft=0,this.channel1currentSampleRight=0,this.channel2currentSampleLeft=0,this.channel2currentSampleRight=0,this.channel3currentSampleLeft=0,this.channel3currentSampleRight=0,this.channel4currentSampleLeft=0,this.channel4currentSampleRight=0,this.channel1currentSampleLeftSecondary=0,this.channel1currentSampleRightSecondary=0,this.channel2currentSampleLeftSecondary=0,this.channel2currentSampleRightSecondary=0,this.channel3currentSampleLeftSecondary=0,this.channel3currentSampleRightSecondary=0,this.channel4currentSampleLeftSecondary=0,this.channel4currentSampleRightSecondary=0,this.channel1currentSampleLeftTrimary=0,this.channel1currentSampleRightTrimary=0,this.channel2currentSampleLeftTrimary=0,this.channel2currentSampleRightTrimary=0,this.mixerOutputCache=0,this.emulatorSpeed=1,this.initializeTiming(),this.audioTicks=0,this.audioIndex=0,this.downsampleInput=0,this.audioDestinationPosition=0,this.rollover=0,this.emulatorTicks=0,this.DIVTicks=56,this.LCDTicks=60,this.timerTicks=0,this.TIMAEnabled=!1,this.TACClocker=1024,this.serialTimer=0,this.serialShiftTimer=0,this.serialShiftTimerAllocated=0,this.IRQEnableDelay=0;var r=new Date;this.lastIteration=r.getTime(),r=new Date,this.firstIteration=r.getTime(),this.iterations=0,this.actualScanLine=0,this.lastUnrenderedLine=0,this.queuedScanLines=0,this.totalLinesPassed=0,this.haltPostClocks=0,this.cMBC1=!1,this.cMBC2=!1,this.cMBC3=!1,this.cMBC5=!1,this.cMBC7=!1,this.cSRAM=!1,this.cMMMO1=!1,this.cRUMBLE=!1,this.cCamera=!1,this.cTAMA5=!1,this.cHuC3=!1,this.cHuC1=!1,this.cTIMER=!1,this.ROMBanks=[2,4,8,16,32,64,128,256,512],this.ROMBanks[82]=72,this.ROMBanks[83]=80,this.ROMBanks[84]=96,this.numRAMBanks=0,this.currVRAMBank=0,this.backgroundX=0,this.backgroundY=0,this.gfxWindowDisplay=!1,this.gfxSpriteShow=!1,this.gfxSpriteNormalHeight=!0,this.bgEnabled=!0,this.BGPriorityEnabled=!0,this.gfxWindowCHRBankPosition=0,this.gfxBackgroundCHRBankPosition=0,this.gfxBackgroundBankOffset=128,this.windowY=0,this.windowX=0,this.drewBlank=0,this.drewFrame=!1,this.midScanlineOffset=-1,this.pixelEnd=0,this.currentX=0,this.BGCHRBank1=null,this.BGCHRBank2=null,this.BGCHRCurrentBank=null,this.tileCache=null,this.colors=[15728606,11392916,5411443,1586242],this.OBJPalette=null,this.BGPalette=null,this.gbcOBJRawPalette=null,this.gbcBGRawPalette=null,this.gbOBJPalette=null,this.gbBGPalette=null,this.gbcOBJPalette=null,this.gbcBGPalette=null,this.gbBGColorizedPalette=null,this.gbOBJColorizedPalette=null,this.cachedBGPaletteConversion=null,this.cachedOBJPaletteConversion=null,this.updateGBBGPalette=this.updateGBRegularBGPalette,this.updateGBOBJPalette=this.updateGBRegularOBJPalette,this.colorizedGBPalettes=!1,this.BGLayerRender=null,this.WindowLayerRender=null,this.SpriteLayerRender=null,this.frameBuffer=[],this.swizzledFrame=null,this.canvasBuffer=null,this.pixelStart=0,this.onscreenWidth=this.offscreenWidth=160,this.onscreenHeight=this.offscreenHeight=144,this.offscreenRGBCount=this.onscreenWidth*this.onscreenHeight*4,this.resizePathClear=!0,this.intializeWhiteNoise()}GameBoyCore.prototype.GBBOOTROM=[],GameBoyCore.prototype.GBCBOOTROM=[],GameBoyCore.prototype.ffxxDump=[15,0,124,255,0,0,0,248,255,255,255,255,255,255,255,1,128,191,243,255,191,255,63,0,255,191,127,255,159,255,191,255,255,0,0,191,119,243,241,255,255,255,255,255,255,255,255,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,145,128,0,0,0,0,0,252,0,0,0,0,255,126,255,254,255,255,255,255,255,255,62,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,255,193,0,254,255,255,255,248,255,0,0,0,143,0,0,255,255,255,255,255,255,255,255,206,237,102,102,204,13,0,11,3,115,0,131,0,12,0,13,0,8,17,31,136,137,0,14,220,204,110,230,221,221,217,153,187,187,103,99,110,14,236,204,221,220,153,159,187,185,51,62,69,236,82,250,8,183,7,93,1,253,192,255,8,252,0,229,11,248,194,206,244,249,15,127,69,109,61,254,70,151,51,94,8,239,241,255,134,131,36,116,18,252,0,159,180,183,6,213,208,122,0,158,4,95,65,47,29,119,54,117,129,170,112,58,152,209,113,2,77,1,193,255,13,0,211,5,249,0,11,0],GameBoyCore.prototype.OPCODE=[function(e){},function(e){e.registerC=e.memoryReader[e.programCounter](e,e.programCounter),e.registerB=e.memoryRead(e.programCounter+1&65535),e.programCounter=e.programCounter+2&65535},function(e){e.memoryWrite(e.registerB<<8|e.registerC,e.registerA)},function(e){var t=(e.registerB<<8|e.registerC)+1;e.registerB=t>>8&255,e.registerC=255&t},function(e){e.registerB=e.registerB+1&255,e.FZero=0==e.registerB,e.FHalfCarry=(15&e.registerB)==0,e.FSubtract=!1},function(e){e.registerB=e.registerB-1&255,e.FZero=0==e.registerB,e.FHalfCarry=(15&e.registerB)==15,e.FSubtract=!0},function(e){e.registerB=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){e.FCarry=e.registerA>127,e.registerA=e.registerA<<1&255|e.registerA>>7,e.FZero=e.FSubtract=e.FHalfCarry=!1},function(e){var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.memoryWrite(t,255&e.stackPointer),e.memoryWrite(t+1&65535,e.stackPointer>>8)},function(e){var t=e.registersHL+(e.registerB<<8|e.registerC);e.FHalfCarry=(4095&e.registersHL)>(4095&t),e.FCarry=t>65535,e.registersHL=65535&t,e.FSubtract=!1},function(e){e.registerA=e.memoryRead(e.registerB<<8|e.registerC)},function(e){var t=(e.registerB<<8|e.registerC)-1&65535;e.registerB=t>>8,e.registerC=255&t},function(e){e.registerC=e.registerC+1&255,e.FZero=0==e.registerC,e.FHalfCarry=(15&e.registerC)==0,e.FSubtract=!1},function(e){e.registerC=e.registerC-1&255,e.FZero=0==e.registerC,e.FHalfCarry=(15&e.registerC)==15,e.FSubtract=!0},function(e){e.registerC=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){e.registerA=e.registerA>>1|(1&e.registerA)<<7,e.FCarry=e.registerA>127,e.FZero=e.FSubtract=e.FHalfCarry=!1},function(e){e.cGBC&&(1&e.memory[65357])==1?(e.memory[65357]>127?(cout("Going into single clock speed mode.",0),e.doubleSpeedShifter=0,e.memory[65357]&=127):(cout("Going into double clock speed mode.",0),e.doubleSpeedShifter=1,e.memory[65357]|=128),e.memory[65357]&=254):e.handleSTOP()},function(e){e.registerE=e.memoryReader[e.programCounter](e,e.programCounter),e.registerD=e.memoryRead(e.programCounter+1&65535),e.programCounter=e.programCounter+2&65535},function(e){e.memoryWrite(e.registerD<<8|e.registerE,e.registerA)},function(e){var t=(e.registerD<<8|e.registerE)+1;e.registerD=t>>8&255,e.registerE=255&t},function(e){e.registerD=e.registerD+1&255,e.FZero=0==e.registerD,e.FHalfCarry=(15&e.registerD)==0,e.FSubtract=!1},function(e){e.registerD=e.registerD-1&255,e.FZero=0==e.registerD,e.FHalfCarry=(15&e.registerD)==15,e.FSubtract=!0},function(e){e.registerD=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){var t=e.FCarry?1:0;e.FCarry=e.registerA>127,e.registerA=e.registerA<<1&255|t,e.FZero=e.FSubtract=e.FHalfCarry=!1},function(e){e.programCounter=e.programCounter+(e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24)+1&65535},function(e){var t=e.registersHL+(e.registerD<<8|e.registerE);e.FHalfCarry=(4095&e.registersHL)>(4095&t),e.FCarry=t>65535,e.registersHL=65535&t,e.FSubtract=!1},function(e){e.registerA=e.memoryRead(e.registerD<<8|e.registerE)},function(e){var t=(e.registerD<<8|e.registerE)-1&65535;e.registerD=t>>8,e.registerE=255&t},function(e){e.registerE=e.registerE+1&255,e.FZero=0==e.registerE,e.FHalfCarry=(15&e.registerE)==0,e.FSubtract=!1},function(e){e.registerE=e.registerE-1&255,e.FZero=0==e.registerE,e.FHalfCarry=(15&e.registerE)==15,e.FSubtract=!0},function(e){e.registerE=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){var t=e.FCarry?128:0;e.FCarry=(1&e.registerA)==1,e.registerA=e.registerA>>1|t,e.FZero=e.FSubtract=e.FHalfCarry=!1},function(e){e.FZero?e.programCounter=e.programCounter+1&65535:(e.programCounter=e.programCounter+(e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24)+1&65535,e.CPUTicks+=4)},function(e){e.registersHL=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+2&65535},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerA),e.registersHL=e.registersHL+1&65535},function(e){e.registersHL=e.registersHL+1&65535},function(e){var t=(e.registersHL>>8)+1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==0,e.FSubtract=!1,e.registersHL=t<<8|255&e.registersHL},function(e){var t=(e.registersHL>>8)-1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==15,e.FSubtract=!0,e.registersHL=t<<8|255&e.registersHL},function(e){e.registersHL=e.memoryReader[e.programCounter](e,e.programCounter)<<8|255&e.registersHL,e.programCounter=e.programCounter+1&65535},function(e){e.FSubtract?e.FCarry&&e.FHalfCarry?(e.registerA=e.registerA+154&255,e.FHalfCarry=!1):e.FCarry?e.registerA=e.registerA+160&255:e.FHalfCarry&&(e.registerA=e.registerA+250&255,e.FHalfCarry=!1):((e.FCarry||e.registerA>153)&&(e.registerA=e.registerA+96&255,e.FCarry=!0),(e.FHalfCarry||(15&e.registerA)>9)&&(e.registerA=e.registerA+6&255,e.FHalfCarry=!1)),e.FZero=0==e.registerA},function(e){e.FZero?(e.programCounter=e.programCounter+(e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24)+1&65535,e.CPUTicks+=4):e.programCounter=e.programCounter+1&65535},function(e){e.FHalfCarry=(4095&e.registersHL)>2047,e.FCarry=e.registersHL>32767,e.registersHL=e.registersHL<<1&65535,e.FSubtract=!1},function(e){e.registerA=e.memoryReader[e.registersHL](e,e.registersHL),e.registersHL=e.registersHL+1&65535},function(e){e.registersHL=e.registersHL-1&65535},function(e){var t=e.registersHL+1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==0,e.FSubtract=!1,e.registersHL=65280&e.registersHL|t},function(e){var t=e.registersHL-1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==15,e.FSubtract=!0,e.registersHL=65280&e.registersHL|t},function(e){e.registersHL=65280&e.registersHL|e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){e.registerA^=255,e.FSubtract=e.FHalfCarry=!0},function(e){e.FCarry?e.programCounter=e.programCounter+1&65535:(e.programCounter=e.programCounter+(e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24)+1&65535,e.CPUTicks+=4)},function(e){e.stackPointer=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+2&65535},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerA),e.registersHL=e.registersHL-1&65535},function(e){e.stackPointer=e.stackPointer+1&65535},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL)+1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==0,e.FSubtract=!1,e.memoryWriter[e.registersHL](e,e.registersHL,t)},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL)-1&255;e.FZero=0==t,e.FHalfCarry=(15&t)==15,e.FSubtract=!0,e.memoryWriter[e.registersHL](e,e.registersHL,t)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.memoryReader[e.programCounter](e,e.programCounter)),e.programCounter=e.programCounter+1&65535},function(e){e.FCarry=!0,e.FSubtract=e.FHalfCarry=!1},function(e){e.FCarry?(e.programCounter=e.programCounter+(e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24)+1&65535,e.CPUTicks+=4):e.programCounter=e.programCounter+1&65535},function(e){var t=e.registersHL+e.stackPointer;e.FHalfCarry=(4095&e.registersHL)>(4095&t),e.FCarry=t>65535,e.registersHL=65535&t,e.FSubtract=!1},function(e){e.registerA=e.memoryReader[e.registersHL](e,e.registersHL),e.registersHL=e.registersHL-1&65535},function(e){e.stackPointer=e.stackPointer-1&65535},function(e){e.registerA=e.registerA+1&255,e.FZero=0==e.registerA,e.FHalfCarry=(15&e.registerA)==0,e.FSubtract=!1},function(e){e.registerA=e.registerA-1&255,e.FZero=0==e.registerA,e.FHalfCarry=(15&e.registerA)==15,e.FSubtract=!0},function(e){e.registerA=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535},function(e){e.FCarry=!e.FCarry,e.FSubtract=e.FHalfCarry=!1},function(e){},function(e){e.registerB=e.registerC},function(e){e.registerB=e.registerD},function(e){e.registerB=e.registerE},function(e){e.registerB=e.registersHL>>8},function(e){e.registerB=255&e.registersHL},function(e){e.registerB=e.memoryReader[e.registersHL](e,e.registersHL)},function(e){e.registerB=e.registerA},function(e){e.registerC=e.registerB},function(e){},function(e){e.registerC=e.registerD},function(e){e.registerC=e.registerE},function(e){e.registerC=e.registersHL>>8},function(e){e.registerC=255&e.registersHL},function(e){e.registerC=e.memoryReader[e.registersHL](e,e.registersHL)},function(e){e.registerC=e.registerA},function(e){e.registerD=e.registerB},function(e){e.registerD=e.registerC},function(e){},function(e){e.registerD=e.registerE},function(e){e.registerD=e.registersHL>>8},function(e){e.registerD=255&e.registersHL},function(e){e.registerD=e.memoryReader[e.registersHL](e,e.registersHL)},function(e){e.registerD=e.registerA},function(e){e.registerE=e.registerB},function(e){e.registerE=e.registerC},function(e){e.registerE=e.registerD},function(e){},function(e){e.registerE=e.registersHL>>8},function(e){e.registerE=255&e.registersHL},function(e){e.registerE=e.memoryReader[e.registersHL](e,e.registersHL)},function(e){e.registerE=e.registerA},function(e){e.registersHL=e.registerB<<8|255&e.registersHL},function(e){e.registersHL=e.registerC<<8|255&e.registersHL},function(e){e.registersHL=e.registerD<<8|255&e.registersHL},function(e){e.registersHL=e.registerE<<8|255&e.registersHL},function(e){},function(e){e.registersHL=(255&e.registersHL)*257},function(e){e.registersHL=e.memoryReader[e.registersHL](e,e.registersHL)<<8|255&e.registersHL},function(e){e.registersHL=e.registerA<<8|255&e.registersHL},function(e){e.registersHL=65280&e.registersHL|e.registerB},function(e){e.registersHL=65280&e.registersHL|e.registerC},function(e){e.registersHL=65280&e.registersHL|e.registerD},function(e){e.registersHL=65280&e.registersHL|e.registerE},function(e){e.registersHL=65280&e.registersHL|e.registersHL>>8},function(e){},function(e){e.registersHL=65280&e.registersHL|e.memoryReader[e.registersHL](e,e.registersHL)},function(e){e.registersHL=65280&e.registersHL|e.registerA},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerB)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerC)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerD)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerE)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registersHL>>8)},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,255&e.registersHL)},function(e){(e.interruptsEnabled&e.interruptsRequested&31)>0?e.cGBC||e.usedBootROM?e.CPUTicks+=4:e.skipPCIncrement=!0:e.calculateHALTPeriod()},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,e.registerA)},function(e){e.registerA=e.registerB},function(e){e.registerA=e.registerC},function(e){e.registerA=e.registerD},function(e){e.registerA=e.registerE},function(e){e.registerA=e.registersHL>>8},function(e){e.registerA=255&e.registersHL},function(e){e.registerA=e.memoryReader[e.registersHL](e,e.registersHL)},function(e){},function(e){var t=e.registerA+e.registerB;e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerC;e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerD;e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerE;e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+(e.registersHL>>8);e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+(255&e.registersHL);e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.memoryReader[e.registersHL](e,e.registersHL);e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){e.FHalfCarry=(8&e.registerA)==8,e.FCarry=e.registerA>127,e.registerA=e.registerA<<1&255,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerB+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&e.registerB)+(e.FCarry?1:0)>15,e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerC+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&e.registerC)+(e.FCarry?1:0)>15,e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerD+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&e.registerD)+(e.FCarry?1:0)>15,e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA+e.registerE+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&e.registerE)+(e.FCarry?1:0)>15,e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registersHL>>8,r=e.registerA+t+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&t)+(e.FCarry?1:0)>15,e.FCarry=r>255,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=255&e.registersHL,r=e.registerA+t+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&t)+(e.FCarry?1:0)>15,e.FCarry=r>255,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL),r=e.registerA+t+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&t)+(e.FCarry?1:0)>15,e.FCarry=r>255,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA<<1|(e.FCarry?1:0);e.FHalfCarry=(e.registerA<<1&30|(e.FCarry?1:0))>15,e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){var t=e.registerA-e.registerB;e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerC;e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerD;e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerE;e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-(e.registersHL>>8);e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-(255&e.registersHL);e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.memoryReader[e.registersHL](e,e.registersHL);e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){e.registerA=0,e.FHalfCarry=e.FCarry=!1,e.FZero=e.FSubtract=!0},function(e){var t=e.registerA-e.registerB-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&e.registerB)-(e.FCarry?1:0)<0,e.FCarry=t<0,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.registerA-e.registerC-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&e.registerC)-(e.FCarry?1:0)<0,e.FCarry=t<0,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.registerA-e.registerD-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&e.registerD)-(e.FCarry?1:0)<0,e.FCarry=t<0,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.registerA-e.registerE-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&e.registerE)-(e.FCarry?1:0)<0,e.FCarry=t<0,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.registersHL>>8,r=e.registerA-t-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&t)-(e.FCarry?1:0)<0,e.FCarry=r<0,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.registerA-(255&e.registersHL)-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&e.registersHL)-(e.FCarry?1:0)<0,e.FCarry=t<0,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL),r=e.registerA-t-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&t)-(e.FCarry?1:0)<0,e.FCarry=r<0,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){e.FCarry?(e.FZero=!1,e.FSubtract=e.FHalfCarry=e.FCarry=!0,e.registerA=255):(e.FHalfCarry=e.FCarry=!1,e.FSubtract=e.FZero=!0,e.registerA=0)},function(e){e.registerA&=e.registerB,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.registerC,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.registerD,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.registerE,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.registersHL>>8,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.registersHL,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA&=e.memoryReader[e.registersHL](e,e.registersHL),e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.registerA^=e.registerB,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=e.registerC,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=e.registerD,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=e.registerE,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=e.registersHL>>8,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=255&e.registersHL,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA^=e.memoryReader[e.registersHL](e,e.registersHL),e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA=0,e.FZero=!0,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.registerA|=e.registerB,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=e.registerC,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=e.registerD,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=e.registerE,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=e.registersHL>>8,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=255&e.registersHL,e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.registerA|=e.memoryReader[e.registersHL](e,e.registersHL),e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.FZero=0==e.registerA,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){var t=e.registerA-e.registerB;e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerC;e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerD;e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.registerE;e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-(e.registersHL>>8);e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-(255&e.registersHL);e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){var t=e.registerA-e.memoryReader[e.registersHL](e,e.registersHL);e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){e.FHalfCarry=e.FCarry=!1,e.FZero=e.FSubtract=!0},function(e){e.FZero||(e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535,e.CPUTicks+=12)},function(e){e.registerC=e.memoryReader[e.stackPointer](e,e.stackPointer),e.registerB=e.memoryRead(e.stackPointer+1&65535),e.stackPointer=e.stackPointer+2&65535},function(e){e.FZero?e.programCounter=e.programCounter+2&65535:(e.programCounter=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.CPUTicks+=4)},function(e){e.programCounter=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter)},function(e){if(e.FZero)e.programCounter=e.programCounter+2&65535;else{var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=t,e.CPUTicks+=12}},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registerB),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registerC)},function(e){var t=e.registerA+e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535,e.FHalfCarry=(15&t)<(15&e.registerA),e.FCarry=t>255,e.registerA=255&t,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=0},function(e){e.FZero&&(e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535,e.CPUTicks+=12)},function(e){e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535},function(e){e.FZero?(e.programCounter=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.CPUTicks+=4):e.programCounter=e.programCounter+2&65535},function(e){var t=e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535,e.CPUTicks+=e.SecondaryTICKTable[t],e.CBOPCODE[t](e)},function(e){if(e.FZero){var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=t,e.CPUTicks+=12}else e.programCounter=e.programCounter+2&65535},function(e){var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=t},function(e){var t=e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535;var r=e.registerA+t+(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)+(15&t)+(e.FCarry?1:0)>15,e.FCarry=r>255,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!1},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=8},function(e){e.FCarry||(e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535,e.CPUTicks+=12)},function(e){e.registerE=e.memoryReader[e.stackPointer](e,e.stackPointer),e.registerD=e.memoryRead(e.stackPointer+1&65535),e.stackPointer=e.stackPointer+2&65535},function(e){e.FCarry?e.programCounter=e.programCounter+2&65535:(e.programCounter=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.CPUTicks+=4)},function(e){cout("Illegal op code 0xD3 called, pausing emulation.",2),pause()},function(e){if(e.FCarry)e.programCounter=e.programCounter+2&65535;else{var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=t,e.CPUTicks+=12}},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registerD),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registerE)},function(e){var t=e.registerA-e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535,e.FHalfCarry=(15&e.registerA)<(15&t),e.FCarry=t<0,e.registerA=255&t,e.FZero=0==t,e.FSubtract=!0},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=16},function(e){e.FCarry&&(e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535,e.CPUTicks+=12)},function(e){e.programCounter=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535,e.IRQEnableDelay=2==e.IRQEnableDelay||118==e.memoryReader[e.programCounter](e,e.programCounter)?1:2},function(e){e.FCarry?(e.programCounter=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.CPUTicks+=4):e.programCounter=e.programCounter+2&65535},function(e){cout("Illegal op code 0xDB called, pausing emulation.",2),pause()},function(e){if(e.FCarry){var t=e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+2&65535,e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=t,e.CPUTicks+=12}else e.programCounter=e.programCounter+2&65535},function(e){cout("Illegal op code 0xDD called, pausing emulation.",2),pause()},function(e){var t=e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535;var r=e.registerA-t-(e.FCarry?1:0);e.FHalfCarry=(15&e.registerA)-(15&t)-(e.FCarry?1:0)<0,e.FCarry=r<0,e.registerA=255&r,e.FZero=0==e.registerA,e.FSubtract=!0},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=24},function(e){e.memoryHighWrite(e.memoryReader[e.programCounter](e,e.programCounter),e.registerA),e.programCounter=e.programCounter+1&65535},function(e){e.registersHL=e.memoryRead(e.stackPointer+1&65535)<<8|e.memoryReader[e.stackPointer](e,e.stackPointer),e.stackPointer=e.stackPointer+2&65535},function(e){e.memoryHighWriter[e.registerC](e,e.registerC,e.registerA)},function(e){cout("Illegal op code 0xE3 called, pausing emulation.",2),pause()},function(e){cout("Illegal op code 0xE4 called, pausing emulation.",2),pause()},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registersHL>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.registersHL)},function(e){e.registerA&=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535,e.FZero=0==e.registerA,e.FHalfCarry=!0,e.FSubtract=e.FCarry=!1},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=32},function(e){var t=e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24;e.programCounter=e.programCounter+1&65535;var r=e.stackPointer+t&65535;t=e.stackPointer^t^r,e.stackPointer=r,e.FCarry=(256&t)==256,e.FHalfCarry=(16&t)==16,e.FZero=e.FSubtract=!1},function(e){e.programCounter=e.registersHL},function(e){e.memoryWrite(e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter),e.registerA),e.programCounter=e.programCounter+2&65535},function(e){cout("Illegal op code 0xEB called, pausing emulation.",2),pause()},function(e){cout("Illegal op code 0xEC called, pausing emulation.",2),pause()},function(e){cout("Illegal op code 0xED called, pausing emulation.",2),pause()},function(e){e.registerA^=e.memoryReader[e.programCounter](e,e.programCounter),e.programCounter=e.programCounter+1&65535,e.FZero=0==e.registerA,e.FSubtract=e.FHalfCarry=e.FCarry=!1},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=40},function(e){e.registerA=e.memoryHighRead(e.memoryReader[e.programCounter](e,e.programCounter)),e.programCounter=e.programCounter+1&65535},function(e){var t=e.memoryReader[e.stackPointer](e,e.stackPointer);e.FZero=t>127,e.FSubtract=(64&t)==64,e.FHalfCarry=(32&t)==32,e.FCarry=(16&t)==16,e.registerA=e.memoryRead(e.stackPointer+1&65535),e.stackPointer=e.stackPointer+2&65535},function(e){e.registerA=e.memoryHighReader[e.registerC](e,e.registerC)},function(e){e.IME=!1,e.IRQEnableDelay=0},function(e){cout("Illegal op code 0xF4 called, pausing emulation.",2),pause()},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.registerA),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,(e.FZero?128:0)|(e.FSubtract?64:0)|(e.FHalfCarry?32:0)|(e.FCarry?16:0))},function(e){e.registerA|=e.memoryReader[e.programCounter](e,e.programCounter),e.FZero=0==e.registerA,e.programCounter=e.programCounter+1&65535,e.FSubtract=e.FCarry=e.FHalfCarry=!1},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=48},function(e){var t=e.memoryReader[e.programCounter](e,e.programCounter)<<24>>24;e.programCounter=e.programCounter+1&65535,e.registersHL=e.stackPointer+t&65535,t=e.stackPointer^t^e.registersHL,e.FCarry=(256&t)==256,e.FHalfCarry=(16&t)==16,e.FZero=e.FSubtract=!1},function(e){e.stackPointer=e.registersHL},function(e){e.registerA=e.memoryRead(e.memoryRead(e.programCounter+1&65535)<<8|e.memoryReader[e.programCounter](e,e.programCounter)),e.programCounter=e.programCounter+2&65535},function(e){e.IRQEnableDelay=2==e.IRQEnableDelay||118==e.memoryReader[e.programCounter](e,e.programCounter)?1:2},function(e){cout("Illegal op code 0xFC called, pausing emulation.",2),pause()},function(e){cout("Illegal op code 0xFD called, pausing emulation.",2),pause()},function(e){var t=e.registerA-e.memoryReader[e.programCounter](e,e.programCounter);e.programCounter=e.programCounter+1&65535,e.FHalfCarry=(15&t)>(15&e.registerA),e.FCarry=t<0,e.FZero=0==t,e.FSubtract=!0},function(e){e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,e.programCounter>>8),e.stackPointer=e.stackPointer-1&65535,e.memoryWriter[e.stackPointer](e,e.stackPointer,255&e.programCounter),e.programCounter=56}],GameBoyCore.prototype.CBOPCODE=[function(e){e.FCarry=e.registerB>127,e.registerB=e.registerB<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){e.FCarry=e.registerC>127,e.registerC=e.registerC<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){e.FCarry=e.registerD>127,e.registerD=e.registerD<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){e.FCarry=e.registerE>127,e.registerE=e.registerE<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){e.FCarry=e.registersHL>32767,e.registersHL=e.registersHL<<1&65024|(e.FCarry?256:0)|255&e.registersHL,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){e.FCarry=(128&e.registersHL)==128,e.registersHL=65280&e.registersHL|e.registersHL<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);e.FCarry=t>127,t=t<<1&255|(e.FCarry?1:0),e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){e.FCarry=e.registerA>127,e.registerA=e.registerA<<1&255|(e.FCarry?1:0),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){e.FCarry=(1&e.registerB)==1,e.registerB=(e.FCarry?128:0)|e.registerB>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){e.FCarry=(1&e.registerC)==1,e.registerC=(e.FCarry?128:0)|e.registerC>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){e.FCarry=(1&e.registerD)==1,e.registerD=(e.FCarry?128:0)|e.registerD>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){e.FCarry=(1&e.registerE)==1,e.registerE=(e.FCarry?128:0)|e.registerE>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){e.FCarry=(256&e.registersHL)==256,e.registersHL=(e.FCarry?32768:0)|e.registersHL>>1&65280|255&e.registersHL,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){e.FCarry=(1&e.registersHL)==1,e.registersHL=65280&e.registersHL|(e.FCarry?128:0)|(255&e.registersHL)>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);e.FCarry=(1&t)==1,t=(e.FCarry?128:0)|t>>1,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){e.FCarry=(1&e.registerA)==1,e.registerA=(e.FCarry?128:0)|e.registerA>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){var t=e.registerB>127;e.registerB=e.registerB<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){var t=e.registerC>127;e.registerC=e.registerC<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){var t=e.registerD>127;e.registerD=e.registerD<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){var t=e.registerE>127;e.registerE=e.registerE<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){var t=e.registersHL>32767;e.registersHL=e.registersHL<<1&65024|(e.FCarry?256:0)|255&e.registersHL,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){var t=(128&e.registersHL)==128;e.registersHL=65280&e.registersHL|e.registersHL<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL),r=t>127;t=t<<1&255|(e.FCarry?1:0),e.FCarry=r,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){var t=e.registerA>127;e.registerA=e.registerA<<1&255|(e.FCarry?1:0),e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){var t=(1&e.registerB)==1;e.registerB=(e.FCarry?128:0)|e.registerB>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){var t=(1&e.registerC)==1;e.registerC=(e.FCarry?128:0)|e.registerC>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){var t=(1&e.registerD)==1;e.registerD=(e.FCarry?128:0)|e.registerD>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){var t=(1&e.registerE)==1;e.registerE=(e.FCarry?128:0)|e.registerE>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){var t=(256&e.registersHL)==256;e.registersHL=(e.FCarry?32768:0)|e.registersHL>>1&65280|255&e.registersHL,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){var t=(1&e.registersHL)==1;e.registersHL=65280&e.registersHL|(e.FCarry?128:0)|(255&e.registersHL)>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL),r=(1&t)==1;t=(e.FCarry?128:0)|t>>1,e.FCarry=r,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){var t=(1&e.registerA)==1;e.registerA=(e.FCarry?128:0)|e.registerA>>1,e.FCarry=t,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){e.FCarry=e.registerB>127,e.registerB=e.registerB<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){e.FCarry=e.registerC>127,e.registerC=e.registerC<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){e.FCarry=e.registerD>127,e.registerD=e.registerD<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){e.FCarry=e.registerE>127,e.registerE=e.registerE<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){e.FCarry=e.registersHL>32767,e.registersHL=e.registersHL<<1&65024|255&e.registersHL,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){e.FCarry=(128&e.registersHL)==128,e.registersHL=65280&e.registersHL|e.registersHL<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);e.FCarry=t>127,t=t<<1&255,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){e.FCarry=e.registerA>127,e.registerA=e.registerA<<1&255,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){e.FCarry=(1&e.registerB)==1,e.registerB=128&e.registerB|e.registerB>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){e.FCarry=(1&e.registerC)==1,e.registerC=128&e.registerC|e.registerC>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){e.FCarry=(1&e.registerD)==1,e.registerD=128&e.registerD|e.registerD>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){e.FCarry=(1&e.registerE)==1,e.registerE=128&e.registerE|e.registerE>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){e.FCarry=(256&e.registersHL)==256,e.registersHL=e.registersHL>>1&65280|33023&e.registersHL,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){e.FCarry=(1&e.registersHL)==1,e.registersHL=65408&e.registersHL|(255&e.registersHL)>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);e.FCarry=(1&t)==1,t=128&t|t>>1,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FHalfCarry=e.FSubtract=!1,e.FZero=0==t},function(e){e.FCarry=(1&e.registerA)==1,e.registerA=128&e.registerA|e.registerA>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){e.registerB=(15&e.registerB)<<4|e.registerB>>4,e.FZero=0==e.registerB,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registerC=(15&e.registerC)<<4|e.registerC>>4,e.FZero=0==e.registerC,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registerD=(15&e.registerD)<<4|e.registerD>>4,e.FZero=0==e.registerD,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registerE=(15&e.registerE)<<4|e.registerE>>4,e.FZero=0==e.registerE,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registersHL=(3840&e.registersHL)<<4|(61440&e.registersHL)>>4|255&e.registersHL,e.FZero=e.registersHL<256,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registersHL=65280&e.registersHL|(15&e.registersHL)<<4|(240&e.registersHL)>>4,e.FZero=(255&e.registersHL)==0,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);t=(15&t)<<4|t>>4,e.memoryWriter[e.registersHL](e,e.registersHL,t),e.FZero=0==t,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.registerA=(15&e.registerA)<<4|e.registerA>>4,e.FZero=0==e.registerA,e.FCarry=e.FHalfCarry=e.FSubtract=!1},function(e){e.FCarry=(1&e.registerB)==1,e.registerB>>=1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerB},function(e){e.FCarry=(1&e.registerC)==1,e.registerC>>=1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerC},function(e){e.FCarry=(1&e.registerD)==1,e.registerD>>=1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerD},function(e){e.FCarry=(1&e.registerE)==1,e.registerE>>=1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerE},function(e){e.FCarry=(256&e.registersHL)==256,e.registersHL=e.registersHL>>1&65280|255&e.registersHL,e.FHalfCarry=e.FSubtract=!1,e.FZero=e.registersHL<256},function(e){e.FCarry=(1&e.registersHL)==1,e.registersHL=65280&e.registersHL|(255&e.registersHL)>>1,e.FHalfCarry=e.FSubtract=!1,e.FZero=(255&e.registersHL)==0},function(e){var t=e.memoryReader[e.registersHL](e,e.registersHL);e.FCarry=(1&t)==1,e.memoryWriter[e.registersHL](e,e.registersHL,t>>1),e.FHalfCarry=e.FSubtract=!1,e.FZero=t<2},function(e){e.FCarry=(1&e.registerA)==1,e.registerA>>=1,e.FHalfCarry=e.FSubtract=!1,e.FZero=0==e.registerA},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(256&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(512&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(1024&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(2048&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(4096&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(8192&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(16384&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(64&e.registerA)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registerB)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registerC)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registerD)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registerE)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(32768&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registersHL)==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.memoryReader[e.registersHL](e,e.registersHL))==0},function(e){e.FHalfCarry=!0,e.FSubtract=!1,e.FZero=(128&e.registerA)==0},function(e){e.registerB&=254},function(e){e.registerC&=254},function(e){e.registerD&=254},function(e){e.registerE&=254},function(e){e.registersHL&=65279},function(e){e.registersHL&=65534},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,254&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=254},function(e){e.registerB&=253},function(e){e.registerC&=253},function(e){e.registerD&=253},function(e){e.registerE&=253},function(e){e.registersHL&=65023},function(e){e.registersHL&=65533},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,253&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=253},function(e){e.registerB&=251},function(e){e.registerC&=251},function(e){e.registerD&=251},function(e){e.registerE&=251},function(e){e.registersHL&=64511},function(e){e.registersHL&=65531},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,251&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=251},function(e){e.registerB&=247},function(e){e.registerC&=247},function(e){e.registerD&=247},function(e){e.registerE&=247},function(e){e.registersHL&=63487},function(e){e.registersHL&=65527},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,247&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=247},function(e){e.registerB&=239},function(e){e.registerC&=239},function(e){e.registerD&=239},function(e){e.registerE&=239},function(e){e.registersHL&=61439},function(e){e.registersHL&=65519},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,239&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=239},function(e){e.registerB&=223},function(e){e.registerC&=223},function(e){e.registerD&=223},function(e){e.registerE&=223},function(e){e.registersHL&=57343},function(e){e.registersHL&=65503},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,223&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=223},function(e){e.registerB&=191},function(e){e.registerC&=191},function(e){e.registerD&=191},function(e){e.registerE&=191},function(e){e.registersHL&=49151},function(e){e.registersHL&=65471},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,191&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=191},function(e){e.registerB&=127},function(e){e.registerC&=127},function(e){e.registerD&=127},function(e){e.registerE&=127},function(e){e.registersHL&=32767},function(e){e.registersHL&=65407},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,127&e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA&=127},function(e){e.registerB|=1},function(e){e.registerC|=1},function(e){e.registerD|=1},function(e){e.registerE|=1},function(e){e.registersHL|=256},function(e){e.registersHL|=1},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,1|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=1},function(e){e.registerB|=2},function(e){e.registerC|=2},function(e){e.registerD|=2},function(e){e.registerE|=2},function(e){e.registersHL|=512},function(e){e.registersHL|=2},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,2|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=2},function(e){e.registerB|=4},function(e){e.registerC|=4},function(e){e.registerD|=4},function(e){e.registerE|=4},function(e){e.registersHL|=1024},function(e){e.registersHL|=4},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,4|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=4},function(e){e.registerB|=8},function(e){e.registerC|=8},function(e){e.registerD|=8},function(e){e.registerE|=8},function(e){e.registersHL|=2048},function(e){e.registersHL|=8},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,8|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=8},function(e){e.registerB|=16},function(e){e.registerC|=16},function(e){e.registerD|=16},function(e){e.registerE|=16},function(e){e.registersHL|=4096},function(e){e.registersHL|=16},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,16|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=16},function(e){e.registerB|=32},function(e){e.registerC|=32},function(e){e.registerD|=32},function(e){e.registerE|=32},function(e){e.registersHL|=8192},function(e){e.registersHL|=32},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,32|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=32},function(e){e.registerB|=64},function(e){e.registerC|=64},function(e){e.registerD|=64},function(e){e.registerE|=64},function(e){e.registersHL|=16384},function(e){e.registersHL|=64},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,64|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=64},function(e){e.registerB|=128},function(e){e.registerC|=128},function(e){e.registerD|=128},function(e){e.registerE|=128},function(e){e.registersHL|=32768},function(e){e.registersHL|=128},function(e){e.memoryWriter[e.registersHL](e,e.registersHL,128|e.memoryReader[e.registersHL](e,e.registersHL))},function(e){e.registerA|=128}],GameBoyCore.prototype.TICKTable=[4,12,8,8,4,4,8,4,20,8,8,8,4,4,8,4,4,12,8,8,4,4,8,4,12,8,8,8,4,4,8,4,8,12,8,8,4,4,8,4,8,8,8,8,4,4,8,4,8,12,8,8,12,12,12,4,8,8,8,8,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,8,8,8,8,8,8,4,8,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,8,12,12,16,12,16,8,16,8,16,12,0,12,24,8,16,8,12,12,4,12,16,8,16,8,16,12,4,12,4,8,16,12,12,8,4,4,16,8,16,16,4,16,4,4,4,8,16,12,12,8,4,4,16,8,16,12,8,16,4,0,4,8,16],GameBoyCore.prototype.SecondaryTICKTable=[8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8],GameBoyCore.prototype.saveSRAMState=function(){return this.cBATT&&0!=this.MBCRam.length?this.fromTypedArray(this.MBCRam):[]},GameBoyCore.prototype.saveRTCState=function(){return this.cTIMER?[this.lastIteration,this.RTCisLatched,this.latchedSeconds,this.latchedMinutes,this.latchedHours,this.latchedLDays,this.latchedHDays,this.RTCSeconds,this.RTCMinutes,this.RTCHours,this.RTCDays,this.RTCDayOverFlow,this.RTCHALT]:[]},GameBoyCore.prototype.saveState=function(){return[this.fromTypedArray(this.ROM),this.inBootstrap,this.registerA,this.FZero,this.FSubtract,this.FHalfCarry,this.FCarry,this.registerB,this.registerC,this.registerD,this.registerE,this.registersHL,this.stackPointer,this.programCounter,this.halt,this.IME,this.hdmaRunning,this.CPUTicks,this.doubleSpeedShifter,this.fromTypedArray(this.memory),this.fromTypedArray(this.MBCRam),this.fromTypedArray(this.VRAM),this.currVRAMBank,this.fromTypedArray(this.GBCMemory),this.MBC1Mode,this.MBCRAMBanksEnabled,this.currMBCRAMBank,this.currMBCRAMBankPosition,this.cGBC,this.gbcRamBank,this.gbcRamBankPosition,this.ROMBank1offs,this.currentROMBank,this.cartridgeType,this.name,this.gameCode,this.modeSTAT,this.LYCMatchTriggerSTAT,this.mode2TriggerSTAT,this.mode1TriggerSTAT,this.mode0TriggerSTAT,this.LCDisOn,this.gfxWindowCHRBankPosition,this.gfxWindowDisplay,this.gfxSpriteShow,this.gfxSpriteNormalHeight,this.gfxBackgroundCHRBankPosition,this.gfxBackgroundBankOffset,this.TIMAEnabled,this.DIVTicks,this.LCDTicks,this.timerTicks,this.TACClocker,this.serialTimer,this.serialShiftTimer,this.serialShiftTimerAllocated,this.IRQEnableDelay,this.lastIteration,this.cMBC1,this.cMBC2,this.cMBC3,this.cMBC5,this.cMBC7,this.cSRAM,this.cMMMO1,this.cRUMBLE,this.cCamera,this.cTAMA5,this.cHuC3,this.cHuC1,this.drewBlank,this.fromTypedArray(this.frameBuffer),this.bgEnabled,this.BGPriorityEnabled,this.channel1FrequencyTracker,this.channel1FrequencyCounter,this.channel1totalLength,this.channel1envelopeVolume,this.channel1envelopeType,this.channel1envelopeSweeps,this.channel1envelopeSweepsLast,this.channel1consecutive,this.channel1frequency,this.channel1SweepFault,this.channel1ShadowFrequency,this.channel1timeSweep,this.channel1lastTimeSweep,this.channel1Swept,this.channel1frequencySweepDivider,this.channel1decreaseSweep,this.channel2FrequencyTracker,this.channel2FrequencyCounter,this.channel2totalLength,this.channel2envelopeVolume,this.channel2envelopeType,this.channel2envelopeSweeps,this.channel2envelopeSweepsLast,this.channel2consecutive,this.channel2frequency,this.channel3canPlay,this.channel3totalLength,this.channel3patternType,this.channel3frequency,this.channel3consecutive,this.fromTypedArray(this.channel3PCM),this.channel4FrequencyPeriod,this.channel4lastSampleLookup,this.channel4totalLength,this.channel4envelopeVolume,this.channel4currentVolume,this.channel4envelopeType,this.channel4envelopeSweeps,this.channel4envelopeSweepsLast,this.channel4consecutive,this.channel4BitRange,this.soundMasterEnabled,this.VinLeftChannelMasterVolume,this.VinRightChannelMasterVolume,this.leftChannel1,this.leftChannel2,this.leftChannel3,this.leftChannel4,this.rightChannel1,this.rightChannel2,this.rightChannel3,this.rightChannel4,this.channel1currentSampleLeft,this.channel1currentSampleRight,this.channel2currentSampleLeft,this.channel2currentSampleRight,this.channel3currentSampleLeft,this.channel3currentSampleRight,this.channel4currentSampleLeft,this.channel4currentSampleRight,this.channel1currentSampleLeftSecondary,this.channel1currentSampleRightSecondary,this.channel2currentSampleLeftSecondary,this.channel2currentSampleRightSecondary,this.channel3currentSampleLeftSecondary,this.channel3currentSampleRightSecondary,this.channel4currentSampleLeftSecondary,this.channel4currentSampleRightSecondary,this.channel1currentSampleLeftTrimary,this.channel1currentSampleRightTrimary,this.channel2currentSampleLeftTrimary,this.channel2currentSampleRightTrimary,this.mixerOutputCache,this.channel1DutyTracker,this.channel1CachedDuty,this.channel2DutyTracker,this.channel2CachedDuty,this.channel1Enabled,this.channel2Enabled,this.channel3Enabled,this.channel4Enabled,this.sequencerClocks,this.sequencePosition,this.channel3Counter,this.channel4Counter,this.cachedChannel3Sample,this.cachedChannel4Sample,this.channel3FrequencyPeriod,this.channel3lastSampleLookup,this.actualScanLine,this.lastUnrenderedLine,this.queuedScanLines,this.RTCisLatched,this.latchedSeconds,this.latchedMinutes,this.latchedHours,this.latchedLDays,this.latchedHDays,this.RTCSeconds,this.RTCMinutes,this.RTCHours,this.RTCDays,this.RTCDayOverFlow,this.RTCHALT,this.usedBootROM,this.skipPCIncrement,this.STATTracker,this.gbcRamBankPositionECHO,this.numRAMBanks,this.windowY,this.windowX,this.fromTypedArray(this.gbcOBJRawPalette),this.fromTypedArray(this.gbcBGRawPalette),this.fromTypedArray(this.gbOBJPalette),this.fromTypedArray(this.gbBGPalette),this.fromTypedArray(this.gbcOBJPalette),this.fromTypedArray(this.gbcBGPalette),this.fromTypedArray(this.gbBGColorizedPalette),this.fromTypedArray(this.gbOBJColorizedPalette),this.fromTypedArray(this.cachedBGPaletteConversion),this.fromTypedArray(this.cachedOBJPaletteConversion),this.fromTypedArray(this.BGCHRBank1),this.fromTypedArray(this.BGCHRBank2),this.haltPostClocks,this.interruptsRequested,this.interruptsEnabled,this.remainingClocks,this.colorizedGBPalettes,this.backgroundY,this.backgroundX,this.CPUStopped,this.audioClocksUntilNextEvent,this.audioClocksUntilNextEventCounter]},GameBoyCore.prototype.returnFromState=function(e){var t=0,r=e.slice(0);this.ROM=this.toTypedArray(r[t++],"uint8"),this.ROMBankEdge=Math.floor(this.ROM.length/16384),this.inBootstrap=r[t++],this.registerA=r[t++],this.FZero=r[t++],this.FSubtract=r[t++],this.FHalfCarry=r[t++],this.FCarry=r[t++],this.registerB=r[t++],this.registerC=r[t++],this.registerD=r[t++],this.registerE=r[t++],this.registersHL=r[t++],this.stackPointer=r[t++],this.programCounter=r[t++],this.halt=r[t++],this.IME=r[t++],this.hdmaRunning=r[t++],this.CPUTicks=r[t++],this.doubleSpeedShifter=r[t++],this.memory=this.toTypedArray(r[t++],"uint8"),this.MBCRam=this.toTypedArray(r[t++],"uint8"),this.VRAM=this.toTypedArray(r[t++],"uint8"),this.currVRAMBank=r[t++],this.GBCMemory=this.toTypedArray(r[t++],"uint8"),this.MBC1Mode=r[t++],this.MBCRAMBanksEnabled=r[t++],this.currMBCRAMBank=r[t++],this.currMBCRAMBankPosition=r[t++],this.cGBC=r[t++],this.gbcRamBank=r[t++],this.gbcRamBankPosition=r[t++],this.ROMBank1offs=r[t++],this.currentROMBank=r[t++],this.cartridgeType=r[t++],this.name=r[t++],this.gameCode=r[t++],this.modeSTAT=r[t++],this.LYCMatchTriggerSTAT=r[t++],this.mode2TriggerSTAT=r[t++],this.mode1TriggerSTAT=r[t++],this.mode0TriggerSTAT=r[t++],this.LCDisOn=r[t++],this.gfxWindowCHRBankPosition=r[t++],this.gfxWindowDisplay=r[t++],this.gfxSpriteShow=r[t++],this.gfxSpriteNormalHeight=r[t++],this.gfxBackgroundCHRBankPosition=r[t++],this.gfxBackgroundBankOffset=r[t++],this.TIMAEnabled=r[t++],this.DIVTicks=r[t++],this.LCDTicks=r[t++],this.timerTicks=r[t++],this.TACClocker=r[t++],this.serialTimer=r[t++],this.serialShiftTimer=r[t++],this.serialShiftTimerAllocated=r[t++],this.IRQEnableDelay=r[t++],this.lastIteration=r[t++],this.cMBC1=r[t++],this.cMBC2=r[t++],this.cMBC3=r[t++],this.cMBC5=r[t++],this.cMBC7=r[t++],this.cSRAM=r[t++],this.cMMMO1=r[t++],this.cRUMBLE=r[t++],this.cCamera=r[t++],this.cTAMA5=r[t++],this.cHuC3=r[t++],this.cHuC1=r[t++],this.drewBlank=r[t++],this.frameBuffer=this.toTypedArray(r[t++],"int32"),this.bgEnabled=r[t++],this.BGPriorityEnabled=r[t++],this.channel1FrequencyTracker=r[t++],this.channel1FrequencyCounter=r[t++],this.channel1totalLength=r[t++],this.channel1envelopeVolume=r[t++],this.channel1envelopeType=r[t++],this.channel1envelopeSweeps=r[t++],this.channel1envelopeSweepsLast=r[t++],this.channel1consecutive=r[t++],this.channel1frequency=r[t++],this.channel1SweepFault=r[t++],this.channel1ShadowFrequency=r[t++],this.channel1timeSweep=r[t++],this.channel1lastTimeSweep=r[t++],this.channel1Swept=r[t++],this.channel1frequencySweepDivider=r[t++],this.channel1decreaseSweep=r[t++],this.channel2FrequencyTracker=r[t++],this.channel2FrequencyCounter=r[t++],this.channel2totalLength=r[t++],this.channel2envelopeVolume=r[t++],this.channel2envelopeType=r[t++],this.channel2envelopeSweeps=r[t++],this.channel2envelopeSweepsLast=r[t++],this.channel2consecutive=r[t++],this.channel2frequency=r[t++],this.channel3canPlay=r[t++],this.channel3totalLength=r[t++],this.channel3patternType=r[t++],this.channel3frequency=r[t++],this.channel3consecutive=r[t++],this.channel3PCM=this.toTypedArray(r[t++],"int8"),this.channel4FrequencyPeriod=r[t++],this.channel4lastSampleLookup=r[t++],this.channel4totalLength=r[t++],this.channel4envelopeVolume=r[t++],this.channel4currentVolume=r[t++],this.channel4envelopeType=r[t++],this.channel4envelopeSweeps=r[t++],this.channel4envelopeSweepsLast=r[t++],this.channel4consecutive=r[t++],this.channel4BitRange=r[t++],this.soundMasterEnabled=r[t++],this.VinLeftChannelMasterVolume=r[t++],this.VinRightChannelMasterVolume=r[t++],this.leftChannel1=r[t++],this.leftChannel2=r[t++],this.leftChannel3=r[t++],this.leftChannel4=r[t++],this.rightChannel1=r[t++],this.rightChannel2=r[t++],this.rightChannel3=r[t++],this.rightChannel4=r[t++],this.channel1currentSampleLeft=r[t++],this.channel1currentSampleRight=r[t++],this.channel2currentSampleLeft=r[t++],this.channel2currentSampleRight=r[t++],this.channel3currentSampleLeft=r[t++],this.channel3currentSampleRight=r[t++],this.channel4currentSampleLeft=r[t++],this.channel4currentSampleRight=r[t++],this.channel1currentSampleLeftSecondary=r[t++],this.channel1currentSampleRightSecondary=r[t++],this.channel2currentSampleLeftSecondary=r[t++],this.channel2currentSampleRightSecondary=r[t++],this.channel3currentSampleLeftSecondary=r[t++],this.channel3currentSampleRightSecondary=r[t++],this.channel4currentSampleLeftSecondary=r[t++],this.channel4currentSampleRightSecondary=r[t++],this.channel1currentSampleLeftTrimary=r[t++],this.channel1currentSampleRightTrimary=r[t++],this.channel2currentSampleLeftTrimary=r[t++],this.channel2currentSampleRightTrimary=r[t++],this.mixerOutputCache=r[t++],this.channel1DutyTracker=r[t++],this.channel1CachedDuty=r[t++],this.channel2DutyTracker=r[t++],this.channel2CachedDuty=r[t++],this.channel1Enabled=r[t++],this.channel2Enabled=r[t++],this.channel3Enabled=r[t++],this.channel4Enabled=r[t++],this.sequencerClocks=r[t++],this.sequencePosition=r[t++],this.channel3Counter=r[t++],this.channel4Counter=r[t++],this.cachedChannel3Sample=r[t++],this.cachedChannel4Sample=r[t++],this.channel3FrequencyPeriod=r[t++],this.channel3lastSampleLookup=r[t++],this.actualScanLine=r[t++],this.lastUnrenderedLine=r[t++],this.queuedScanLines=r[t++],this.RTCisLatched=r[t++],this.latchedSeconds=r[t++],this.latchedMinutes=r[t++],this.latchedHours=r[t++],this.latchedLDays=r[t++],this.latchedHDays=r[t++],this.RTCSeconds=r[t++],this.RTCMinutes=r[t++],this.RTCHours=r[t++],this.RTCDays=r[t++],this.RTCDayOverFlow=r[t++],this.RTCHALT=r[t++],this.usedBootROM=r[t++],this.skipPCIncrement=r[t++],this.STATTracker=r[t++],this.gbcRamBankPositionECHO=r[t++],this.numRAMBanks=r[t++],this.windowY=r[t++],this.windowX=r[t++],this.gbcOBJRawPalette=this.toTypedArray(r[t++],"uint8"),this.gbcBGRawPalette=this.toTypedArray(r[t++],"uint8"),this.gbOBJPalette=this.toTypedArray(r[t++],"int32"),this.gbBGPalette=this.toTypedArray(r[t++],"int32"),this.gbcOBJPalette=this.toTypedArray(r[t++],"int32"),this.gbcBGPalette=this.toTypedArray(r[t++],"int32"),this.gbBGColorizedPalette=this.toTypedArray(r[t++],"int32"),this.gbOBJColorizedPalette=this.toTypedArray(r[t++],"int32"),this.cachedBGPaletteConversion=this.toTypedArray(r[t++],"int32"),this.cachedOBJPaletteConversion=this.toTypedArray(r[t++],"int32"),this.BGCHRBank1=this.toTypedArray(r[t++],"uint8"),this.BGCHRBank2=this.toTypedArray(r[t++],"uint8"),this.haltPostClocks=r[t++],this.interruptsRequested=r[t++],this.interruptsEnabled=r[t++],this.checkIRQMatching(),this.remainingClocks=r[t++],this.colorizedGBPalettes=r[t++],this.backgroundY=r[t++],this.backgroundX=r[t++],this.CPUStopped=r[t++],this.audioClocksUntilNextEvent=r[t++],this.audioClocksUntilNextEventCounter=r[t],this.fromSaveState=!0,this.TICKTable=this.toTypedArray(this.TICKTable,"uint8"),this.SecondaryTICKTable=this.toTypedArray(this.SecondaryTICKTable,"uint8"),this.initializeReferencesFromSaveState(),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile(),this.initLCD(),this.initSound(),this.noiseSampleTable=32767==this.channel4BitRange?this.LSFR15Table:this.LSFR7Table,this.channel4VolumeShifter=32767==this.channel4BitRange?15:7},GameBoyCore.prototype.returnFromRTCState=function(){if("function"==typeof this.openRTC&&this.cTIMER){var e=this.openRTC(this.name),t=0;this.lastIteration=e[t++],this.RTCisLatched=e[t++],this.latchedSeconds=e[t++],this.latchedMinutes=e[t++],this.latchedHours=e[t++],this.latchedLDays=e[t++],this.latchedHDays=e[t++],this.RTCSeconds=e[t++],this.RTCMinutes=e[t++],this.RTCHours=e[t++],this.RTCDays=e[t++],this.RTCDayOverFlow=e[t++],this.RTCHALT=e[t]}},GameBoyCore.prototype.start=function(){this.initMemory(),this.ROMLoad(),this.initLCD(),this.initSound(),this.run()},GameBoyCore.prototype.initMemory=function(){this.memory=this.getTypedArray(65536,0,"uint8"),this.frameBuffer=this.getTypedArray(23040,16316664,"int32"),this.BGCHRBank1=this.getTypedArray(2048,0,"uint8"),this.TICKTable=this.toTypedArray(this.TICKTable,"uint8"),this.SecondaryTICKTable=this.toTypedArray(this.SecondaryTICKTable,"uint8"),this.channel3PCM=this.getTypedArray(32,0,"int8")},GameBoyCore.prototype.generateCacheArray=function(e){for(var t=[],r=0;r<e;)t[r++]=this.getTypedArray(64,0,"uint8");return t},GameBoyCore.prototype.initSkipBootstrap=function(){for(var e=255;e>=0;){if(e>=48&&e<64)this.memoryWrite(65280|e,this.ffxxDump[e]);else switch(e){case 0:case 1:case 2:case 5:case 7:case 15:case 255:this.memoryWrite(65280|e,this.ffxxDump[e]);break;default:this.memory[65280|e]=this.ffxxDump[e]}--e}this.cGBC?(this.memory[65388]=254,this.memory[65396]=254):(this.memory[65352]=255,this.memory[65353]=255,this.memory[65388]=255,this.memory[65396]=255),cout("Starting without the GBC boot ROM.",0),this.registerA=this.cGBC?17:1,this.registerB=0,this.registerC=19,this.registerD=0,this.registerE=216,this.FZero=!0,this.FSubtract=!1,this.FHalfCarry=!0,this.FCarry=!0,this.registersHL=333,this.LCDCONTROL=this.LINECONTROL,this.IME=!1,this.IRQLineMatched=0,this.interruptsRequested=225,this.interruptsEnabled=0,this.hdmaRunning=!1,this.CPUTicks=12,this.STATTracker=0,this.modeSTAT=1,this.spriteCount=252,this.LYCMatchTriggerSTAT=!1,this.mode2TriggerSTAT=!1,this.mode1TriggerSTAT=!1,this.mode0TriggerSTAT=!1,this.LCDisOn=!0,this.channel1FrequencyTracker=8192,this.channel1DutyTracker=0,this.channel1CachedDuty=this.dutyLookup[2],this.channel1totalLength=0,this.channel1envelopeVolume=0,this.channel1envelopeType=!1,this.channel1envelopeSweeps=0,this.channel1envelopeSweepsLast=0,this.channel1consecutive=!0,this.channel1frequency=1985,this.channel1SweepFault=!0,this.channel1ShadowFrequency=1985,this.channel1timeSweep=1,this.channel1lastTimeSweep=0,this.channel1Swept=!1,this.channel1frequencySweepDivider=0,this.channel1decreaseSweep=!1,this.channel2FrequencyTracker=8192,this.channel2DutyTracker=0,this.channel2CachedDuty=this.dutyLookup[2],this.channel2totalLength=0,this.channel2envelopeVolume=0,this.channel2envelopeType=!1,this.channel2envelopeSweeps=0,this.channel2envelopeSweepsLast=0,this.channel2consecutive=!0,this.channel2frequency=0,this.channel3canPlay=!1,this.channel3totalLength=0,this.channel3patternType=4,this.channel3frequency=0,this.channel3consecutive=!0,this.channel3Counter=1048,this.channel4FrequencyPeriod=8,this.channel4totalLength=0,this.channel4envelopeVolume=0,this.channel4currentVolume=0,this.channel4envelopeType=!1,this.channel4envelopeSweeps=0,this.channel4envelopeSweepsLast=0,this.channel4consecutive=!0,this.channel4BitRange=32767,this.channel4VolumeShifter=15,this.channel1FrequencyCounter=512,this.channel2FrequencyCounter=512,this.channel3Counter=2048,this.channel3FrequencyPeriod=2048,this.channel3lastSampleLookup=0,this.channel4lastSampleLookup=0,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.soundMasterEnabled=!0,this.leftChannel1=!0,this.leftChannel2=!0,this.leftChannel3=!0,this.leftChannel4=!0,this.rightChannel1=!0,this.rightChannel2=!0,this.rightChannel3=!1,this.rightChannel4=!1,this.DIVTicks=27044,this.LCDTicks=160,this.timerTicks=0,this.TIMAEnabled=!1,this.TACClocker=1024,this.serialTimer=0,this.serialShiftTimer=0,this.serialShiftTimerAllocated=0,this.IRQEnableDelay=0,this.actualScanLine=144,this.lastUnrenderedLine=0,this.gfxWindowDisplay=!1,this.gfxSpriteShow=!1,this.gfxSpriteNormalHeight=!0,this.bgEnabled=!0,this.BGPriorityEnabled=!0,this.gfxWindowCHRBankPosition=0,this.gfxBackgroundCHRBankPosition=0,this.gfxBackgroundBankOffset=0,this.windowY=0,this.windowX=0,this.drewBlank=0,this.midScanlineOffset=-1,this.currentX=0},GameBoyCore.prototype.initBootstrap=function(){cout("Starting the selected boot ROM.",0),this.programCounter=0,this.stackPointer=0,this.IME=!1,this.LCDTicks=0,this.DIVTicks=0,this.registerA=0,this.registerB=0,this.registerC=0,this.registerD=0,this.registerE=0,this.FZero=this.FSubtract=this.FHalfCarry=this.FCarry=!1,this.registersHL=0,this.leftChannel1=!1,this.leftChannel2=!1,this.leftChannel3=!1,this.leftChannel4=!1,this.rightChannel1=!1,this.rightChannel2=!1,this.rightChannel3=!1,this.rightChannel4=!1,this.channel2frequency=this.channel1frequency=0,this.channel4consecutive=this.channel2consecutive=this.channel1consecutive=!1,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.memory[65280]=15},GameBoyCore.prototype.ROMLoad=function(){this.ROM=[],this.usedBootROM=settings[1]&&(!settings[11]&&2048==this.GBCBOOTROM.length||settings[11]&&256==this.GBBOOTROM.length);var e=this.ROMImage.length;if(e<16384)throw Error("ROM image size too small.");this.ROM=this.getTypedArray(e,0,"uint8");var t=0;if(this.usedBootROM){if(settings[11])for(;t<256;++t)this.memory[t]=this.GBBOOTROM[t],this.ROM[t]=255&this.ROMImage.charCodeAt(t);else{for(;t<256;++t)this.memory[t]=this.GBCBOOTROM[t],this.ROM[t]=255&this.ROMImage.charCodeAt(t);for(;t<512;++t)this.memory[t]=this.ROM[t]=255&this.ROMImage.charCodeAt(t);for(;t<2304;++t)this.memory[t]=this.GBCBOOTROM[t-256],this.ROM[t]=255&this.ROMImage.charCodeAt(t);this.usedGBCBootROM=!0}for(;t<16384;++t)this.memory[t]=this.ROM[t]=255&this.ROMImage.charCodeAt(t)}else for(;t<16384;++t)this.memory[t]=this.ROM[t]=255&this.ROMImage.charCodeAt(t);for(;t<e;++t)this.ROM[t]=255&this.ROMImage.charCodeAt(t);this.ROMBankEdge=Math.floor(this.ROM.length/16384),this.interpretCartridge(),this.checkIRQMatching()},GameBoyCore.prototype.getROMImage=function(){if(this.ROMImage.length>0)return this.ROMImage.length;for(var e=this.ROM.length,t=0;t<e;t++)this.ROMImage+=String.fromCharCode(this.ROM[t]);return this.ROMImage},GameBoyCore.prototype.interpretCartridge=function(){for(var e=308;e<319;e++)this.ROMImage.charCodeAt(e)>0&&(this.name+=this.ROMImage[e]);for(var e=319;e<323;e++)this.ROMImage.charCodeAt(e)>0&&(this.gameCode+=this.ROMImage[e]);cout("Game Title: "+this.name+"["+this.gameCode+"]["+this.ROMImage[323]+"]",0),cout("Game Code: "+this.gameCode,0),this.cartridgeType=this.ROM[327],cout("Cartridge type #"+this.cartridgeType,0);var t="";switch(this.cartridgeType){case 0:if(!settings[9]){t="ROM";break}case 1:this.cMBC1=!0,t="MBC1";break;case 2:this.cMBC1=!0,this.cSRAM=!0,t="MBC1 + SRAM";break;case 3:this.cMBC1=!0,this.cSRAM=!0,this.cBATT=!0,t="MBC1 + SRAM + BATT";break;case 5:this.cMBC2=!0,t="MBC2";break;case 6:this.cMBC2=!0,this.cBATT=!0,t="MBC2 + BATT";break;case 8:this.cSRAM=!0,t="ROM + SRAM";break;case 9:this.cSRAM=!0,this.cBATT=!0,t="ROM + SRAM + BATT";break;case 11:this.cMMMO1=!0,t="MMMO1";break;case 12:this.cMMMO1=!0,this.cSRAM=!0,t="MMMO1 + SRAM";break;case 13:this.cMMMO1=!0,this.cSRAM=!0,this.cBATT=!0,t="MMMO1 + SRAM + BATT";break;case 15:this.cMBC3=!0,this.cTIMER=!0,this.cBATT=!0,t="MBC3 + TIMER + BATT";break;case 16:this.cMBC3=!0,this.cTIMER=!0,this.cBATT=!0,this.cSRAM=!0,t="MBC3 + TIMER + BATT + SRAM";break;case 17:this.cMBC3=!0,t="MBC3";break;case 18:this.cMBC3=!0,this.cSRAM=!0,t="MBC3 + SRAM";break;case 19:this.cMBC3=!0,this.cSRAM=!0,this.cBATT=!0,t="MBC3 + SRAM + BATT";break;case 25:this.cMBC5=!0,t="MBC5";break;case 26:this.cMBC5=!0,this.cSRAM=!0,t="MBC5 + SRAM";break;case 27:this.cMBC5=!0,this.cSRAM=!0,this.cBATT=!0,t="MBC5 + SRAM + BATT";break;case 28:this.cRUMBLE=!0,t="RUMBLE";break;case 29:this.cRUMBLE=!0,this.cSRAM=!0,t="RUMBLE + SRAM";break;case 30:this.cRUMBLE=!0,this.cSRAM=!0,this.cBATT=!0,t="RUMBLE + SRAM + BATT";break;case 31:this.cCamera=!0,t="GameBoy Camera";break;case 34:this.cMBC7=!0,this.cSRAM=!0,this.cBATT=!0,t="MBC7 + SRAM + BATT";break;case 253:this.cTAMA5=!0,t="TAMA5";break;case 254:this.cHuC3=!0,t="HuC3";break;case 255:this.cHuC1=!0,t="HuC1";break;default:t="Unknown",cout("Cartridge type is unknown.",2),pause()}switch(cout("Cartridge Type: "+t+".",0),this.numROMBanks=this.ROMBanks[this.ROM[328]],cout(this.numROMBanks+" ROM banks.",0),this.RAMBanks[this.ROM[329]]){case 0:cout("No RAM banking requested for allocation or MBC is of type 2.",0);break;case 2:cout("1 RAM bank requested for allocation.",0);break;case 3:cout("4 RAM banks requested for allocation.",0);break;case 4:cout("16 RAM banks requested for allocation.",0);break;default:cout("RAM bank amount requested is unknown, will use maximum allowed by specified MBC type.",0)}if(this.usedBootROM)this.cGBC=this.usedGBCBootROM,this.setupRAM(),this.initBootstrap();else{switch(this.ROM[323]){case 0:this.cGBC=!1,cout("Only GB mode detected.",0);break;case 50:settings[2]||this.name+this.gameCode+this.ROM[323]!="Game and Watch 50"?this.cGBC=!1:(this.cGBC=!0,cout("Created a boot exception for Game and Watch Gallery 2 (GBC ID byte is wrong on the cartridge).",1));break;case 128:this.cGBC=!settings[2],cout("GB and GBC mode detected.",0);break;case 192:this.cGBC=!0,cout("Only GBC mode detected.",0);break;default:this.cGBC=!1,cout("Unknown GameBoy game type code #"+this.ROM[323]+", defaulting to GB mode (Old games don't have a type code).",1)}this.inBootstrap=!1,this.setupRAM(),this.initSkipBootstrap()}this.initializeModeSpecificArrays();var r=this.ROM[331],i=65280&this.ROM[324]|255&this.ROM[325];51!=r?cout("Old style license code: "+r,0):cout("New style license code: "+i,0),this.ROMImage=""},GameBoyCore.prototype.disableBootROM=function(){for(var e=0;e<256;++e)this.memory[e]=this.ROM[e];if(this.usedGBCBootROM){for(e=512;e<2304;++e)this.memory[e]=this.ROM[e];this.cGBC?this.recompileBootIOWriteHandling():this.GBCtoGBModeAdjust()}else this.recompileBootIOWriteHandling()},GameBoyCore.prototype.initializeTiming=function(){this.clocksPerSecond=4194304*this.emulatorSpeed,this.baseCPUCyclesPerIteration=this.clocksPerSecond/1e3*settings[6],this.CPUCyclesTotalRoundoff=this.baseCPUCyclesPerIteration%4,this.CPUCyclesTotalBase=this.CPUCyclesTotal=this.baseCPUCyclesPerIteration-this.CPUCyclesTotalRoundoff|0,this.CPUCyclesTotalCurrent=0},GameBoyCore.prototype.setSpeed=function(e){this.emulatorSpeed=e,this.initializeTiming(),this.audioHandle&&this.initSound()},GameBoyCore.prototype.setupRAM=function(){if(this.cMBC2?this.numRAMBanks=1/16:this.cMBC1||this.cRUMBLE||this.cMBC3||this.cHuC3?this.numRAMBanks=4:this.cMBC5?this.numRAMBanks=16:this.cSRAM&&(this.numRAMBanks=1),this.numRAMBanks>0){this.MBCRAMUtilized()||(this.MBCRAMBanksEnabled=!0);var e="function"==typeof this.openMBC?this.openMBC(this.name):[];e.length>0?this.MBCRam=this.toTypedArray(e,"uint8"):this.MBCRam=this.getTypedArray(8192*this.numRAMBanks,0,"uint8")}cout("Actual bytes of MBC RAM allocated: "+8192*this.numRAMBanks,0),this.returnFromRTCState(),this.cGBC&&(this.VRAM=this.getTypedArray(8192,0,"uint8"),this.GBCMemory=this.getTypedArray(28672,0,"uint8")),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile()},GameBoyCore.prototype.MBCRAMUtilized=function(){return this.cMBC1||this.cMBC2||this.cMBC3||this.cMBC5||this.cMBC7||this.cRUMBLE},GameBoyCore.prototype.recomputeDimension=function(){initNewCanvas(),this.onscreenWidth=this.canvas.width,this.onscreenHeight=this.canvas.height,window&&window.mozRequestAnimationFrame||-1!=navigator.userAgent.toLowerCase().indexOf("gecko")&&-1==navigator.userAgent.toLowerCase().indexOf("like gecko")?(this.canvas.width=this.onscreenWidth=settings[12]?this.canvas.width:160,this.canvas.height=this.onscreenHeight=settings[12]?this.canvas.height:144):(this.onscreenWidth=this.canvas.width,this.onscreenHeight=this.canvas.height),this.offscreenWidth=settings[12]?this.canvas.width:160,this.offscreenHeight=settings[12]?this.canvas.height:144,this.offscreenRGBCount=this.offscreenWidth*this.offscreenHeight*4},GameBoyCore.prototype.initLCD=function(){this.recomputeDimension(),92160!=this.offscreenRGBCount?this.compileResizeFrameBufferFunction():this.resizer=null;try{this.canvasOffscreen=document.createElement("canvas"),this.canvasOffscreen.width=this.offscreenWidth,this.canvasOffscreen.height=this.offscreenHeight,this.drawContextOffscreen=this.canvasOffscreen.getContext("2d"),this.drawContextOnscreen=this.canvas.getContext("2d"),this.canvas.setAttribute("style",(this.canvas.getAttribute("style")||"")+"; image-rendering: "+(settings[13]?"auto":"-webkit-optimize-contrast")+";image-rendering: "+(settings[13]?"optimizeQuality":"-o-crisp-edges")+";image-rendering: "+(settings[13]?"optimizeQuality":"-moz-crisp-edges")+";-ms-interpolation-mode: "+(settings[13]?"bicubic":"nearest-neighbor")+";"),this.drawContextOffscreen.webkitImageSmoothingEnabled=settings[13],this.drawContextOffscreen.mozImageSmoothingEnabled=settings[13],this.drawContextOnscreen.webkitImageSmoothingEnabled=settings[13],this.drawContextOnscreen.mozImageSmoothingEnabled=settings[13];try{this.canvasBuffer=this.drawContextOffscreen.createImageData(this.offscreenWidth,this.offscreenHeight)}catch(e){cout('Falling back to the getImageData initialization (Error "'+e.message+'").',1),this.canvasBuffer=this.drawContextOffscreen.getImageData(0,0,this.offscreenWidth,this.offscreenHeight)}for(var t=this.offscreenRGBCount;t>0;)this.canvasBuffer.data[t-=4]=248,this.canvasBuffer.data[t+1]=248,this.canvasBuffer.data[t+2]=248,this.canvasBuffer.data[t+3]=255;this.graphicsBlit(),this.canvas.style.visibility="visible",null==this.swizzledFrame&&(this.swizzledFrame=this.getTypedArray(69120,255,"uint8")),this.drewFrame=!0,this.requestDraw()}catch(r){throw Error("HTML5 Canvas support required: "+r.message+"file: "+r.fileName+", line: "+r.lineNumber)}},GameBoyCore.prototype.graphicsBlit=function(){this.offscreenWidth==this.onscreenWidth&&this.offscreenHeight==this.onscreenHeight?this.drawContextOnscreen.putImageData(this.canvasBuffer,0,0):(this.drawContextOffscreen.putImageData(this.canvasBuffer,0,0),this.drawContextOnscreen.drawImage(this.canvasOffscreen,0,0,this.onscreenWidth,this.onscreenHeight))},GameBoyCore.prototype.JoyPadEvent=function(e,t){t?(this.JoyPad&=255^1<<e,this.cGBC||this.usedBootROM&&this.usedGBCBootROM||(this.interruptsRequested|=16,this.remainingClocks=0,this.checkIRQMatching())):this.JoyPad|=1<<e,this.memory[65280]=(48&this.memory[65280])+(((32&this.memory[65280])==0?this.JoyPad>>4:15)&((16&this.memory[65280])==0?15&this.JoyPad:15)),this.CPUStopped=!1},GameBoyCore.prototype.GyroEvent=function(e,t){e*=-100,e+=2047,this.highX=e>>8,this.lowX=255&e,t*=-100,t+=2047,this.highY=t>>8,this.lowY=255&t},GameBoyCore.prototype.initSound=function(){this.audioResamplerFirstPassFactor=Math.max(Math.min(Math.floor(this.clocksPerSecond/44100),Math.floor(136.53125)),1),this.downSampleInputDivider=1/(240*this.audioResamplerFirstPassFactor),settings[0]?(this.audioHandle=new XAudioServer(2,this.clocksPerSecond/this.audioResamplerFirstPassFactor,0,Math.max(this.baseCPUCyclesPerIteration*settings[8]/this.audioResamplerFirstPassFactor,8192)<<1,null,settings[3],function(){settings[0]=!1}),this.initAudioBuffer()):this.audioHandle&&this.audioHandle.changeVolume(0)},GameBoyCore.prototype.changeVolume=function(){settings[0]&&this.audioHandle&&this.audioHandle.changeVolume(settings[3])},GameBoyCore.prototype.initAudioBuffer=function(){this.audioIndex=0,this.audioDestinationPosition=0,this.downsampleInput=0,this.bufferContainAmount=Math.max(this.baseCPUCyclesPerIteration*settings[7]/this.audioResamplerFirstPassFactor,4096)<<1,this.numSamplesTotal=this.baseCPUCyclesPerIteration/this.audioResamplerFirstPassFactor<<1,this.audioBuffer=this.getTypedArray(this.numSamplesTotal,0,"float32")},GameBoyCore.prototype.intializeWhiteNoise=function(){var e=1;this.LSFR15Table=this.getTypedArray(524288,0,"int8");for(var t=32767,r=16383,i=0;i<32768;++i)e=1-(1&t),this.LSFR15Table[32768|i]=e,this.LSFR15Table[65536|i]=2*e,this.LSFR15Table[98304|i]=3*e,this.LSFR15Table[131072|i]=4*e,this.LSFR15Table[163840|i]=5*e,this.LSFR15Table[196608|i]=6*e,this.LSFR15Table[229376|i]=7*e,this.LSFR15Table[262144|i]=8*e,this.LSFR15Table[294912|i]=9*e,this.LSFR15Table[327680|i]=10*e,this.LSFR15Table[360448|i]=11*e,this.LSFR15Table[393216|i]=12*e,this.LSFR15Table[425984|i]=13*e,this.LSFR15Table[458752|i]=14*e,this.LSFR15Table[491520|i]=15*e,t=(r=t>>1)|((r^t)&1)<<14;for(i=0,this.LSFR7Table=this.getTypedArray(2048,0,"int8"),t=127;i<128;++i)e=1-(1&t),this.LSFR7Table[128|i]=e,this.LSFR7Table[256|i]=2*e,this.LSFR7Table[384|i]=3*e,this.LSFR7Table[512|i]=4*e,this.LSFR7Table[640|i]=5*e,this.LSFR7Table[768|i]=6*e,this.LSFR7Table[896|i]=7*e,this.LSFR7Table[1024|i]=8*e,this.LSFR7Table[1152|i]=9*e,this.LSFR7Table[1280|i]=10*e,this.LSFR7Table[1408|i]=11*e,this.LSFR7Table[1536|i]=12*e,this.LSFR7Table[1664|i]=13*e,this.LSFR7Table[1792|i]=14*e,this.LSFR7Table[1920|i]=15*e,t=(r=t>>1)|((r^t)&1)<<6;this.noiseSampleTable=this.LSFR15Table},GameBoyCore.prototype.audioUnderrunAdjustment=function(){if(settings[0]){var e=this.audioHandle.remainingBuffer();"number"==typeof e&&(e=this.bufferContainAmount-Math.max(e,0))>0&&this.recalculateIterationClockLimitForAudio((e>>1)*this.audioResamplerFirstPassFactor)}},GameBoyCore.prototype.initializeAudioStartState=function(){this.channel1FrequencyTracker=8192,this.channel1DutyTracker=0,this.channel1CachedDuty=this.dutyLookup[2],this.channel1totalLength=0,this.channel1envelopeVolume=0,this.channel1envelopeType=!1,this.channel1envelopeSweeps=0,this.channel1envelopeSweepsLast=0,this.channel1consecutive=!0,this.channel1frequency=0,this.channel1SweepFault=!1,this.channel1ShadowFrequency=0,this.channel1timeSweep=1,this.channel1lastTimeSweep=0,this.channel1Swept=!1,this.channel1frequencySweepDivider=0,this.channel1decreaseSweep=!1,this.channel2FrequencyTracker=8192,this.channel2DutyTracker=0,this.channel2CachedDuty=this.dutyLookup[2],this.channel2totalLength=0,this.channel2envelopeVolume=0,this.channel2envelopeType=!1,this.channel2envelopeSweeps=0,this.channel2envelopeSweepsLast=0,this.channel2consecutive=!0,this.channel2frequency=0,this.channel3canPlay=!1,this.channel3totalLength=0,this.channel3patternType=4,this.channel3frequency=0,this.channel3consecutive=!0,this.channel3Counter=2048,this.channel4FrequencyPeriod=8,this.channel4totalLength=0,this.channel4envelopeVolume=0,this.channel4currentVolume=0,this.channel4envelopeType=!1,this.channel4envelopeSweeps=0,this.channel4envelopeSweepsLast=0,this.channel4consecutive=!0,this.channel4BitRange=32767,this.noiseSampleTable=this.LSFR15Table,this.channel4VolumeShifter=15,this.channel1FrequencyCounter=8192,this.channel2FrequencyCounter=8192,this.channel3Counter=2048,this.channel3FrequencyPeriod=2048,this.channel3lastSampleLookup=0,this.channel4lastSampleLookup=0,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.mixerOutputCache=0,this.sequencerClocks=8192,this.sequencePosition=0,this.channel4FrequencyPeriod=8,this.channel4Counter=8,this.cachedChannel3Sample=0,this.cachedChannel4Sample=0,this.channel1Enabled=!1,this.channel2Enabled=!1,this.channel3Enabled=!1,this.channel4Enabled=!1,this.channel1canPlay=!1,this.channel2canPlay=!1,this.channel4canPlay=!1,this.audioClocksUntilNextEvent=1,this.audioClocksUntilNextEventCounter=1,this.channel1OutputLevelCache(),this.channel2OutputLevelCache(),this.channel3OutputLevelCache(),this.channel4OutputLevelCache(),this.noiseSampleTable=this.LSFR15Table},GameBoyCore.prototype.outputAudio=function(){this.audioBuffer[this.audioDestinationPosition++]=(this.downsampleInput>>>16)*this.downSampleInputDivider-1,this.audioBuffer[this.audioDestinationPosition++]=(65535&this.downsampleInput)*this.downSampleInputDivider-1,this.audioDestinationPosition==this.numSamplesTotal&&(this.audioHandle.writeAudioNoCallback(this.audioBuffer),this.audioDestinationPosition=0),this.downsampleInput=0},GameBoyCore.prototype.generateAudio=function(e){var t=0;if(this.soundMasterEnabled&&!this.CPUStopped)for(var r=0;e>0;){for(r=Math.min(this.audioClocksUntilNextEventCounter,this.sequencerClocks,e),this.audioClocksUntilNextEventCounter-=r,this.sequencerClocks-=r,e-=r;r>0;)t=Math.min(r,this.audioResamplerFirstPassFactor-this.audioIndex),r-=t,this.audioIndex+=t,this.downsampleInput+=this.mixerOutputCache*t,this.audioIndex==this.audioResamplerFirstPassFactor&&(this.audioIndex=0,this.outputAudio());0==this.sequencerClocks&&(this.audioComputeSequencer(),this.sequencerClocks=8192),0==this.audioClocksUntilNextEventCounter&&this.computeAudioChannels()}else for(;e>0;)t=Math.min(e,this.audioResamplerFirstPassFactor-this.audioIndex),e-=t,this.audioIndex+=t,this.audioIndex==this.audioResamplerFirstPassFactor&&(this.audioIndex=0,this.outputAudio())},GameBoyCore.prototype.generateAudioFake=function(e){if(this.soundMasterEnabled&&!this.CPUStopped)for(var t=0;e>0;)t=Math.min(this.audioClocksUntilNextEventCounter,this.sequencerClocks,e),this.audioClocksUntilNextEventCounter-=t,this.sequencerClocks-=t,e-=t,0==this.sequencerClocks&&(this.audioComputeSequencer(),this.sequencerClocks=8192),0==this.audioClocksUntilNextEventCounter&&this.computeAudioChannels()},GameBoyCore.prototype.audioJIT=function(){settings[0]?this.generateAudio(this.audioTicks):this.generateAudioFake(this.audioTicks),this.audioTicks=0},GameBoyCore.prototype.audioComputeSequencer=function(){switch(this.sequencePosition++){case 0:case 4:this.clockAudioLength();break;case 2:case 6:this.clockAudioLength(),this.clockAudioSweep();break;case 7:this.clockAudioEnvelope(),this.sequencePosition=0}},GameBoyCore.prototype.clockAudioLength=function(){this.channel1totalLength>1?--this.channel1totalLength:1==this.channel1totalLength&&(this.channel1totalLength=0,this.channel1EnableCheck(),this.memory[65318]&=254),this.channel2totalLength>1?--this.channel2totalLength:1==this.channel2totalLength&&(this.channel2totalLength=0,this.channel2EnableCheck(),this.memory[65318]&=253),this.channel3totalLength>1?--this.channel3totalLength:1==this.channel3totalLength&&(this.channel3totalLength=0,this.channel3EnableCheck(),this.memory[65318]&=251),this.channel4totalLength>1?--this.channel4totalLength:1==this.channel4totalLength&&(this.channel4totalLength=0,this.channel4EnableCheck(),this.memory[65318]&=247)},GameBoyCore.prototype.clockAudioSweep=function(){!this.channel1SweepFault&&this.channel1timeSweep>0&&0==--this.channel1timeSweep&&this.runAudioSweep()},GameBoyCore.prototype.runAudioSweep=function(){this.channel1lastTimeSweep>0&&(this.channel1frequencySweepDivider>0?(this.channel1Swept=!0,this.channel1decreaseSweep?(this.channel1ShadowFrequency-=this.channel1ShadowFrequency>>this.channel1frequencySweepDivider,this.channel1frequency=2047&this.channel1ShadowFrequency,this.channel1FrequencyTracker=2048-this.channel1frequency<<2):(this.channel1ShadowFrequency+=this.channel1ShadowFrequency>>this.channel1frequencySweepDivider,this.channel1frequency=this.channel1ShadowFrequency,this.channel1ShadowFrequency<=2047?(this.channel1FrequencyTracker=2048-this.channel1frequency<<2,this.channel1ShadowFrequency+(this.channel1ShadowFrequency>>this.channel1frequencySweepDivider)>2047&&(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)):(this.channel1frequency&=2047,this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)),this.channel1timeSweep=this.channel1lastTimeSweep):(this.channel1SweepFault=!0,this.channel1EnableCheck()))},GameBoyCore.prototype.channel1AudioSweepPerformDummy=function(){if(this.channel1frequencySweepDivider>0&&!this.channel1decreaseSweep){var e=this.channel1ShadowFrequency+(this.channel1ShadowFrequency>>this.channel1frequencySweepDivider);e<=2047?e+(e>>this.channel1frequencySweepDivider)>2047&&(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254):(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)}},GameBoyCore.prototype.clockAudioEnvelope=function(){this.channel1envelopeSweepsLast>-1&&(this.channel1envelopeSweeps>0?--this.channel1envelopeSweeps:this.channel1envelopeType?this.channel1envelopeVolume<15?(++this.channel1envelopeVolume,this.channel1envelopeSweeps=this.channel1envelopeSweepsLast,this.channel1OutputLevelCache()):this.channel1envelopeSweepsLast=-1:this.channel1envelopeVolume>0?(--this.channel1envelopeVolume,this.channel1envelopeSweeps=this.channel1envelopeSweepsLast,this.channel1OutputLevelCache()):this.channel1envelopeSweepsLast=-1),this.channel2envelopeSweepsLast>-1&&(this.channel2envelopeSweeps>0?--this.channel2envelopeSweeps:this.channel2envelopeType?this.channel2envelopeVolume<15?(++this.channel2envelopeVolume,this.channel2envelopeSweeps=this.channel2envelopeSweepsLast,this.channel2OutputLevelCache()):this.channel2envelopeSweepsLast=-1:this.channel2envelopeVolume>0?(--this.channel2envelopeVolume,this.channel2envelopeSweeps=this.channel2envelopeSweepsLast,this.channel2OutputLevelCache()):this.channel2envelopeSweepsLast=-1),this.channel4envelopeSweepsLast>-1&&(this.channel4envelopeSweeps>0?--this.channel4envelopeSweeps:this.channel4envelopeType?this.channel4envelopeVolume<15?(this.channel4currentVolume=++this.channel4envelopeVolume<<this.channel4VolumeShifter,this.channel4envelopeSweeps=this.channel4envelopeSweepsLast,this.channel4UpdateCache()):this.channel4envelopeSweepsLast=-1:this.channel4envelopeVolume>0?(this.channel4currentVolume=--this.channel4envelopeVolume<<this.channel4VolumeShifter,this.channel4envelopeSweeps=this.channel4envelopeSweepsLast,this.channel4UpdateCache()):this.channel4envelopeSweepsLast=-1)},GameBoyCore.prototype.computeAudioChannels=function(){this.channel1FrequencyCounter-=this.audioClocksUntilNextEvent,this.channel2FrequencyCounter-=this.audioClocksUntilNextEvent,this.channel3Counter-=this.audioClocksUntilNextEvent,this.channel4Counter-=this.audioClocksUntilNextEvent,0==this.channel1FrequencyCounter&&(this.channel1FrequencyCounter=this.channel1FrequencyTracker,this.channel1DutyTracker=this.channel1DutyTracker+1&7,this.channel1OutputLevelTrimaryCache()),0==this.channel2FrequencyCounter&&(this.channel2FrequencyCounter=this.channel2FrequencyTracker,this.channel2DutyTracker=this.channel2DutyTracker+1&7,this.channel2OutputLevelTrimaryCache()),0==this.channel3Counter&&(this.channel3canPlay&&(this.channel3lastSampleLookup=this.channel3lastSampleLookup+1&31),this.channel3Counter=this.channel3FrequencyPeriod,this.channel3UpdateCache()),0==this.channel4Counter&&(this.channel4lastSampleLookup=this.channel4lastSampleLookup+1&this.channel4BitRange,this.channel4Counter=this.channel4FrequencyPeriod,this.channel4UpdateCache()),this.audioClocksUntilNextEventCounter=this.audioClocksUntilNextEvent=Math.min(this.channel1FrequencyCounter,this.channel2FrequencyCounter,this.channel3Counter,this.channel4Counter)},GameBoyCore.prototype.channel1EnableCheck=function(){this.channel1Enabled=(this.channel1consecutive||this.channel1totalLength>0)&&!this.channel1SweepFault&&this.channel1canPlay,this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1VolumeEnableCheck=function(){this.channel1canPlay=this.memory[65298]>7,this.channel1EnableCheck(),this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1OutputLevelCache=function(){this.channel1currentSampleLeft=this.leftChannel1?this.channel1envelopeVolume:0,this.channel1currentSampleRight=this.rightChannel1?this.channel1envelopeVolume:0,this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1OutputLevelSecondaryCache=function(){this.channel1Enabled?(this.channel1currentSampleLeftSecondary=this.channel1currentSampleLeft,this.channel1currentSampleRightSecondary=this.channel1currentSampleRight):(this.channel1currentSampleLeftSecondary=0,this.channel1currentSampleRightSecondary=0),this.channel1OutputLevelTrimaryCache()},GameBoyCore.prototype.channel1OutputLevelTrimaryCache=function(){this.channel1CachedDuty[this.channel1DutyTracker]&&settings[14][0]?(this.channel1currentSampleLeftTrimary=this.channel1currentSampleLeftSecondary,this.channel1currentSampleRightTrimary=this.channel1currentSampleRightSecondary):(this.channel1currentSampleLeftTrimary=0,this.channel1currentSampleRightTrimary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel2EnableCheck=function(){this.channel2Enabled=(this.channel2consecutive||this.channel2totalLength>0)&&this.channel2canPlay,this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2VolumeEnableCheck=function(){this.channel2canPlay=this.memory[65303]>7,this.channel2EnableCheck(),this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2OutputLevelCache=function(){this.channel2currentSampleLeft=this.leftChannel2?this.channel2envelopeVolume:0,this.channel2currentSampleRight=this.rightChannel2?this.channel2envelopeVolume:0,this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2OutputLevelSecondaryCache=function(){this.channel2Enabled?(this.channel2currentSampleLeftSecondary=this.channel2currentSampleLeft,this.channel2currentSampleRightSecondary=this.channel2currentSampleRight):(this.channel2currentSampleLeftSecondary=0,this.channel2currentSampleRightSecondary=0),this.channel2OutputLevelTrimaryCache()},GameBoyCore.prototype.channel2OutputLevelTrimaryCache=function(){this.channel2CachedDuty[this.channel2DutyTracker]&&settings[14][1]?(this.channel2currentSampleLeftTrimary=this.channel2currentSampleLeftSecondary,this.channel2currentSampleRightTrimary=this.channel2currentSampleRightSecondary):(this.channel2currentSampleLeftTrimary=0,this.channel2currentSampleRightTrimary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel3EnableCheck=function(){this.channel3Enabled=this.channel3consecutive||this.channel3totalLength>0,this.channel3OutputLevelSecondaryCache()},GameBoyCore.prototype.channel3OutputLevelCache=function(){this.channel3currentSampleLeft=this.leftChannel3?this.cachedChannel3Sample:0,this.channel3currentSampleRight=this.rightChannel3?this.cachedChannel3Sample:0,this.channel3OutputLevelSecondaryCache()},GameBoyCore.prototype.channel3OutputLevelSecondaryCache=function(){this.channel3Enabled&&settings[14][2]?(this.channel3currentSampleLeftSecondary=this.channel3currentSampleLeft,this.channel3currentSampleRightSecondary=this.channel3currentSampleRight):(this.channel3currentSampleLeftSecondary=0,this.channel3currentSampleRightSecondary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel4EnableCheck=function(){this.channel4Enabled=(this.channel4consecutive||this.channel4totalLength>0)&&this.channel4canPlay,this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4VolumeEnableCheck=function(){this.channel4canPlay=this.memory[65313]>7,this.channel4EnableCheck(),this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4OutputLevelCache=function(){this.channel4currentSampleLeft=this.leftChannel4?this.cachedChannel4Sample:0,this.channel4currentSampleRight=this.rightChannel4?this.cachedChannel4Sample:0,this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4OutputLevelSecondaryCache=function(){this.channel4Enabled&&settings[14][3]?(this.channel4currentSampleLeftSecondary=this.channel4currentSampleLeft,this.channel4currentSampleRightSecondary=this.channel4currentSampleRight):(this.channel4currentSampleLeftSecondary=0,this.channel4currentSampleRightSecondary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.mixerOutputLevelCache=function(){this.mixerOutputCache=(this.channel1currentSampleLeftTrimary+this.channel2currentSampleLeftTrimary+this.channel3currentSampleLeftSecondary+this.channel4currentSampleLeftSecondary)*this.VinLeftChannelMasterVolume<<16|(this.channel1currentSampleRightTrimary+this.channel2currentSampleRightTrimary+this.channel3currentSampleRightSecondary+this.channel4currentSampleRightSecondary)*this.VinRightChannelMasterVolume},GameBoyCore.prototype.channel3UpdateCache=function(){this.cachedChannel3Sample=this.channel3PCM[this.channel3lastSampleLookup]>>this.channel3patternType,this.channel3OutputLevelCache()},GameBoyCore.prototype.channel3WriteRAM=function(e,t){this.channel3canPlay&&this.audioJIT(),this.memory[65328|e]=t,e<<=1,this.channel3PCM[e]=t>>4,this.channel3PCM[1|e]=15&t},GameBoyCore.prototype.channel4UpdateCache=function(){this.cachedChannel4Sample=this.noiseSampleTable[this.channel4currentVolume|this.channel4lastSampleLookup],this.channel4OutputLevelCache()},GameBoyCore.prototype.run=function(){(2&this.stopEmulator)==0&&((1&this.stopEmulator)==1?this.CPUStopped?(this.audioUnderrunAdjustment(),this.audioTicks+=this.CPUCyclesTotal,this.audioJIT(),this.stopEmulator|=1):(this.stopEmulator=0,this.audioUnderrunAdjustment(),this.clockUpdate(),this.halt?(this.CPUTicks=0,this.calculateHALTPeriod(),this.halt?(this.updateCore(),this.iterationEndRoutine()):this.executeIteration()):this.executeIteration(),this.requestDraw()):(cout("Iterator restarted a faulted core.",2),pause()))},GameBoyCore.prototype.executeIteration=function(){for(var e=0,t=0;0==this.stopEmulator;){switch(this.IRQEnableDelay){case 1:this.IME=!0,this.checkIRQMatching();case 2:--this.IRQEnableDelay}if(this.IRQLineMatched>0&&this.launchIRQ(),e=this.memoryReader[this.programCounter](this,this.programCounter),this.programCounter=this.programCounter+1&65535,this.skipPCIncrement&&(this.programCounter=this.programCounter-1&65535,this.skipPCIncrement=!1),this.CPUTicks=this.TICKTable[e],this.OPCODE[e](this),this.LCDTicks+=this.CPUTicks>>this.doubleSpeedShifter,this.LCDCONTROL[this.actualScanLine](this),t=this.CPUTicks>>this.doubleSpeedShifter,this.audioTicks+=t,this.emulatorTicks+=t,this.DIVTicks+=this.CPUTicks,this.TIMAEnabled)for(this.timerTicks+=this.CPUTicks;this.timerTicks>=this.TACClocker;)this.timerTicks-=this.TACClocker,256==++this.memory[65285]&&(this.memory[65285]=this.memory[65286],this.interruptsRequested|=4,this.checkIRQMatching());this.serialTimer>0&&(this.serialTimer-=this.CPUTicks,this.serialTimer<=0&&(this.interruptsRequested|=8,this.checkIRQMatching()),this.serialShiftTimer-=this.CPUTicks,this.serialShiftTimer<=0&&(this.serialShiftTimer=this.serialShiftTimerAllocated,this.memory[65281]=this.memory[65281]<<1&254|1)),this.emulatorTicks>=this.CPUCyclesTotal&&this.iterationEndRoutine()}},GameBoyCore.prototype.iterationEndRoutine=function(){(1&this.stopEmulator)==0&&(this.audioJIT(),this.memory[65284]=this.memory[65284]+(this.DIVTicks>>8)&255,this.DIVTicks&=255,this.stopEmulator|=1,this.emulatorTicks-=this.CPUCyclesTotal,this.CPUCyclesTotalCurrent+=this.CPUCyclesTotalRoundoff,this.recalculateIterationClockLimit())},GameBoyCore.prototype.handleSTOP=function(){this.CPUStopped=!0,this.iterationEndRoutine(),this.emulatorTicks<0&&(this.audioTicks-=this.emulatorTicks,this.audioJIT())},GameBoyCore.prototype.recalculateIterationClockLimit=function(){var e=this.CPUCyclesTotalCurrent%4;this.CPUCyclesTotal=this.CPUCyclesTotalBase+this.CPUCyclesTotalCurrent-e,this.CPUCyclesTotalCurrent=e},GameBoyCore.prototype.recalculateIterationClockLimitForAudio=function(e){this.CPUCyclesTotal+=Math.min(e>>2<<2,this.CPUCyclesTotalBase<<1)},GameBoyCore.prototype.scanLineMode2=function(){1!=this.STATTracker&&(this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=1,this.modeSTAT=2)},GameBoyCore.prototype.scanLineMode3=function(){3!=this.modeSTAT&&(0==this.STATTracker&&this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=1,this.modeSTAT=3)},GameBoyCore.prototype.scanLineMode0=function(){0!=this.modeSTAT&&(2!=this.STATTracker&&(0==this.STATTracker&&(this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.modeSTAT=3),this.incrementScanLineQueue(),this.updateSpriteCount(this.actualScanLine),this.STATTracker=2),this.LCDTicks>=this.spriteCount&&(this.hdmaRunning&&this.executeHDMA(),this.mode0TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=3,this.modeSTAT=0))},GameBoyCore.prototype.clocksUntilLYCMatch=function(){return 0!=this.memory[65349]?this.memory[65349]>this.actualScanLine?456*(this.memory[65349]-this.actualScanLine):456*(154-this.actualScanLine+this.memory[65349]):456*(153==this.actualScanLine&&0==this.memory[65348]?154:153-this.actualScanLine)+8},GameBoyCore.prototype.clocksUntilMode0=function(){switch(this.modeSTAT){case 0:if(143==this.actualScanLine)return this.updateSpriteCount(0),this.spriteCount+5016;return this.updateSpriteCount(this.actualScanLine+1),this.spriteCount+456;case 2:case 3:return this.updateSpriteCount(this.actualScanLine),this.spriteCount;case 1:return this.updateSpriteCount(0),this.spriteCount+456*(154-this.actualScanLine)}},GameBoyCore.prototype.updateSpriteCount=function(e){if(this.spriteCount=252,this.cGBC&&this.gfxSpriteShow)for(var t=e+16,r=0,i=this.gfxSpriteNormalHeight?8:16,s=65024;s<65184&&this.spriteCount<312;s+=4)(r=t-this.memory[s])>-1&&r<i&&(this.spriteCount+=6)},GameBoyCore.prototype.matchLYC=function(){this.memory[65348]==this.memory[65349]?(this.memory[65345]|=4,this.LYCMatchTriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching())):this.memory[65345]&=123},GameBoyCore.prototype.updateCore=function(){this.LCDTicks+=this.CPUTicks>>this.doubleSpeedShifter,this.LCDCONTROL[this.actualScanLine](this);var e=this.CPUTicks>>this.doubleSpeedShifter;if(this.audioTicks+=e,this.emulatorTicks+=e,this.DIVTicks+=this.CPUTicks,this.TIMAEnabled)for(this.timerTicks+=this.CPUTicks;this.timerTicks>=this.TACClocker;)this.timerTicks-=this.TACClocker,256==++this.memory[65285]&&(this.memory[65285]=this.memory[65286],this.interruptsRequested|=4,this.checkIRQMatching());this.serialTimer>0&&(this.serialTimer-=this.CPUTicks,this.serialTimer<=0&&(this.interruptsRequested|=8,this.checkIRQMatching()),this.serialShiftTimer-=this.CPUTicks,this.serialShiftTimer<=0&&(this.serialShiftTimer=this.serialShiftTimerAllocated,this.memory[65281]=this.memory[65281]<<1&254|1))},GameBoyCore.prototype.updateCoreFull=function(){this.updateCore(),this.emulatorTicks>=this.CPUCyclesTotal&&this.iterationEndRoutine()},GameBoyCore.prototype.initializeLCDController=function(){for(var e=0;e<154;)e<143?this.LINECONTROL[e]=function(e){e.LCDTicks<80?e.scanLineMode2():e.LCDTicks<252?e.scanLineMode3():e.LCDTicks<456?e.scanLineMode0():(e.LCDTicks-=456,3!=e.STATTracker&&(2!=e.STATTracker&&(0==e.STATTracker&&e.mode2TriggerSTAT&&(e.interruptsRequested|=2),e.incrementScanLineQueue()),e.hdmaRunning&&e.executeHDMA(),e.mode0TriggerSTAT&&(e.interruptsRequested|=2)),e.actualScanLine=++e.memory[65348],e.actualScanLine==e.memory[65349]?(e.memory[65345]|=4,e.LYCMatchTriggerSTAT&&(e.interruptsRequested|=2)):e.memory[65345]&=123,e.checkIRQMatching(),e.STATTracker=0,e.modeSTAT=2,e.LINECONTROL[e.actualScanLine](e))}:143==e?this.LINECONTROL[143]=function(e){e.LCDTicks<80?e.scanLineMode2():e.LCDTicks<252?e.scanLineMode3():e.LCDTicks<456?e.scanLineMode0():(e.LCDTicks-=456,3!=e.STATTracker&&(2!=e.STATTracker&&(0==e.STATTracker&&e.mode2TriggerSTAT&&(e.interruptsRequested|=2),e.incrementScanLineQueue()),e.hdmaRunning&&e.executeHDMA(),e.mode0TriggerSTAT&&(e.interruptsRequested|=2)),e.actualScanLine=e.memory[65348]=144,144==e.memory[65349]?(e.memory[65345]|=4,e.LYCMatchTriggerSTAT&&(e.interruptsRequested|=2)):e.memory[65345]&=123,e.STATTracker=0,e.modeSTAT=1,e.interruptsRequested|=e.mode1TriggerSTAT?3:1,e.checkIRQMatching(),0==e.drewBlank?(e.totalLinesPassed<144||144==e.totalLinesPassed&&e.midScanlineOffset>-1)&&(e.graphicsJITVBlank(),e.prepareFrame()):--e.drewBlank,e.LINECONTROL[144](e))}:e<153?this.LINECONTROL[e]=function(e){e.LCDTicks>=456&&(e.LCDTicks-=456,e.actualScanLine=++e.memory[65348],e.actualScanLine==e.memory[65349]?(e.memory[65345]|=4,e.LYCMatchTriggerSTAT&&(e.interruptsRequested|=2,e.checkIRQMatching())):e.memory[65345]&=123,e.LINECONTROL[e.actualScanLine](e))}:this.LINECONTROL[153]=function(e){e.LCDTicks>=8&&(4!=e.STATTracker&&153==e.memory[65348]&&(e.memory[65348]=0,0==e.memory[65349]?(e.memory[65345]|=4,e.LYCMatchTriggerSTAT&&(e.interruptsRequested|=2,e.checkIRQMatching())):e.memory[65345]&=123,e.STATTracker=4),e.LCDTicks>=456&&(e.LCDTicks-=456,e.STATTracker=e.actualScanLine=0,e.LINECONTROL[0](e)))},++e},GameBoyCore.prototype.DisplayShowOff=function(){0==this.drewBlank&&(this.clearFrameBuffer(),this.drewFrame=!0),this.drewBlank=2},GameBoyCore.prototype.executeHDMA=function(){this.DMAWrite(1),this.halt?this.LCDTicks-this.spriteCount<(4>>this.doubleSpeedShifter|32)&&(this.CPUTicks=4+(32+this.spriteCount<<this.doubleSpeedShifter),this.LCDTicks=this.spriteCount+(4>>this.doubleSpeedShifter|32)):this.LCDTicks+=4>>this.doubleSpeedShifter|32,0==this.memory[65365]?(this.hdmaRunning=!1,this.memory[65365]=255):--this.memory[65365]},GameBoyCore.prototype.clockUpdate=function(){if(this.cTIMER){var e=new Date().getTime(),t=e-this.lastIteration;if(this.lastIteration=e,this.cTIMER&&!this.RTCHALT)for(this.RTCSeconds+=t/1e3;this.RTCSeconds>=60;)this.RTCSeconds-=60,++this.RTCMinutes,this.RTCMinutes>=60&&(this.RTCMinutes-=60,++this.RTCHours,this.RTCHours>=24&&(this.RTCHours-=24,++this.RTCDays,this.RTCDays>=512&&(this.RTCDays-=512,this.RTCDayOverFlow=!0)))}},GameBoyCore.prototype.prepareFrame=function(){this.swizzleFrameBuffer(),this.drewFrame=!0},GameBoyCore.prototype.requestDraw=function(){this.drewFrame&&this.dispatchDraw()},GameBoyCore.prototype.dispatchDraw=function(){this.offscreenRGBCount>0&&(92160==this.offscreenRGBCount?this.processDraw(this.swizzledFrame):this.resizeFrameBuffer())},GameBoyCore.prototype.processDraw=function(e){for(var t=this.offscreenRGBCount,r=this.canvasBuffer.data,i=0,s=0;s<t;++s)r[s++]=e[i++],r[s++]=e[i++],r[s++]=e[i++];this.graphicsBlit(),this.drewFrame=!1},GameBoyCore.prototype.swizzleFrameBuffer=function(){for(var e=this.frameBuffer,t=this.swizzledFrame,r=0,i=0;i<69120;)t[i++]=e[r]>>16&255,t[i++]=e[r]>>8&255,t[i++]=255&e[r++]},GameBoyCore.prototype.clearFrameBuffer=function(){var e=0,t=this.swizzledFrame;if(this.cGBC||this.colorizedGBPalettes)for(;e<69120;)t[e++]=248;else for(;e<69120;)t[e++]=239,t[e++]=255,t[e++]=222},GameBoyCore.prototype.resizeFrameBuffer=function(){this.resizePathClear&&(this.resizePathClear=!1,this.resizer.resize(this.swizzledFrame))},GameBoyCore.prototype.compileResizeFrameBufferFunction=function(){if(this.offscreenRGBCount>0){var e=this;this.resizer=new Resize(160,144,this.offscreenWidth,this.offscreenHeight,!1,settings[13],!1,function(t){t.length/3*4==e.offscreenRGBCount&&e.processDraw(t),e.resizePathClear=!0})}},GameBoyCore.prototype.renderScanLine=function(e){if(this.pixelStart=160*e,this.bgEnabled)this.pixelEnd=160,this.BGLayerRender(e),this.WindowLayerRender(e);else for(var t=(e+1)*160,r=this.cGBC||this.colorizedGBPalettes?16316664:15728606,i=160*e+this.currentX;i<t;i++)this.frameBuffer[i]=r;this.SpriteLayerRender(e),this.currentX=0,this.midScanlineOffset=-1},GameBoyCore.prototype.renderMidScanLine=function(){if(this.actualScanLine<144&&3==this.modeSTAT&&(-1==this.midScanlineOffset&&(this.midScanlineOffset=7&this.backgroundX),this.LCDTicks>=82)){if(this.pixelEnd=this.LCDTicks-74,this.pixelEnd=Math.min(this.pixelEnd-this.midScanlineOffset-this.pixelEnd%8,160),this.bgEnabled)this.pixelStart=160*this.lastUnrenderedLine,this.BGLayerRender(this.lastUnrenderedLine),this.WindowLayerRender(this.lastUnrenderedLine);else for(var e=160*this.lastUnrenderedLine+this.pixelEnd,t=this.cGBC||this.colorizedGBPalettes?16316664:15728606,r=160*this.lastUnrenderedLine+this.currentX;r<e;r++)this.frameBuffer[r]=t;this.currentX=this.pixelEnd}},GameBoyCore.prototype.initializeModeSpecificArrays=function(){this.LCDCONTROL=this.LCDisOn?this.LINECONTROL:this.DISPLAYOFFCONTROL,this.cGBC?(this.gbcOBJRawPalette=this.getTypedArray(64,0,"uint8"),this.gbcBGRawPalette=this.getTypedArray(64,0,"uint8"),this.gbcOBJPalette=this.getTypedArray(32,16777216,"int32"),this.gbcBGPalette=this.getTypedArray(64,0,"int32"),this.BGCHRBank2=this.getTypedArray(2048,0,"uint8"),this.BGCHRCurrentBank=this.currVRAMBank>0?this.BGCHRBank2:this.BGCHRBank1,this.tileCache=this.generateCacheArray(3968)):(this.gbOBJPalette=this.getTypedArray(8,0,"int32"),this.gbBGPalette=this.getTypedArray(4,0,"int32"),this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette,this.tileCache=this.generateCacheArray(1792),this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32")),this.renderPathBuild()},GameBoyCore.prototype.GBCtoGBModeAdjust=function(){cout("Stepping down from GBC mode.",0),this.VRAM=this.GBCMemory=this.BGCHRCurrentBank=this.BGCHRBank2=null,this.tileCache.length=1792,settings[4]?(this.gbBGColorizedPalette=this.getTypedArray(4,0,"int32"),this.gbOBJColorizedPalette=this.getTypedArray(8,0,"int32"),this.cachedBGPaletteConversion=this.getTypedArray(4,0,"int32"),this.cachedOBJPaletteConversion=this.getTypedArray(8,0,"int32"),this.BGPalette=this.gbBGColorizedPalette,this.OBJPalette=this.gbOBJColorizedPalette,this.gbOBJPalette=this.gbBGPalette=null,this.getGBCColor()):(this.gbOBJPalette=this.getTypedArray(8,0,"int32"),this.gbBGPalette=this.getTypedArray(4,0,"int32"),this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette),this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32"),this.renderPathBuild(),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile()},GameBoyCore.prototype.renderPathBuild=function(){this.cGBC?(this.priorityFlaggingPathRebuild(),this.SpriteLayerRender=this.SpriteGBCLayerRender):(this.BGLayerRender=this.BGGBLayerRender,this.WindowLayerRender=this.WindowGBLayerRender,this.SpriteLayerRender=this.SpriteGBLayerRender)},GameBoyCore.prototype.priorityFlaggingPathRebuild=function(){this.BGPriorityEnabled?(this.BGLayerRender=this.BGGBCLayerRender,this.WindowLayerRender=this.WindowGBCLayerRender):(this.BGLayerRender=this.BGGBCLayerRenderNoPriorityFlagging,this.WindowLayerRender=this.WindowGBCLayerRenderNoPriorityFlagging)},GameBoyCore.prototype.initializeReferencesFromSaveState=function(){this.LCDCONTROL=this.LCDisOn?this.LINECONTROL:this.DISPLAYOFFCONTROL;var e=0;if(this.cGBC)for(this.BGCHRCurrentBank=this.currVRAMBank>0?this.BGCHRBank2:this.BGCHRBank1,this.tileCache=this.generateCacheArray(3968);e<6144;e+=16)this.generateGBCTileBank1(e),this.generateGBCTileBank2(e);else{for(this.colorizedGBPalettes?(this.BGPalette=this.gbBGColorizedPalette,this.OBJPalette=this.gbOBJColorizedPalette,this.updateGBBGPalette=this.updateGBColorizedBGPalette,this.updateGBOBJPalette=this.updateGBColorizedOBJPalette):(this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette),this.tileCache=this.generateCacheArray(1792),e=32768;e<36864;e+=2)this.generateGBOAMTileLine(e);for(e=36864;e<38912;e+=2)this.generateGBTileLine(e);this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32")}this.renderPathBuild()},GameBoyCore.prototype.RGBTint=function(e){var t=31&e,r=e>>5&31,i=e>>10&31;return 13*t+2*r+i>>1<<16|3*r+i<<9|3*t+2*r+11*i>>1},GameBoyCore.prototype.getGBCColor=function(){for(var e=0;e<4;e++){var t=e<<1;this.cachedBGPaletteConversion[e]=this.RGBTint(this.gbcBGRawPalette[1|t]<<8|this.gbcBGRawPalette[t]),this.cachedOBJPaletteConversion[e]=this.RGBTint(this.gbcOBJRawPalette[1|t]<<8|this.gbcOBJRawPalette[t])}for(e=4;e<8;e++)t=e<<1,this.cachedOBJPaletteConversion[e]=this.RGBTint(this.gbcOBJRawPalette[1|t]<<8|this.gbcOBJRawPalette[t]);this.updateGBBGPalette=this.updateGBColorizedBGPalette,this.updateGBOBJPalette=this.updateGBColorizedOBJPalette,this.updateGBBGPalette(this.memory[65351]),this.updateGBOBJPalette(0,this.memory[65352]),this.updateGBOBJPalette(1,this.memory[65353]),this.colorizedGBPalettes=!0},GameBoyCore.prototype.updateGBRegularBGPalette=function(e){this.gbBGPalette[0]=33554432|this.colors[3&e],this.gbBGPalette[1]=this.colors[e>>2&3],this.gbBGPalette[2]=this.colors[e>>4&3],this.gbBGPalette[3]=this.colors[e>>6]},GameBoyCore.prototype.updateGBColorizedBGPalette=function(e){this.gbBGColorizedPalette[0]=33554432|this.cachedBGPaletteConversion[3&e],this.gbBGColorizedPalette[1]=this.cachedBGPaletteConversion[e>>2&3],this.gbBGColorizedPalette[2]=this.cachedBGPaletteConversion[e>>4&3],this.gbBGColorizedPalette[3]=this.cachedBGPaletteConversion[e>>6]},GameBoyCore.prototype.updateGBRegularOBJPalette=function(e,t){this.gbOBJPalette[1|e]=this.colors[t>>2&3],this.gbOBJPalette[2|e]=this.colors[t>>4&3],this.gbOBJPalette[3|e]=this.colors[t>>6]},GameBoyCore.prototype.updateGBColorizedOBJPalette=function(e,t){this.gbOBJColorizedPalette[1|e]=this.cachedOBJPaletteConversion[e|t>>2&3],this.gbOBJColorizedPalette[2|e]=this.cachedOBJPaletteConversion[e|t>>4&3],this.gbOBJColorizedPalette[3|e]=this.cachedOBJPaletteConversion[e|t>>6]},GameBoyCore.prototype.updateGBCBGPalette=function(e,t){this.gbcBGRawPalette[e]!=t&&(this.midScanLineJIT(),this.gbcBGRawPalette[e]=t,(6&e)==0?(t=33554432|this.RGBTint(this.gbcBGRawPalette[1|e]<<8|this.gbcBGRawPalette[62&e]),e>>=1,this.gbcBGPalette[e]=t,this.gbcBGPalette[32|e]=16777216|t):(t=this.RGBTint(this.gbcBGRawPalette[1|e]<<8|this.gbcBGRawPalette[62&e]),e>>=1,this.gbcBGPalette[e]=t,this.gbcBGPalette[32|e]=16777216|t))},GameBoyCore.prototype.updateGBCOBJPalette=function(e,t){this.gbcOBJRawPalette[e]!=t&&(this.gbcOBJRawPalette[e]=t,(6&e)>0&&(this.midScanLineJIT(),this.gbcOBJPalette[e>>1]=16777216|this.RGBTint(this.gbcOBJRawPalette[1|e]<<8|this.gbcOBJRawPalette[62&e])))},GameBoyCore.prototype.BGGBLayerRender=function(e){var t=this.backgroundY+e&255,r=(7&t)<<3,i=this.gfxBackgroundCHRBankPosition|(248&t)<<2,s=this.backgroundX+this.currentX&255,a=this.pixelStart+this.currentX,n=this.pixelStart+(this.gfxWindowDisplay&&e-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),$=i+(s>>3),o=this.BGCHRBank1[$];o<this.gfxBackgroundBankOffset&&(o|=256);for(var h=this.tileCache[o],c=7&s;c<8&&a<n&&s<256;++s)this.frameBuffer[a++]=this.BGPalette[h[r|c++]];var F=Math.min(n-a,256-s)>>3;for(s+=F<<3,F+=$;$<F;)(o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.tileCache[o],c=r,this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c]];if(a<n){if(s<256)for((o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.tileCache[o],c=r-1;a<n&&s<256;++s)this.frameBuffer[a++]=this.BGPalette[h[++c]];for(F=(n-a>>3)+i;i<F;)(o=this.BGCHRBank1[i++])<this.gfxBackgroundBankOffset&&(o|=256),h=this.tileCache[o],c=r,this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c++]],this.frameBuffer[a++]=this.BGPalette[h[c]];if(a<n)switch((o=this.BGCHRBank1[i])<this.gfxBackgroundBankOffset&&(o|=256),h=this.tileCache[o],n-a){case 7:this.frameBuffer[a+6]=this.BGPalette[h[6|r]];case 6:this.frameBuffer[a+5]=this.BGPalette[h[5|r]];case 5:this.frameBuffer[a+4]=this.BGPalette[h[4|r]];case 4:this.frameBuffer[a+3]=this.BGPalette[h[3|r]];case 3:this.frameBuffer[a+2]=this.BGPalette[h[2|r]];case 2:this.frameBuffer[a+1]=this.BGPalette[h[1|r]];case 1:this.frameBuffer[a]=this.BGPalette[h[r]]}}},GameBoyCore.prototype.BGGBCLayerRender=function(e){var t=this.backgroundY+e&255,r=(7&t)<<3,i=this.gfxBackgroundCHRBankPosition|(248&t)<<2,s=this.backgroundX+this.currentX&255,a=this.pixelStart+this.currentX,n=this.pixelStart+(this.gfxWindowDisplay&&e-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),$=i+(s>>3),o=this.BGCHRBank1[$];o<this.gfxBackgroundBankOffset&&(o|=256);for(var h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2|(128&h)>>2,m=7&s;m<8&&a<n&&s<256;++s)this.frameBuffer[a++]=this.gbcBGPalette[F|c[r|m++]];var l=Math.min(n-a,256-s)>>3;for(s+=l<<3,l+=$;$<l;)(o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2|(128&h)>>2,m=r,this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m]];if(a<n){if(s<256)for((o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2|(128&h)>>2,m=r-1;a<n&&s<256;++s)this.frameBuffer[a++]=this.gbcBGPalette[F|c[++m]];for(l=(n-a>>3)+i;i<l;)(o=this.BGCHRBank1[i])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[i++],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2|(128&h)>>2,m=r,this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m]];if(a<n)switch((o=this.BGCHRBank1[i])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[i],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2|(128&h)>>2,n-a){case 7:this.frameBuffer[a+6]=this.gbcBGPalette[F|c[6|r]];case 6:this.frameBuffer[a+5]=this.gbcBGPalette[F|c[5|r]];case 5:this.frameBuffer[a+4]=this.gbcBGPalette[F|c[4|r]];case 4:this.frameBuffer[a+3]=this.gbcBGPalette[F|c[3|r]];case 3:this.frameBuffer[a+2]=this.gbcBGPalette[F|c[2|r]];case 2:this.frameBuffer[a+1]=this.gbcBGPalette[F|c[1|r]];case 1:this.frameBuffer[a]=this.gbcBGPalette[F|c[r]]}}},GameBoyCore.prototype.BGGBCLayerRenderNoPriorityFlagging=function(e){var t=this.backgroundY+e&255,r=(7&t)<<3,i=this.gfxBackgroundCHRBankPosition|(248&t)<<2,s=this.backgroundX+this.currentX&255,a=this.pixelStart+this.currentX,n=this.pixelStart+(this.gfxWindowDisplay&&e-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),$=i+(s>>3),o=this.BGCHRBank1[$];o<this.gfxBackgroundBankOffset&&(o|=256);for(var h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2,m=7&s;m<8&&a<n&&s<256;++s)this.frameBuffer[a++]=this.gbcBGPalette[F|c[r|m++]];var l=Math.min(n-a,256-s)>>3;for(s+=l<<3,l+=$;$<l;)(o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2,m=r,this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m]];if(a<n){if(s<256)for((o=this.BGCHRBank1[++$])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[$],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2,m=r-1;a<n&&s<256;++s)this.frameBuffer[a++]=this.gbcBGPalette[F|c[++m]];for(l=(n-a>>3)+i;i<l;)(o=this.BGCHRBank1[i])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[i++],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2,m=r,this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m++]],this.frameBuffer[a++]=this.gbcBGPalette[F|c[m]];if(a<n)switch((o=this.BGCHRBank1[i])<this.gfxBackgroundBankOffset&&(o|=256),h=this.BGCHRBank2[i],c=this.tileCache[(8&h)<<8|(96&h)<<4|o],F=(7&h)<<2,n-a){case 7:this.frameBuffer[a+6]=this.gbcBGPalette[F|c[6|r]];case 6:this.frameBuffer[a+5]=this.gbcBGPalette[F|c[5|r]];case 5:this.frameBuffer[a+4]=this.gbcBGPalette[F|c[4|r]];case 4:this.frameBuffer[a+3]=this.gbcBGPalette[F|c[3|r]];case 3:this.frameBuffer[a+2]=this.gbcBGPalette[F|c[2|r]];case 2:this.frameBuffer[a+1]=this.gbcBGPalette[F|c[1|r]];case 1:this.frameBuffer[a]=this.gbcBGPalette[F|c[r]]}}},GameBoyCore.prototype.WindowGBLayerRender=function(e){if(this.gfxWindowDisplay){var t=e-this.windowY;if(t>=0){var r=this.windowX>0?this.windowX+this.currentX:this.currentX,i=this.pixelStart+r,s=this.pixelStart+this.pixelEnd;if(i<s){var a=(7&t)<<3,n=(this.gfxWindowCHRBankPosition|(248&t)<<2)+(this.currentX>>3),$=this.BGCHRBank1[n];$<this.gfxBackgroundBankOffset&&($|=256);var o=this.tileCache[$],h=r-this.windowX&7;for(r=Math.min(8,h+s-i);h<r;)this.frameBuffer[i++]=this.BGPalette[o[a|h++]];for(r=n+(s-i>>3);n<r;)($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.tileCache[$],h=a,this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h++]],this.frameBuffer[i++]=this.BGPalette[o[h]];if(i<s)switch(($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.tileCache[$],s-i){case 7:this.frameBuffer[i+6]=this.BGPalette[o[6|a]];case 6:this.frameBuffer[i+5]=this.BGPalette[o[5|a]];case 5:this.frameBuffer[i+4]=this.BGPalette[o[4|a]];case 4:this.frameBuffer[i+3]=this.BGPalette[o[3|a]];case 3:this.frameBuffer[i+2]=this.BGPalette[o[2|a]];case 2:this.frameBuffer[i+1]=this.BGPalette[o[1|a]];case 1:this.frameBuffer[i]=this.BGPalette[o[a]]}}}}},GameBoyCore.prototype.WindowGBCLayerRender=function(e){if(this.gfxWindowDisplay){var t=e-this.windowY;if(t>=0){var r=this.windowX>0?this.windowX+this.currentX:this.currentX,i=this.pixelStart+r,s=this.pixelStart+this.pixelEnd;if(i<s){var a=(7&t)<<3,n=(this.gfxWindowCHRBankPosition|(248&t)<<2)+(this.currentX>>3),$=this.BGCHRBank1[n];$<this.gfxBackgroundBankOffset&&($|=256);var o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2|(128&o)>>2,F=r-this.windowX&7;for(r=Math.min(8,F+s-i);F<r;)this.frameBuffer[i++]=this.gbcBGPalette[c|h[a|F++]];for(r=n+(s-i>>3);n<r;)($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2|(128&o)>>2,F=a,this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F]];if(i<s)switch(($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2|(128&o)>>2,s-i){case 7:this.frameBuffer[i+6]=this.gbcBGPalette[c|h[6|a]];case 6:this.frameBuffer[i+5]=this.gbcBGPalette[c|h[5|a]];case 5:this.frameBuffer[i+4]=this.gbcBGPalette[c|h[4|a]];case 4:this.frameBuffer[i+3]=this.gbcBGPalette[c|h[3|a]];case 3:this.frameBuffer[i+2]=this.gbcBGPalette[c|h[2|a]];case 2:this.frameBuffer[i+1]=this.gbcBGPalette[c|h[1|a]];case 1:this.frameBuffer[i]=this.gbcBGPalette[c|h[a]]}}}}},GameBoyCore.prototype.WindowGBCLayerRenderNoPriorityFlagging=function(e){if(this.gfxWindowDisplay){var t=e-this.windowY;if(t>=0){var r=this.windowX>0?this.windowX+this.currentX:this.currentX,i=this.pixelStart+r,s=this.pixelStart+this.pixelEnd;if(i<s){var a=(7&t)<<3,n=(this.gfxWindowCHRBankPosition|(248&t)<<2)+(this.currentX>>3),$=this.BGCHRBank1[n];$<this.gfxBackgroundBankOffset&&($|=256);var o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2,F=r-this.windowX&7;for(r=Math.min(8,F+s-i);F<r;)this.frameBuffer[i++]=this.gbcBGPalette[c|h[a|F++]];for(r=n+(s-i>>3);n<r;)($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2,F=a,this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F++]],this.frameBuffer[i++]=this.gbcBGPalette[c|h[F]];if(i<s)switch(($=this.BGCHRBank1[++n])<this.gfxBackgroundBankOffset&&($|=256),o=this.BGCHRBank2[n],h=this.tileCache[(8&o)<<8|(96&o)<<4|$],c=(7&o)<<2,s-i){case 7:this.frameBuffer[i+6]=this.gbcBGPalette[c|h[6|a]];case 6:this.frameBuffer[i+5]=this.gbcBGPalette[c|h[5|a]];case 5:this.frameBuffer[i+4]=this.gbcBGPalette[c|h[4|a]];case 4:this.frameBuffer[i+3]=this.gbcBGPalette[c|h[3|a]];case 3:this.frameBuffer[i+2]=this.gbcBGPalette[c|h[2|a]];case 2:this.frameBuffer[i+1]=this.gbcBGPalette[c|h[1|a]];case 1:this.frameBuffer[i]=this.gbcBGPalette[c|h[a]]}}}}},GameBoyCore.prototype.SpriteGBLayerRender=function(e){if(this.gfxSpriteShow){for(var t=e+16,r=65024,i=0,s=1,a=0,n=0,$=0,o=0,h=null,c=0,F=0,m=0,l=0,x=0;s<168;)this.sortBuffer[s++]=255;if(this.gfxSpriteNormalHeight)for(var m=this.findLowestSpriteDrawable(t,7);F<m;++F)for(r=this.OAMAddressCache[F],i=t-this.memory[r]<<3,o=(16&($=this.memory[3|r]))>>2,h=this.tileCache[(96&$)<<4|this.memory[2|r]],n=Math.min(168-(x=a=this.memory[1|r]),8),s=x>7?0:8-x,l=this.pixelStart+(x>8?x-8:0);s<n;++s,++l,++x)this.sortBuffer[x]>a&&(this.frameBuffer[l]>=33554432?(c=h[i|s])>0&&(this.frameBuffer[l]=this.OBJPalette[o|c],this.sortBuffer[x]=a):this.frameBuffer[l]<16777216&&(c=h[i|s])>0&&$<128&&(this.frameBuffer[l]=this.OBJPalette[o|c],this.sortBuffer[x]=a));else for(var m=this.findLowestSpriteDrawable(t,15);F<m;++F)for(r=this.OAMAddressCache[F],i=t-this.memory[r]<<3,o=(16&($=this.memory[3|r]))>>2,h=(64&$)==(64&i)?this.tileCache[(96&$)<<4|254&this.memory[2|r]]:this.tileCache[(96&$)<<4|this.memory[2|r]|1],i&=63,n=Math.min(168-(x=a=this.memory[1|r]),8),s=x>7?0:8-x,l=this.pixelStart+(x>8?x-8:0);s<n;++s,++l,++x)this.sortBuffer[x]>a&&(this.frameBuffer[l]>=33554432?(c=h[i|s])>0&&(this.frameBuffer[l]=this.OBJPalette[o|c],this.sortBuffer[x]=a):this.frameBuffer[l]<16777216&&(c=h[i|s])>0&&$<128&&(this.frameBuffer[l]=this.OBJPalette[o|c],this.sortBuffer[x]=a))}},GameBoyCore.prototype.findLowestSpriteDrawable=function(e,t){for(var r=65024,i=0,s=0;r<65184&&i<10;)((s=e-this.memory[r])&t)==s&&(this.OAMAddressCache[i++]=r),r+=4;return i},GameBoyCore.prototype.SpriteGBCLayerRender=function(e){if(this.gfxSpriteShow){var t=65024,r=e+16,i=0,s=0,a=0,n=0,$=0,o=0,h=null,c=0,F=0,m=0;if(this.gfxSpriteNormalHeight){for(;t<65184&&m<10;t+=4)if((7&(i=r-this.memory[t]))==i){for(a=Math.min(160,(s=this.memory[1|t]-8)+8),o=(7&($=this.memory[3|t]))<<2,h=this.tileCache[(8&$)<<8|(96&$)<<4|this.memory[2|t]],n=s>0?s:0,s-=i<<3,F=this.pixelStart+n;n<a;++n,++F)this.frameBuffer[F]>=33554432?(c=h[n-s])>0&&(this.frameBuffer[F]=this.gbcOBJPalette[o|c]):this.frameBuffer[F]<16777216&&(c=h[n-s])>0&&$<128&&(this.frameBuffer[F]=this.gbcOBJPalette[o|c]);++m}}else for(;t<65184&&m<10;t+=4)if((15&(i=r-this.memory[t]))==i){for(a=Math.min(160,(s=this.memory[1|t]-8)+8),o=(7&($=this.memory[3|t]))<<2,h=(64&$)==(64&i<<3)?this.tileCache[(8&$)<<8|(96&$)<<4|254&this.memory[2|t]]:this.tileCache[(8&$)<<8|(96&$)<<4|this.memory[2|t]|1],n=s>0?s:0,s-=(7&i)<<3,F=this.pixelStart+n;n<a;++n,++F)this.frameBuffer[F]>=33554432?(c=h[n-s])>0&&(this.frameBuffer[F]=this.gbcOBJPalette[o|c]):this.frameBuffer[F]<16777216&&(c=h[n-s])>0&&$<128&&(this.frameBuffer[F]=this.gbcOBJPalette[o|c]);++m}}},GameBoyCore.prototype.generateGBTileLine=function(e){var t=this.memory[1|e]<<8|this.memory[40958&e],r=this.tileCache[(8176&e)>>4];r[7|(e=(14&e)<<2)]=(256&t)>>7|1&t,r[6|e]=(512&t)>>8|(2&t)>>1,r[5|e]=(1024&t)>>9|(4&t)>>2,r[4|e]=(2048&t)>>10|(8&t)>>3,r[3|e]=(4096&t)>>11|(16&t)>>4,r[2|e]=(8192&t)>>12|(32&t)>>5,r[1|e]=(16384&t)>>13|(64&t)>>6,r[e]=(32768&t)>>14|(128&t)>>7},GameBoyCore.prototype.generateGBCTileLineBank1=function(e){var t=this.memory[1|e]<<8|this.memory[40958&e];e&=8190;var r=this.tileCache[e>>4],i=this.tileCache[512|e>>4],s=this.tileCache[1024|e>>4],a=this.tileCache[1536|e>>4],n=56-(e=(14&e)<<2);a[n]=i[e]=s[7|n]=r[7|e]=(256&t)>>7|1&t,a[1|n]=i[1|e]=s[6|n]=r[6|e]=(512&t)>>8|(2&t)>>1,a[2|n]=i[2|e]=s[5|n]=r[5|e]=(1024&t)>>9|(4&t)>>2,a[3|n]=i[3|e]=s[4|n]=r[4|e]=(2048&t)>>10|(8&t)>>3,a[4|n]=i[4|e]=s[3|n]=r[3|e]=(4096&t)>>11|(16&t)>>4,a[5|n]=i[5|e]=s[2|n]=r[2|e]=(8192&t)>>12|(32&t)>>5,a[6|n]=i[6|e]=s[1|n]=r[1|e]=(16384&t)>>13|(64&t)>>6,a[7|n]=i[7|e]=s[n]=r[e]=(32768&t)>>14|(128&t)>>7},GameBoyCore.prototype.generateGBCTileBank1=function(e){var t=e>>4,r=this.tileCache[t],i=this.tileCache[512|t],s=this.tileCache[1024|t],a=this.tileCache[1536|t],n=0;e|=32768,t=0;var $=56;do n=this.memory[1|e]<<8|this.memory[e],a[$]=i[t]=s[7|$]=r[7|t]=(256&n)>>7|1&n,a[1|$]=i[1|t]=s[6|$]=r[6|t]=(512&n)>>8|(2&n)>>1,a[2|$]=i[2|t]=s[5|$]=r[5|t]=(1024&n)>>9|(4&n)>>2,a[3|$]=i[3|t]=s[4|$]=r[4|t]=(2048&n)>>10|(8&n)>>3,a[4|$]=i[4|t]=s[3|$]=r[3|t]=(4096&n)>>11|(16&n)>>4,a[5|$]=i[5|t]=s[2|$]=r[2|t]=(8192&n)>>12|(32&n)>>5,a[6|$]=i[6|t]=s[1|$]=r[1|t]=(16384&n)>>13|(64&n)>>6,a[7|$]=i[7|t]=s[$]=r[t]=(32768&n)>>14|(128&n)>>7,t+=8,$-=8,e+=2;while($>-1)},GameBoyCore.prototype.generateGBCTileLineBank2=function(e){var t=this.VRAM[1|e]<<8|this.VRAM[8190&e],r=this.tileCache[2048|e>>4],i=this.tileCache[2560|e>>4],s=this.tileCache[3072|e>>4],a=this.tileCache[3584|e>>4],n=56-(e=(14&e)<<2);a[n]=i[e]=s[7|n]=r[7|e]=(256&t)>>7|1&t,a[1|n]=i[1|e]=s[6|n]=r[6|e]=(512&t)>>8|(2&t)>>1,a[2|n]=i[2|e]=s[5|n]=r[5|e]=(1024&t)>>9|(4&t)>>2,a[3|n]=i[3|e]=s[4|n]=r[4|e]=(2048&t)>>10|(8&t)>>3,a[4|n]=i[4|e]=s[3|n]=r[3|e]=(4096&t)>>11|(16&t)>>4,a[5|n]=i[5|e]=s[2|n]=r[2|e]=(8192&t)>>12|(32&t)>>5,a[6|n]=i[6|e]=s[1|n]=r[1|e]=(16384&t)>>13|(64&t)>>6,a[7|n]=i[7|e]=s[n]=r[e]=(32768&t)>>14|(128&t)>>7},GameBoyCore.prototype.generateGBCTileBank2=function(e){var t=e>>4,r=this.tileCache[2048|t],i=this.tileCache[2560|t],s=this.tileCache[3072|t],a=this.tileCache[3584|t],n=0;t=0;var $=56;do n=this.VRAM[1|e]<<8|this.VRAM[e],a[$]=i[t]=s[7|$]=r[7|t]=(256&n)>>7|1&n,a[1|$]=i[1|t]=s[6|$]=r[6|t]=(512&n)>>8|(2&n)>>1,a[2|$]=i[2|t]=s[5|$]=r[5|t]=(1024&n)>>9|(4&n)>>2,a[3|$]=i[3|t]=s[4|$]=r[4|t]=(2048&n)>>10|(8&n)>>3,a[4|$]=i[4|t]=s[3|$]=r[3|t]=(4096&n)>>11|(16&n)>>4,a[5|$]=i[5|t]=s[2|$]=r[2|t]=(8192&n)>>12|(32&n)>>5,a[6|$]=i[6|t]=s[1|$]=r[1|t]=(16384&n)>>13|(64&n)>>6,a[7|$]=i[7|t]=s[$]=r[t]=(32768&n)>>14|(128&n)>>7,t+=8,$-=8,e+=2;while($>-1)},GameBoyCore.prototype.generateGBOAMTileLine=function(e){var t=this.memory[1|e]<<8|this.memory[40958&e];e&=8190;var r=this.tileCache[e>>4],i=this.tileCache[512|e>>4],s=this.tileCache[1024|e>>4],a=this.tileCache[1536|e>>4],n=56-(e=(14&e)<<2);a[n]=i[e]=s[7|n]=r[7|e]=(256&t)>>7|1&t,a[1|n]=i[1|e]=s[6|n]=r[6|e]=(512&t)>>8|(2&t)>>1,a[2|n]=i[2|e]=s[5|n]=r[5|e]=(1024&t)>>9|(4&t)>>2,a[3|n]=i[3|e]=s[4|n]=r[4|e]=(2048&t)>>10|(8&t)>>3,a[4|n]=i[4|e]=s[3|n]=r[3|e]=(4096&t)>>11|(16&t)>>4,a[5|n]=i[5|e]=s[2|n]=r[2|e]=(8192&t)>>12|(32&t)>>5,a[6|n]=i[6|e]=s[1|n]=r[1|e]=(16384&t)>>13|(64&t)>>6,a[7|n]=i[7|e]=s[n]=r[e]=(32768&t)>>14|(128&t)>>7},GameBoyCore.prototype.graphicsJIT=function(){this.LCDisOn&&(this.totalLinesPassed=0,this.graphicsJITScanlineGroup())},GameBoyCore.prototype.graphicsJITVBlank=function(){this.totalLinesPassed+=this.queuedScanLines,this.graphicsJITScanlineGroup()},GameBoyCore.prototype.graphicsJITScanlineGroup=function(){for(;this.queuedScanLines>0;)this.renderScanLine(this.lastUnrenderedLine),this.lastUnrenderedLine<143?++this.lastUnrenderedLine:this.lastUnrenderedLine=0,--this.queuedScanLines},GameBoyCore.prototype.incrementScanLineQueue=function(){this.queuedScanLines<144?++this.queuedScanLines:(this.currentX=0,this.midScanlineOffset=-1,this.lastUnrenderedLine<143?++this.lastUnrenderedLine:this.lastUnrenderedLine=0)},GameBoyCore.prototype.midScanLineJIT=function(){this.graphicsJIT(),this.renderMidScanLine()},GameBoyCore.prototype.launchIRQ=function(){var e=0,t=1;do{if((t&this.IRQLineMatched)==t){this.IME=!1,this.interruptsRequested-=t,this.IRQLineMatched=0,this.CPUTicks=20,this.stackPointer=this.stackPointer-1&65535,this.memoryWriter[this.stackPointer](this,this.stackPointer,this.programCounter>>8),this.stackPointer=this.stackPointer-1&65535,this.memoryWriter[this.stackPointer](this,this.stackPointer,255&this.programCounter),this.programCounter=64|e<<3,this.updateCore();return}t=1<<++e}while(e<5)},GameBoyCore.prototype.checkIRQMatching=function(){this.IME&&(this.IRQLineMatched=this.interruptsEnabled&this.interruptsRequested&31)},GameBoyCore.prototype.calculateHALTPeriod=function(){if(this.halt)var e=this.remainingClocks;else{this.halt=!0;var e=-1,t=0;this.LCDisOn&&((1&this.interruptsEnabled)==1&&(e=456*((1==this.modeSTAT?298:144)-this.actualScanLine)-this.LCDTicks<<this.doubleSpeedShifter),(2&this.interruptsEnabled)==2&&(this.mode0TriggerSTAT&&((t=this.clocksUntilMode0()-this.LCDTicks<<this.doubleSpeedShifter)<=e||-1==e)&&(e=t),this.mode1TriggerSTAT&&(1&this.interruptsEnabled)==0&&((t=456*((1==this.modeSTAT?298:144)-this.actualScanLine)-this.LCDTicks<<this.doubleSpeedShifter)<=e||-1==e)&&(e=t),this.mode2TriggerSTAT&&((t=(this.actualScanLine>=143?456*(154-this.actualScanLine):456)-this.LCDTicks<<this.doubleSpeedShifter)<=e||-1==e)&&(e=t),this.LYCMatchTriggerSTAT&&this.memory[65349]<=153&&((t=this.clocksUntilLYCMatch()-this.LCDTicks<<this.doubleSpeedShifter)<=e||-1==e)&&(e=t))),this.TIMAEnabled&&(4&this.interruptsEnabled)==4&&((t=(256-this.memory[65285])*this.TACClocker-this.timerTicks)<=e||-1==e)&&(e=t),this.serialTimer>0&&(8&this.interruptsEnabled)==8&&(this.serialTimer<=e||-1==e)&&(e=this.serialTimer)}var r=this.CPUCyclesTotal-this.emulatorTicks<<this.doubleSpeedShifter;e>=0?e<=r?(this.CPUTicks=Math.max(e,this.CPUTicks),this.updateCoreFull(),this.halt=!1,this.CPUTicks=0):(this.CPUTicks=Math.max(r,this.CPUTicks),this.remainingClocks=e-this.CPUTicks):this.CPUTicks+=r},GameBoyCore.prototype.memoryRead=function(e){return this.memoryReader[e](this,e)},GameBoyCore.prototype.memoryHighRead=function(e){return this.memoryHighReader[e](this,e)},GameBoyCore.prototype.memoryReadJumpCompile=function(){for(var e=0;e<=65535;e++)if(e<16384)this.memoryReader[e]=this.memoryReadNormal;else if(e<32768)this.memoryReader[e]=this.memoryReadROM;else if(e<38912)this.memoryReader[e]=this.cGBC?this.VRAMDATAReadCGBCPU:this.VRAMDATAReadDMGCPU;else if(e<40960)this.memoryReader[e]=this.cGBC?this.VRAMCHRReadCGBCPU:this.VRAMCHRReadDMGCPU;else if(e>=40960&&e<49152)this.numRAMBanks==1/16&&e<41472||this.numRAMBanks>=1?this.cMBC7?this.memoryReader[e]=this.memoryReadMBC7:this.cMBC3?this.memoryReader[e]=this.memoryReadMBC3:this.memoryReader[e]=this.memoryReadMBC:this.memoryReader[e]=this.memoryReadBAD;else if(e>=49152&&e<57344)!this.cGBC||e<53248?this.memoryReader[e]=this.memoryReadNormal:this.memoryReader[e]=this.memoryReadGBCMemory;else if(e>=57344&&e<65024)!this.cGBC||e<61440?this.memoryReader[e]=this.memoryReadECHONormal:this.memoryReader[e]=this.memoryReadECHOGBCMemory;else if(e<65184)this.memoryReader[e]=this.memoryReadOAM;else if(this.cGBC&&e>=65184&&e<65280)this.memoryReader[e]=this.memoryReadNormal;else if(e>=65280)switch(e){case 65280:this.memoryHighReader[0]=this.memoryReader[65280]=function(e,t){return 192|e.memory[65280]};break;case 65281:this.memoryHighReader[1]=this.memoryReader[65281]=function(e,t){return e.memory[65282]<128?e.memory[65281]:255};break;case 65282:this.cGBC?this.memoryHighReader[2]=this.memoryReader[65282]=function(e,t){return(e.serialTimer<=0?124:252)|e.memory[65282]}:this.memoryHighReader[2]=this.memoryReader[65282]=function(e,t){return(e.serialTimer<=0?126:254)|e.memory[65282]};break;case 65283:this.memoryHighReader[3]=this.memoryReader[65283]=this.memoryReadBAD;break;case 65284:this.memoryHighReader[4]=this.memoryReader[65284]=function(e,t){return e.memory[65284]=e.memory[65284]+(e.DIVTicks>>8)&255,e.DIVTicks&=255,e.memory[65284]};break;case 65285:case 65286:case 65313:case 65314:case 65316:case 65317:case 65349:case 65350:case 65351:case 65352:case 65353:case 65360:case 65361:case 65362:case 65363:case 65364:case 65384:case 65385:case 65386:case 65387:this.memoryHighReader[255&e]=this.memoryHighReadNormal,this.memoryReader[e]=this.memoryReadNormal;break;case 65287:this.memoryHighReader[7]=this.memoryReader[65287]=function(e,t){return 248|e.memory[65287]};break;case 65288:case 65289:case 65290:case 65291:case 65292:case 65293:case 65294:case 65311:case 65312:case 65319:case 65320:case 65321:case 65322:case 65323:case 65324:case 65325:case 65326:case 65327:case 65367:case 65368:case 65369:case 65370:case 65371:case 65372:case 65373:case 65374:case 65375:case 65376:case 65377:case 65378:case 65379:case 65380:case 65381:case 65382:case 65383:case 65389:case 65390:case 65391:case 65400:case 65401:case 65402:case 65403:case 65404:case 65405:case 65406:case 65407:this.memoryHighReader[255&e]=this.memoryReader[e]=this.memoryReadBAD;break;case 65295:this.memoryHighReader[15]=this.memoryReader[65295]=function(e,t){return 224|e.interruptsRequested};break;case 65296:this.memoryHighReader[16]=this.memoryReader[65296]=function(e,t){return 128|e.memory[65296]};break;case 65297:this.memoryHighReader[17]=this.memoryReader[65297]=function(e,t){return 63|e.memory[65297]};break;case 65298:this.memoryHighReader[18]=this.memoryHighReadNormal,this.memoryReader[65298]=this.memoryReadNormal;break;case 65299:this.memoryHighReader[19]=this.memoryReader[65299]=this.memoryReadBAD;break;case 65300:this.memoryHighReader[20]=this.memoryReader[65300]=function(e,t){return 191|e.memory[65300]};break;case 65301:this.memoryHighReader[21]=this.memoryReadBAD,this.memoryReader[65301]=this.memoryReadBAD;break;case 65302:this.memoryHighReader[22]=this.memoryReader[65302]=function(e,t){return 63|e.memory[65302]};break;case 65303:this.memoryHighReader[23]=this.memoryHighReadNormal,this.memoryReader[65303]=this.memoryReadNormal;break;case 65304:this.memoryHighReader[24]=this.memoryReader[65304]=this.memoryReadBAD;break;case 65305:this.memoryHighReader[25]=this.memoryReader[65305]=function(e,t){return 191|e.memory[65305]};break;case 65306:this.memoryHighReader[26]=this.memoryReader[65306]=function(e,t){return 127|e.memory[65306]};break;case 65307:this.memoryHighReader[27]=this.memoryReader[65307]=this.memoryReadBAD;break;case 65308:this.memoryHighReader[28]=this.memoryReader[65308]=function(e,t){return 159|e.memory[65308]};break;case 65309:this.memoryHighReader[29]=this.memoryReader[65309]=this.memoryReadBAD;break;case 65310:this.memoryHighReader[30]=this.memoryReader[65310]=function(e,t){return 191|e.memory[65310]};break;case 65315:this.memoryHighReader[35]=this.memoryReader[65315]=function(e,t){return 191|e.memory[65315]};break;case 65318:this.memoryHighReader[38]=this.memoryReader[65318]=function(e,t){return e.audioJIT(),112|e.memory[65318]};break;case 65328:case 65329:case 65330:case 65331:case 65332:case 65333:case 65334:case 65335:case 65336:case 65337:case 65338:case 65339:case 65340:case 65341:case 65342:case 65343:this.memoryReader[e]=function(e,t){return e.channel3canPlay?e.memory[65280|e.channel3lastSampleLookup>>1]:e.memory[t]},this.memoryHighReader[255&e]=function(e,t){return e.channel3canPlay?e.memory[65280|e.channel3lastSampleLookup>>1]:e.memory[65280|t]};break;case 65344:this.memoryHighReader[64]=this.memoryHighReadNormal,this.memoryReader[65344]=this.memoryReadNormal;break;case 65345:this.memoryHighReader[65]=this.memoryReader[65345]=function(e,t){return 128|e.memory[65345]|e.modeSTAT};break;case 65346:this.memoryHighReader[66]=this.memoryReader[65346]=function(e,t){return e.backgroundY};break;case 65347:this.memoryHighReader[67]=this.memoryReader[65347]=function(e,t){return e.backgroundX};break;case 65348:this.memoryHighReader[68]=this.memoryReader[65348]=function(e,t){return e.LCDisOn?e.memory[65348]:0};break;case 65354:this.memoryHighReader[74]=this.memoryReader[65354]=function(e,t){return e.windowY};break;case 65355:this.memoryHighReader[75]=this.memoryHighReadNormal,this.memoryReader[65355]=this.memoryReadNormal;break;case 65356:this.memoryHighReader[76]=this.memoryReader[65356]=this.memoryReadBAD;break;case 65357:this.memoryHighReader[77]=this.memoryHighReadNormal,this.memoryReader[65357]=this.memoryReadNormal;break;case 65358:this.memoryHighReader[78]=this.memoryReader[65358]=this.memoryReadBAD;break;case 65359:this.memoryHighReader[79]=this.memoryReader[65359]=function(e,t){return e.currVRAMBank};break;case 65365:this.cGBC?this.memoryHighReader[85]=this.memoryReader[65365]=function(e,t){return!e.LCDisOn&&e.hdmaRunning&&(e.DMAWrite((127&e.memory[65365])+1),e.memory[65365]=255,e.hdmaRunning=!1),e.memory[65365]}:(this.memoryReader[65365]=this.memoryReadNormal,this.memoryHighReader[85]=this.memoryHighReadNormal);break;case 65366:this.cGBC?this.memoryHighReader[86]=this.memoryReader[65366]=function(e,t){return 60|(e.memory[65366]>=192?2|193&e.memory[65366]:195&e.memory[65366])}:(this.memoryReader[65366]=this.memoryReadNormal,this.memoryHighReader[86]=this.memoryHighReadNormal);break;case 65388:this.cGBC?this.memoryHighReader[108]=this.memoryReader[65388]=function(e,t){return 254|e.memory[65388]}:this.memoryHighReader[108]=this.memoryReader[65388]=this.memoryReadBAD;break;case 65392:this.cGBC?this.memoryHighReader[112]=this.memoryReader[65392]=function(e,t){return 64|e.memory[65392]}:this.memoryHighReader[112]=this.memoryReader[65392]=this.memoryReadBAD;break;case 65393:this.memoryHighReader[113]=this.memoryReader[65393]=this.memoryReadBAD;break;case 65394:case 65395:this.memoryHighReader[255&e]=this.memoryReader[e]=this.memoryReadNormal;break;case 65396:this.cGBC?this.memoryHighReader[116]=this.memoryReader[65396]=this.memoryReadNormal:this.memoryHighReader[116]=this.memoryReader[65396]=this.memoryReadBAD;break;case 65397:this.memoryHighReader[117]=this.memoryReader[65397]=function(e,t){return 143|e.memory[65397]};break;case 65398:this.memoryHighReader[118]=this.memoryReader[65398]=function(e,t){return e.audioJIT(),e.channel2envelopeVolume<<4|e.channel1envelopeVolume};break;case 65399:this.memoryHighReader[119]=this.memoryReader[65399]=function(e,t){return e.audioJIT(),e.channel4envelopeVolume<<4|e.channel3envelopeVolume};break;case 65535:this.memoryHighReader[255]=this.memoryReader[65535]=function(e,t){return e.interruptsEnabled};break;default:this.memoryReader[e]=this.memoryReadNormal,this.memoryHighReader[255&e]=this.memoryHighReadNormal}else this.memoryReader[e]=this.memoryReadBAD},GameBoyCore.prototype.memoryReadNormal=function(e,t){return e.memory[t]},GameBoyCore.prototype.memoryHighReadNormal=function(e,t){return e.memory[65280|t]},GameBoyCore.prototype.memoryReadROM=function(e,t){return e.ROM[e.currentROMBank+t]},GameBoyCore.prototype.memoryReadMBC=function(e,t){return e.MBCRAMBanksEnabled||settings[10]?e.MBCRam[t+e.currMBCRAMBankPosition]:255},GameBoyCore.prototype.memoryReadMBC7=function(e,t){if(e.MBCRAMBanksEnabled||settings[10])switch(t){case 40960:case 41056:case 41072:case 41088:return 0;case 41040:return e.highY;case 41024:return e.lowY;case 41008:return e.highX;case 40992:return e.lowX;default:return e.MBCRam[t+e.currMBCRAMBankPosition]}return 255},GameBoyCore.prototype.memoryReadMBC3=function(e,t){if(e.MBCRAMBanksEnabled||settings[10])switch(e.currMBCRAMBank){case 0:case 1:case 2:case 3:return e.MBCRam[t+e.currMBCRAMBankPosition];case 8:return e.latchedSeconds;case 9:return e.latchedMinutes;case 10:return e.latchedHours;case 11:return e.latchedLDays;case 12:return(e.RTCDayOverFlow?128:0)+(e.RTCHALT?64:0)+e.latchedHDays}return 255},GameBoyCore.prototype.memoryReadGBCMemory=function(e,t){return e.GBCMemory[t+e.gbcRamBankPosition]},GameBoyCore.prototype.memoryReadOAM=function(e,t){return e.modeSTAT>1?255:e.memory[t]},GameBoyCore.prototype.memoryReadECHOGBCMemory=function(e,t){return e.GBCMemory[t+e.gbcRamBankPositionECHO]},GameBoyCore.prototype.memoryReadECHONormal=function(e,t){return e.memory[t-8192]},GameBoyCore.prototype.memoryReadBAD=function(e,t){return 255},GameBoyCore.prototype.VRAMDATAReadCGBCPU=function(e,t){return e.modeSTAT>2?255:0==e.currVRAMBank?e.memory[t]:e.VRAM[8191&t]},GameBoyCore.prototype.VRAMDATAReadDMGCPU=function(e,t){return e.modeSTAT>2?255:e.memory[t]},GameBoyCore.prototype.VRAMCHRReadCGBCPU=function(e,t){return e.modeSTAT>2?255:e.BGCHRCurrentBank[2047&t]},GameBoyCore.prototype.VRAMCHRReadDMGCPU=function(e,t){return e.modeSTAT>2?255:e.BGCHRBank1[2047&t]},GameBoyCore.prototype.setCurrentMBC1ROMBank=function(){switch(this.ROMBank1offs){case 0:case 32:case 64:case 96:this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge<<14;break;default:this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge-1<<14}},GameBoyCore.prototype.setCurrentMBC2AND3ROMBank=function(){this.currentROMBank=Math.max(this.ROMBank1offs%this.ROMBankEdge-1,0)<<14},GameBoyCore.prototype.setCurrentMBC5ROMBank=function(){this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge-1<<14},GameBoyCore.prototype.memoryWrite=function(e,t){this.memoryWriter[e](this,e,t)},GameBoyCore.prototype.memoryHighWrite=function(e,t){this.memoryHighWriter[e](this,e,t)},GameBoyCore.prototype.memoryWriteJumpCompile=function(){for(var e=0;e<=65535;e++)e<32768?this.cMBC1?e<8192?this.memoryWriter[e]=this.MBCWriteEnable:e<16384?this.memoryWriter[e]=this.MBC1WriteROMBank:e<24576?this.memoryWriter[e]=this.MBC1WriteRAMBank:this.memoryWriter[e]=this.MBC1WriteType:this.cMBC2?e<4096?this.memoryWriter[e]=this.MBCWriteEnable:e>=8448&&e<8704?this.memoryWriter[e]=this.MBC2WriteROMBank:this.memoryWriter[e]=this.cartIgnoreWrite:this.cMBC3?e<8192?this.memoryWriter[e]=this.MBCWriteEnable:e<16384?this.memoryWriter[e]=this.MBC3WriteROMBank:e<24576?this.memoryWriter[e]=this.MBC3WriteRAMBank:this.memoryWriter[e]=this.MBC3WriteRTCLatch:this.cMBC5||this.cRUMBLE||this.cMBC7?e<8192?this.memoryWriter[e]=this.MBCWriteEnable:e<12288?this.memoryWriter[e]=this.MBC5WriteROMBankLow:e<16384?this.memoryWriter[e]=this.MBC5WriteROMBankHigh:e<24576?this.memoryWriter[e]=this.cRUMBLE?this.RUMBLEWriteRAMBank:this.MBC5WriteRAMBank:this.memoryWriter[e]=this.cartIgnoreWrite:this.cHuC3?e<8192?this.memoryWriter[e]=this.MBCWriteEnable:e<16384?this.memoryWriter[e]=this.MBC3WriteROMBank:e<24576?this.memoryWriter[e]=this.HuC3WriteRAMBank:this.memoryWriter[e]=this.cartIgnoreWrite:this.memoryWriter[e]=this.cartIgnoreWrite:e<36864?this.memoryWriter[e]=this.cGBC?this.VRAMGBCDATAWrite:this.VRAMGBDATAWrite:e<38912?this.memoryWriter[e]=this.cGBC?this.VRAMGBCDATAWrite:this.VRAMGBDATAUpperWrite:e<40960?this.memoryWriter[e]=this.cGBC?this.VRAMGBCCHRMAPWrite:this.VRAMGBCHRMAPWrite:e<49152?this.numRAMBanks==1/16&&e<41472||this.numRAMBanks>=1?this.cMBC3?this.memoryWriter[e]=this.memoryWriteMBC3RAM:this.memoryWriter[e]=this.memoryWriteMBCRAM:this.memoryWriter[e]=this.cartIgnoreWrite:e<57344?this.cGBC&&e>=53248?this.memoryWriter[e]=this.memoryWriteGBCRAM:this.memoryWriter[e]=this.memoryWriteNormal:e<65024?this.cGBC&&e>=61440?this.memoryWriter[e]=this.memoryWriteECHOGBCRAM:this.memoryWriter[e]=this.memoryWriteECHONormal:e<=65184?this.memoryWriter[e]=this.memoryWriteOAMRAM:e<65280?this.cGBC?this.memoryWriter[e]=this.memoryWriteNormal:this.memoryWriter[e]=this.cartIgnoreWrite:(this.memoryWriter[e]=this.memoryWriteNormal,this.memoryHighWriter[255&e]=this.memoryHighWriteNormal);this.registerWriteJumpCompile()},GameBoyCore.prototype.MBCWriteEnable=function(e,t,r){e.MBCRAMBanksEnabled=(15&r)==10},GameBoyCore.prototype.MBC1WriteROMBank=function(e,t,r){e.ROMBank1offs=96&e.ROMBank1offs|31&r,e.setCurrentMBC1ROMBank()},GameBoyCore.prototype.MBC1WriteRAMBank=function(e,t,r){e.MBC1Mode?(e.currMBCRAMBank=3&r,e.currMBCRAMBankPosition=(e.currMBCRAMBank<<13)-40960):(e.ROMBank1offs=(3&r)<<5|31&e.ROMBank1offs,e.setCurrentMBC1ROMBank())},GameBoyCore.prototype.MBC1WriteType=function(e,t,r){e.MBC1Mode=(1&r)==1,e.MBC1Mode?(e.ROMBank1offs&=31,e.setCurrentMBC1ROMBank()):(e.currMBCRAMBank=0,e.currMBCRAMBankPosition=-40960)},GameBoyCore.prototype.MBC2WriteROMBank=function(e,t,r){e.ROMBank1offs=15&r,e.setCurrentMBC2AND3ROMBank()},GameBoyCore.prototype.MBC3WriteROMBank=function(e,t,r){e.ROMBank1offs=127&r,e.setCurrentMBC2AND3ROMBank()},GameBoyCore.prototype.MBC3WriteRAMBank=function(e,t,r){e.currMBCRAMBank=r,r<4&&(e.currMBCRAMBankPosition=(e.currMBCRAMBank<<13)-40960)},GameBoyCore.prototype.MBC3WriteRTCLatch=function(e,t,r){0==r?e.RTCisLatched=!1:e.RTCisLatched||(e.RTCisLatched=!0,e.latchedSeconds=0|e.RTCSeconds,e.latchedMinutes=e.RTCMinutes,e.latchedHours=e.RTCHours,e.latchedLDays=255&e.RTCDays,e.latchedHDays=e.RTCDays>>8)},GameBoyCore.prototype.MBC5WriteROMBankLow=function(e,t,r){e.ROMBank1offs=256&e.ROMBank1offs|r,e.setCurrentMBC5ROMBank()},GameBoyCore.prototype.MBC5WriteROMBankHigh=function(e,t,r){e.ROMBank1offs=(1&r)<<8|255&e.ROMBank1offs,e.setCurrentMBC5ROMBank()},GameBoyCore.prototype.MBC5WriteRAMBank=function(e,t,r){e.currMBCRAMBank=15&r,e.currMBCRAMBankPosition=(e.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.RUMBLEWriteRAMBank=function(e,t,r){e.currMBCRAMBank=3&r,e.currMBCRAMBankPosition=(e.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.HuC3WriteRAMBank=function(e,t,r){e.currMBCRAMBank=3&r,e.currMBCRAMBankPosition=(e.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.cartIgnoreWrite=function(e,t,r){},GameBoyCore.prototype.memoryWriteNormal=function(e,t,r){e.memory[t]=r},GameBoyCore.prototype.memoryHighWriteNormal=function(e,t,r){e.memory[65280|t]=r},GameBoyCore.prototype.memoryWriteMBCRAM=function(e,t,r){(e.MBCRAMBanksEnabled||settings[10])&&(e.MBCRam[t+e.currMBCRAMBankPosition]=r)},GameBoyCore.prototype.memoryWriteMBC3RAM=function(e,t,r){if(e.MBCRAMBanksEnabled||settings[10])switch(e.currMBCRAMBank){case 0:case 1:case 2:case 3:e.MBCRam[t+e.currMBCRAMBankPosition]=r;break;case 8:r<60?e.RTCSeconds=r:cout("(Bank #"+e.currMBCRAMBank+") RTC write out of range: "+r,1);break;case 9:r<60?e.RTCMinutes=r:cout("(Bank #"+e.currMBCRAMBank+") RTC write out of range: "+r,1);break;case 10:r<24?e.RTCHours=r:cout("(Bank #"+e.currMBCRAMBank+") RTC write out of range: "+r,1);break;case 11:e.RTCDays=255&r|256&e.RTCDays;break;case 12:e.RTCDayOverFlow=r>127,e.RTCHalt=(64&r)==64,e.RTCDays=(1&r)<<8|255&e.RTCDays;break;default:cout("Invalid MBC3 bank address selected: "+e.currMBCRAMBank,0)}},GameBoyCore.prototype.memoryWriteGBCRAM=function(e,t,r){e.GBCMemory[t+e.gbcRamBankPosition]=r},GameBoyCore.prototype.memoryWriteOAMRAM=function(e,t,r){e.modeSTAT<2&&e.memory[t]!=r&&(e.graphicsJIT(),e.memory[t]=r)},GameBoyCore.prototype.memoryWriteECHOGBCRAM=function(e,t,r){e.GBCMemory[t+e.gbcRamBankPositionECHO]=r},GameBoyCore.prototype.memoryWriteECHONormal=function(e,t,r){e.memory[t-8192]=r},GameBoyCore.prototype.VRAMGBDATAWrite=function(e,t,r){e.modeSTAT<3&&e.memory[t]!=r&&(e.graphicsJIT(),e.memory[t]=r,e.generateGBOAMTileLine(t))},GameBoyCore.prototype.VRAMGBDATAUpperWrite=function(e,t,r){e.modeSTAT<3&&e.memory[t]!=r&&(e.graphicsJIT(),e.memory[t]=r,e.generateGBTileLine(t))},GameBoyCore.prototype.VRAMGBCDATAWrite=function(e,t,r){e.modeSTAT<3&&(0==e.currVRAMBank?e.memory[t]!=r&&(e.graphicsJIT(),e.memory[t]=r,e.generateGBCTileLineBank1(t)):(t&=8191,e.VRAM[t]!=r&&(e.graphicsJIT(),e.VRAM[t]=r,e.generateGBCTileLineBank2(t))))},GameBoyCore.prototype.VRAMGBCHRMAPWrite=function(e,t,r){e.modeSTAT<3&&(t&=2047,e.BGCHRBank1[t]!=r&&(e.graphicsJIT(),e.BGCHRBank1[t]=r))},GameBoyCore.prototype.VRAMGBCCHRMAPWrite=function(e,t,r){e.modeSTAT<3&&(t&=2047,e.BGCHRCurrentBank[t]!=r&&(e.graphicsJIT(),e.BGCHRCurrentBank[t]=r))},GameBoyCore.prototype.DMAWrite=function(e){this.halt||(this.CPUTicks+=4|e<<5<<this.doubleSpeedShifter);var t=this.memory[65361]<<8|this.memory[65362],r=this.memory[65363]<<8|this.memory[65364],i=this.memoryReader;this.graphicsJIT();var s=this.memory;if(0==this.currVRAMBank)do r<6144?(s[32768|r]=i[t](this,t++),s[32769|r]=i[t](this,t++),s[32770|r]=i[t](this,t++),s[32771|r]=i[t](this,t++),s[32772|r]=i[t](this,t++),s[32773|r]=i[t](this,t++),s[32774|r]=i[t](this,t++),s[32775|r]=i[t](this,t++),s[32776|r]=i[t](this,t++),s[32777|r]=i[t](this,t++),s[32778|r]=i[t](this,t++),s[32779|r]=i[t](this,t++),s[32780|r]=i[t](this,t++),s[32781|r]=i[t](this,t++),s[32782|r]=i[t](this,t++),s[32783|r]=i[t](this,t++),this.generateGBCTileBank1(r),r+=16):(r&=2032,this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),this.BGCHRBank1[r++]=i[t](this,t++),r=r+6144&8176),t&=65520,--e;while(e>0);else{var a=this.VRAM;do r<6144?(a[r]=i[t](this,t++),a[1|r]=i[t](this,t++),a[2|r]=i[t](this,t++),a[3|r]=i[t](this,t++),a[4|r]=i[t](this,t++),a[5|r]=i[t](this,t++),a[6|r]=i[t](this,t++),a[7|r]=i[t](this,t++),a[8|r]=i[t](this,t++),a[9|r]=i[t](this,t++),a[10|r]=i[t](this,t++),a[11|r]=i[t](this,t++),a[12|r]=i[t](this,t++),a[13|r]=i[t](this,t++),a[14|r]=i[t](this,t++),a[15|r]=i[t](this,t++),this.generateGBCTileBank2(r),r+=16):(r&=2032,this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),this.BGCHRBank2[r++]=i[t](this,t++),r=r+6144&8176),t&=65520,--e;while(e>0)}s[65361]=t>>8,s[65362]=240&t,s[65363]=r>>8,s[65364]=240&r},GameBoyCore.prototype.registerWriteJumpCompile=function(){this.memoryHighWriter[0]=this.memoryWriter[65280]=function(e,t,r){e.memory[65280]=48&r|((32&r)==0?e.JoyPad>>4:15)&((16&r)==0?15&e.JoyPad:15)},this.memoryHighWriter[1]=this.memoryWriter[65281]=function(e,t,r){e.memory[65282]<128&&(e.memory[65281]=r)},this.memoryHighWriter[2]=this.memoryHighWriteNormal,this.memoryWriter[65282]=this.memoryWriteNormal,this.memoryHighWriter[3]=this.memoryWriter[65283]=this.cartIgnoreWrite,this.memoryHighWriter[4]=this.memoryWriter[65284]=function(e,t,r){e.DIVTicks&=255,e.memory[65284]=0},this.memoryHighWriter[5]=this.memoryWriter[65285]=function(e,t,r){e.memory[65285]=r},this.memoryHighWriter[6]=this.memoryWriter[65286]=function(e,t,r){e.memory[65286]=r},this.memoryHighWriter[7]=this.memoryWriter[65287]=function(e,t,r){e.memory[65287]=7&r,e.TIMAEnabled=(4&r)==4,e.TACClocker=Math.pow(4,(3&r)!=0?3&r:4)<<2},this.memoryHighWriter[8]=this.memoryWriter[65288]=this.cartIgnoreWrite,this.memoryHighWriter[9]=this.memoryWriter[65289]=this.cartIgnoreWrite,this.memoryHighWriter[10]=this.memoryWriter[65290]=this.cartIgnoreWrite,this.memoryHighWriter[11]=this.memoryWriter[65291]=this.cartIgnoreWrite,this.memoryHighWriter[12]=this.memoryWriter[65292]=this.cartIgnoreWrite,this.memoryHighWriter[13]=this.memoryWriter[65293]=this.cartIgnoreWrite,this.memoryHighWriter[14]=this.memoryWriter[65294]=this.cartIgnoreWrite,this.memoryHighWriter[15]=this.memoryWriter[65295]=function(e,t,r){e.interruptsRequested=r,e.checkIRQMatching()},this.memoryHighWriter[16]=this.memoryWriter[65296]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel1decreaseSweep&&(8&r)==0&&e.channel1Swept&&(e.channel1SweepFault=!0),e.channel1lastTimeSweep=(112&r)>>4,e.channel1frequencySweepDivider=7&r,e.channel1decreaseSweep=(8&r)==8,e.memory[65296]=r,e.channel1EnableCheck())},this.memoryHighWriter[17]=this.memoryWriter[65297]=function(e,t,r){(e.soundMasterEnabled||!e.cGBC)&&(e.soundMasterEnabled?e.audioJIT():r&=63,e.channel1CachedDuty=e.dutyLookup[r>>6],e.channel1totalLength=64-(63&r),e.memory[65297]=r,e.channel1EnableCheck())},this.memoryHighWriter[18]=this.memoryWriter[65298]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel1Enabled&&0==e.channel1envelopeSweeps&&(((e.memory[65298]^r)&8)==8?((8&e.memory[65298])==0&&((7&e.memory[65298])==7?e.channel1envelopeVolume+=2:++e.channel1envelopeVolume),e.channel1envelopeVolume=16-e.channel1envelopeVolume&15):(15&e.memory[65298])==8&&(e.channel1envelopeVolume=1+e.channel1envelopeVolume&15),e.channel1OutputLevelCache()),e.channel1envelopeType=(8&r)==8,e.memory[65298]=r,e.channel1VolumeEnableCheck())},this.memoryHighWriter[19]=this.memoryWriter[65299]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel1frequency=1792&e.channel1frequency|r,e.channel1FrequencyTracker=2048-e.channel1frequency<<2)},this.memoryHighWriter[20]=this.memoryWriter[65300]=function(e,t,r){if(e.soundMasterEnabled){if(e.audioJIT(),e.channel1consecutive=(64&r)==0,e.channel1frequency=(7&r)<<8|255&e.channel1frequency,e.channel1FrequencyTracker=2048-e.channel1frequency<<2,r>127){e.channel1timeSweep=e.channel1lastTimeSweep,e.channel1Swept=!1;var i=e.memory[65298];e.channel1envelopeVolume=i>>4,e.channel1OutputLevelCache(),e.channel1envelopeSweepsLast=(7&i)-1,0==e.channel1totalLength&&(e.channel1totalLength=64),e.channel1lastTimeSweep>0||e.channel1frequencySweepDivider>0?e.memory[65318]|=1:e.memory[65318]&=254,(64&r)==64&&(e.memory[65318]|=1),e.channel1ShadowFrequency=e.channel1frequency,e.channel1SweepFault=!1,e.channel1AudioSweepPerformDummy()}e.channel1EnableCheck(),e.memory[65300]=r}},this.memoryHighWriter[21]=this.memoryWriter[65301]=this.cartIgnoreWrite,this.memoryHighWriter[22]=this.memoryWriter[65302]=function(e,t,r){(e.soundMasterEnabled||!e.cGBC)&&(e.soundMasterEnabled?e.audioJIT():r&=63,e.channel2CachedDuty=e.dutyLookup[r>>6],e.channel2totalLength=64-(63&r),e.memory[65302]=r,e.channel2EnableCheck())},this.memoryHighWriter[23]=this.memoryWriter[65303]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel2Enabled&&0==e.channel2envelopeSweeps&&(((e.memory[65303]^r)&8)==8?((8&e.memory[65303])==0&&((7&e.memory[65303])==7?e.channel2envelopeVolume+=2:++e.channel2envelopeVolume),e.channel2envelopeVolume=16-e.channel2envelopeVolume&15):(15&e.memory[65303])==8&&(e.channel2envelopeVolume=1+e.channel2envelopeVolume&15),e.channel2OutputLevelCache()),e.channel2envelopeType=(8&r)==8,e.memory[65303]=r,e.channel2VolumeEnableCheck())},this.memoryHighWriter[24]=this.memoryWriter[65304]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel2frequency=1792&e.channel2frequency|r,e.channel2FrequencyTracker=2048-e.channel2frequency<<2)},this.memoryHighWriter[25]=this.memoryWriter[65305]=function(e,t,r){if(e.soundMasterEnabled){if(e.audioJIT(),r>127){var i=e.memory[65303];e.channel2envelopeVolume=i>>4,e.channel2OutputLevelCache(),e.channel2envelopeSweepsLast=(7&i)-1,0==e.channel2totalLength&&(e.channel2totalLength=64),(64&r)==64&&(e.memory[65318]|=2)}e.channel2consecutive=(64&r)==0,e.channel2frequency=(7&r)<<8|255&e.channel2frequency,e.channel2FrequencyTracker=2048-e.channel2frequency<<2,e.memory[65305]=r,e.channel2EnableCheck()}},this.memoryHighWriter[26]=this.memoryWriter[65306]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),!e.channel3canPlay&&r>=128&&(e.channel3lastSampleLookup=0,e.channel3UpdateCache()),e.channel3canPlay=r>127,e.channel3canPlay&&e.memory[65306]>127&&!e.channel3consecutive&&(e.memory[65318]|=4),e.memory[65306]=r)},this.memoryHighWriter[27]=this.memoryWriter[65307]=function(e,t,r){(e.soundMasterEnabled||!e.cGBC)&&(e.soundMasterEnabled&&e.audioJIT(),e.channel3totalLength=256-r,e.channel3EnableCheck())},this.memoryHighWriter[28]=this.memoryWriter[65308]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),r&=96,e.memory[65308]=r,e.channel3patternType=0==r?4:(r>>5)-1)},this.memoryHighWriter[29]=this.memoryWriter[65309]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel3frequency=1792&e.channel3frequency|r,e.channel3FrequencyPeriod=2048-e.channel3frequency<<1)},this.memoryHighWriter[30]=this.memoryWriter[65310]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),r>127&&(0==e.channel3totalLength&&(e.channel3totalLength=256),e.channel3lastSampleLookup=0,(64&r)==64&&(e.memory[65318]|=4)),e.channel3consecutive=(64&r)==0,e.channel3frequency=(7&r)<<8|255&e.channel3frequency,e.channel3FrequencyPeriod=2048-e.channel3frequency<<1,e.memory[65310]=r,e.channel3EnableCheck())},this.memoryHighWriter[31]=this.memoryWriter[65311]=this.cartIgnoreWrite,this.memoryHighWriter[32]=this.memoryWriter[65312]=function(e,t,r){(e.soundMasterEnabled||!e.cGBC)&&(e.soundMasterEnabled&&e.audioJIT(),e.channel4totalLength=64-(63&r),e.channel4EnableCheck())},this.memoryHighWriter[33]=this.memoryWriter[65313]=function(e,t,r){e.soundMasterEnabled&&(e.audioJIT(),e.channel4Enabled&&0==e.channel4envelopeSweeps&&(((e.memory[65313]^r)&8)==8?((8&e.memory[65313])==0&&((7&e.memory[65313])==7?e.channel4envelopeVolume+=2:++e.channel4envelopeVolume),e.channel4envelopeVolume=16-e.channel4envelopeVolume&15):(15&e.memory[65313])==8&&(e.channel4envelopeVolume=1+e.channel4envelopeVolume&15),e.channel4currentVolume=e.channel4envelopeVolume<<e.channel4VolumeShifter),e.channel4envelopeType=(8&r)==8,e.memory[65313]=r,e.channel4UpdateCache(),e.channel4VolumeEnableCheck())},this.memoryHighWriter[34]=this.memoryWriter[65314]=function(e,t,r){if(e.soundMasterEnabled){e.audioJIT(),e.channel4FrequencyPeriod=Math.max((7&r)<<4,8)<<(r>>4);var i=8&r;(8==i&&32767==e.channel4BitRange||0==i&&127==e.channel4BitRange)&&(e.channel4lastSampleLookup=0,e.channel4BitRange=8==i?127:32767,e.channel4VolumeShifter=8==i?7:15,e.channel4currentVolume=e.channel4envelopeVolume<<e.channel4VolumeShifter,e.noiseSampleTable=8==i?e.LSFR7Table:e.LSFR15Table),e.memory[65314]=r,e.channel4UpdateCache()}},this.memoryHighWriter[35]=this.memoryWriter[65315]=function(e,t,r){if(e.soundMasterEnabled){if(e.audioJIT(),e.memory[65315]=r,e.channel4consecutive=(64&r)==0,r>127){var i=e.memory[65313];e.channel4envelopeVolume=i>>4,e.channel4currentVolume=e.channel4envelopeVolume<<e.channel4VolumeShifter,e.channel4envelopeSweepsLast=(7&i)-1,0==e.channel4totalLength&&(e.channel4totalLength=64),(64&r)==64&&(e.memory[65318]|=8)}e.channel4EnableCheck()}},this.memoryHighWriter[36]=this.memoryWriter[65316]=function(e,t,r){e.soundMasterEnabled&&e.memory[65316]!=r&&(e.audioJIT(),e.memory[65316]=r,e.VinLeftChannelMasterVolume=(r>>4&7)+1,e.VinRightChannelMasterVolume=(7&r)+1,e.mixerOutputLevelCache())},this.memoryHighWriter[37]=this.memoryWriter[65317]=function(e,t,r){e.soundMasterEnabled&&e.memory[65317]!=r&&(e.audioJIT(),e.memory[65317]=r,e.rightChannel1=(1&r)==1,e.rightChannel2=(2&r)==2,e.rightChannel3=(4&r)==4,e.rightChannel4=(8&r)==8,e.leftChannel1=(16&r)==16,e.leftChannel2=(32&r)==32,e.leftChannel3=(64&r)==64,e.leftChannel4=r>127,e.channel1OutputLevelCache(),e.channel2OutputLevelCache(),e.channel3OutputLevelCache(),e.channel4OutputLevelCache())},this.memoryHighWriter[38]=this.memoryWriter[65318]=function(e,t,r){if(e.audioJIT(),!e.soundMasterEnabled&&r>127)e.memory[65318]=128,e.soundMasterEnabled=!0,e.initializeAudioStartState();else if(e.soundMasterEnabled&&r<128){e.memory[65318]=0,e.soundMasterEnabled=!1;for(var i=65296;i<65318;i++)e.memoryWriter[i](e,i,0)}},this.memoryHighWriter[39]=this.memoryWriter[65319]=this.cartIgnoreWrite,this.memoryHighWriter[40]=this.memoryWriter[65320]=this.cartIgnoreWrite,this.memoryHighWriter[41]=this.memoryWriter[65321]=this.cartIgnoreWrite,this.memoryHighWriter[42]=this.memoryWriter[65322]=this.cartIgnoreWrite,this.memoryHighWriter[43]=this.memoryWriter[65323]=this.cartIgnoreWrite,this.memoryHighWriter[44]=this.memoryWriter[65324]=this.cartIgnoreWrite,this.memoryHighWriter[45]=this.memoryWriter[65325]=this.cartIgnoreWrite,this.memoryHighWriter[46]=this.memoryWriter[65326]=this.cartIgnoreWrite,this.memoryHighWriter[47]=this.memoryWriter[65327]=this.cartIgnoreWrite,this.memoryHighWriter[48]=this.memoryWriter[65328]=function(e,t,r){e.channel3WriteRAM(0,r)},this.memoryHighWriter[49]=this.memoryWriter[65329]=function(e,t,r){e.channel3WriteRAM(1,r)},this.memoryHighWriter[50]=this.memoryWriter[65330]=function(e,t,r){e.channel3WriteRAM(2,r)},this.memoryHighWriter[51]=this.memoryWriter[65331]=function(e,t,r){e.channel3WriteRAM(3,r)},this.memoryHighWriter[52]=this.memoryWriter[65332]=function(e,t,r){e.channel3WriteRAM(4,r)},this.memoryHighWriter[53]=this.memoryWriter[65333]=function(e,t,r){e.channel3WriteRAM(5,r)},this.memoryHighWriter[54]=this.memoryWriter[65334]=function(e,t,r){e.channel3WriteRAM(6,r)},this.memoryHighWriter[55]=this.memoryWriter[65335]=function(e,t,r){e.channel3WriteRAM(7,r)},this.memoryHighWriter[56]=this.memoryWriter[65336]=function(e,t,r){e.channel3WriteRAM(8,r)},this.memoryHighWriter[57]=this.memoryWriter[65337]=function(e,t,r){e.channel3WriteRAM(9,r)},this.memoryHighWriter[58]=this.memoryWriter[65338]=function(e,t,r){e.channel3WriteRAM(10,r)},this.memoryHighWriter[59]=this.memoryWriter[65339]=function(e,t,r){e.channel3WriteRAM(11,r)},this.memoryHighWriter[60]=this.memoryWriter[65340]=function(e,t,r){e.channel3WriteRAM(12,r)},this.memoryHighWriter[61]=this.memoryWriter[65341]=function(e,t,r){e.channel3WriteRAM(13,r)},this.memoryHighWriter[62]=this.memoryWriter[65342]=function(e,t,r){e.channel3WriteRAM(14,r)},this.memoryHighWriter[63]=this.memoryWriter[65343]=function(e,t,r){e.channel3WriteRAM(15,r)},this.memoryHighWriter[66]=this.memoryWriter[65346]=function(e,t,r){e.backgroundY!=r&&(e.midScanLineJIT(),e.backgroundY=r)},this.memoryHighWriter[67]=this.memoryWriter[65347]=function(e,t,r){e.backgroundX!=r&&(e.midScanLineJIT(),e.backgroundX=r)},this.memoryHighWriter[68]=this.memoryWriter[65348]=function(e,t,r){e.LCDisOn&&(e.modeSTAT=2,e.midScanlineOffset=-1,e.totalLinesPassed=e.currentX=e.queuedScanLines=e.lastUnrenderedLine=e.LCDTicks=e.STATTracker=e.actualScanLine=e.memory[65348]=0)},this.memoryHighWriter[69]=this.memoryWriter[65349]=function(e,t,r){e.memory[65349]!=r&&(e.memory[65349]=r,e.LCDisOn&&e.matchLYC())},this.memoryHighWriter[74]=this.memoryWriter[65354]=function(e,t,r){e.windowY!=r&&(e.midScanLineJIT(),e.windowY=r)},this.memoryHighWriter[75]=this.memoryWriter[65355]=function(e,t,r){e.memory[65355]!=r&&(e.midScanLineJIT(),e.memory[65355]=r,e.windowX=r-7)},this.memoryHighWriter[114]=this.memoryWriter[65394]=function(e,t,r){e.memory[65394]=r},this.memoryHighWriter[115]=this.memoryWriter[65395]=function(e,t,r){e.memory[65395]=r},this.memoryHighWriter[117]=this.memoryWriter[65397]=function(e,t,r){e.memory[65397]=r},this.memoryHighWriter[118]=this.memoryWriter[65398]=this.cartIgnoreWrite,this.memoryHighWriter[119]=this.memoryWriter[65399]=this.cartIgnoreWrite,this.memoryHighWriter[255]=this.memoryWriter[65535]=function(e,t,r){e.interruptsEnabled=r,e.checkIRQMatching()},this.recompileModelSpecificIOWriteHandling(),this.recompileBootIOWriteHandling()},GameBoyCore.prototype.recompileModelSpecificIOWriteHandling=function(){this.cGBC?(this.memoryHighWriter[2]=this.memoryWriter[65282]=function(e,t,r){(1&r)==1?(e.memory[65282]=127&r,e.serialTimer=(2&r)==0?4096:128,e.serialShiftTimer=e.serialShiftTimerAllocated=(2&r)==0?512:16):(e.memory[65282]=r,e.serialShiftTimer=e.serialShiftTimerAllocated=e.serialTimer=0)},this.memoryHighWriter[64]=this.memoryWriter[65344]=function(e,t,r){if(e.memory[65344]!=r){e.midScanLineJIT();var i=r>127;i!=e.LCDisOn&&(e.LCDisOn=i,e.memory[65345]&=120,e.midScanlineOffset=-1,e.totalLinesPassed=e.currentX=e.queuedScanLines=e.lastUnrenderedLine=e.STATTracker=e.LCDTicks=e.actualScanLine=e.memory[65348]=0,e.LCDisOn?(e.modeSTAT=2,e.matchLYC(),e.LCDCONTROL=e.LINECONTROL):(e.modeSTAT=0,e.LCDCONTROL=e.DISPLAYOFFCONTROL,e.DisplayShowOff()),e.interruptsRequested&=253),e.gfxWindowCHRBankPosition=(64&r)==64?1024:0,e.gfxWindowDisplay=(32&r)==32,e.gfxBackgroundBankOffset=(16&r)==16?0:128,e.gfxBackgroundCHRBankPosition=(8&r)==8?1024:0,e.gfxSpriteNormalHeight=(4&r)==0,e.gfxSpriteShow=(2&r)==2,e.BGPriorityEnabled=(1&r)==1,e.priorityFlaggingPathRebuild(),e.memory[65344]=r}},this.memoryHighWriter[65]=this.memoryWriter[65345]=function(e,t,r){e.LYCMatchTriggerSTAT=(64&r)==64,e.mode2TriggerSTAT=(32&r)==32,e.mode1TriggerSTAT=(16&r)==16,e.mode0TriggerSTAT=(8&r)==8,e.memory[65345]=120&r},this.memoryHighWriter[70]=this.memoryWriter[65350]=function(e,t,r){if(e.memory[65350]=r,r<224){r<<=8,t=65024;var i=e.modeSTAT;e.modeSTAT=0;var s=0;do if((s=e.memoryReader[r](e,r++))!=e.memory[t]){e.modeSTAT=i,e.graphicsJIT(),e.modeSTAT=0,e.memory[t++]=s;break}while(++t<65184);if(t<65184)do e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++);while(t<65184);e.modeSTAT=i}},this.memoryHighWriter[77]=this.memoryWriter[65357]=function(e,t,r){e.memory[65357]=127&r|128&e.memory[65357]},this.memoryHighWriter[79]=this.memoryWriter[65359]=function(e,t,r){e.currVRAMBank=1&r,e.currVRAMBank>0?e.BGCHRCurrentBank=e.BGCHRBank2:e.BGCHRCurrentBank=e.BGCHRBank1},this.memoryHighWriter[81]=this.memoryWriter[65361]=function(e,t,r){e.hdmaRunning||(e.memory[65361]=r)},this.memoryHighWriter[82]=this.memoryWriter[65362]=function(e,t,r){e.hdmaRunning||(e.memory[65362]=240&r)},this.memoryHighWriter[83]=this.memoryWriter[65363]=function(e,t,r){e.hdmaRunning||(e.memory[65363]=31&r)},this.memoryHighWriter[84]=this.memoryWriter[65364]=function(e,t,r){e.hdmaRunning||(e.memory[65364]=240&r)},this.memoryHighWriter[85]=this.memoryWriter[65365]=function(e,t,r){e.hdmaRunning?(128&r)==0?(e.hdmaRunning=!1,e.memory[65365]|=128):e.memory[65365]=127&r:(128&r)==0?(e.DMAWrite((127&r)+1),e.memory[65365]=255):(e.hdmaRunning=!0,e.memory[65365]=127&r)},this.memoryHighWriter[104]=this.memoryWriter[65384]=function(e,t,r){e.memory[65385]=e.gbcBGRawPalette[63&r],e.memory[65384]=r},this.memoryHighWriter[105]=this.memoryWriter[65385]=function(e,t,r){if(e.updateGBCBGPalette(63&e.memory[65384],r),e.memory[65384]>127){var i=e.memory[65384]+1&63;e.memory[65384]=128|i,e.memory[65385]=e.gbcBGRawPalette[i]}else e.memory[65385]=r},this.memoryHighWriter[106]=this.memoryWriter[65386]=function(e,t,r){e.memory[65387]=e.gbcOBJRawPalette[63&r],e.memory[65386]=r},this.memoryHighWriter[107]=this.memoryWriter[65387]=function(e,t,r){if(e.updateGBCOBJPalette(63&e.memory[65386],r),e.memory[65386]>127){var i=e.memory[65386]+1&63;e.memory[65386]=128|i,e.memory[65387]=e.gbcOBJRawPalette[i]}else e.memory[65387]=r},this.memoryHighWriter[112]=this.memoryWriter[65392]=function(e,t,r){var i=e.memory[65361]<<8|e.memory[65362];(!e.hdmaRunning||i<53248||i>=57344)&&(e.gbcRamBank=Math.max(7&r,1),e.gbcRamBankPosition=(e.gbcRamBank-1<<12)-53248,e.gbcRamBankPositionECHO=e.gbcRamBankPosition-8192),e.memory[65392]=r},this.memoryHighWriter[116]=this.memoryWriter[65396]=function(e,t,r){e.memory[65396]=r}):(this.memoryHighWriter[2]=this.memoryWriter[65282]=function(e,t,r){(1&r)==1?(e.memory[65282]=127&r,e.serialTimer=4096,e.serialShiftTimer=e.serialShiftTimerAllocated=512):(e.memory[65282]=r,e.serialShiftTimer=e.serialShiftTimerAllocated=e.serialTimer=0)},this.memoryHighWriter[64]=this.memoryWriter[65344]=function(e,t,r){if(e.memory[65344]!=r){e.midScanLineJIT();var i=r>127;i!=e.LCDisOn&&(e.LCDisOn=i,e.memory[65345]&=120,e.midScanlineOffset=-1,e.totalLinesPassed=e.currentX=e.queuedScanLines=e.lastUnrenderedLine=e.STATTracker=e.LCDTicks=e.actualScanLine=e.memory[65348]=0,e.LCDisOn?(e.modeSTAT=2,e.matchLYC(),e.LCDCONTROL=e.LINECONTROL):(e.modeSTAT=0,e.LCDCONTROL=e.DISPLAYOFFCONTROL,e.DisplayShowOff()),e.interruptsRequested&=253),e.gfxWindowCHRBankPosition=(64&r)==64?1024:0,e.gfxWindowDisplay=(32&r)==32,e.gfxBackgroundBankOffset=(16&r)==16?0:128,e.gfxBackgroundCHRBankPosition=(8&r)==8?1024:0,e.gfxSpriteNormalHeight=(4&r)==0,e.gfxSpriteShow=(2&r)==2,e.bgEnabled=(1&r)==1,e.memory[65344]=r}},this.memoryHighWriter[65]=this.memoryWriter[65345]=function(e,t,r){e.LYCMatchTriggerSTAT=(64&r)==64,e.mode2TriggerSTAT=(32&r)==32,e.mode1TriggerSTAT=(16&r)==16,e.mode0TriggerSTAT=(8&r)==8,e.memory[65345]=120&r,(!e.usedBootROM||!e.usedGBCBootROM)&&e.LCDisOn&&e.modeSTAT<2&&(e.interruptsRequested|=2,e.checkIRQMatching())},this.memoryHighWriter[70]=this.memoryWriter[65350]=function(e,t,r){if(e.memory[65350]=r,r>127&&r<224){r<<=8,t=65024;var i=e.modeSTAT;e.modeSTAT=0;var s=0;do if((s=e.memoryReader[r](e,r++))!=e.memory[t]){e.modeSTAT=i,e.graphicsJIT(),e.modeSTAT=0,e.memory[t++]=s;break}while(++t<65184);if(t<65184)do e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++),e.memory[t++]=e.memoryReader[r](e,r++);while(t<65184);e.modeSTAT=i}},this.memoryHighWriter[71]=this.memoryWriter[65351]=function(e,t,r){e.memory[65351]!=r&&(e.midScanLineJIT(),e.updateGBBGPalette(r),e.memory[65351]=r)},this.memoryHighWriter[72]=this.memoryWriter[65352]=function(e,t,r){e.memory[65352]!=r&&(e.midScanLineJIT(),e.updateGBOBJPalette(0,r),e.memory[65352]=r)},this.memoryHighWriter[73]=this.memoryWriter[65353]=function(e,t,r){e.memory[65353]!=r&&(e.midScanLineJIT(),e.updateGBOBJPalette(4,r),e.memory[65353]=r)},this.memoryHighWriter[77]=this.memoryWriter[65357]=function(e,t,r){e.memory[65357]=r},this.memoryHighWriter[79]=this.memoryWriter[65359]=this.cartIgnoreWrite,this.memoryHighWriter[85]=this.memoryWriter[65365]=this.cartIgnoreWrite,this.memoryHighWriter[104]=this.memoryWriter[65384]=this.cartIgnoreWrite,this.memoryHighWriter[105]=this.memoryWriter[65385]=this.cartIgnoreWrite,this.memoryHighWriter[106]=this.memoryWriter[65386]=this.cartIgnoreWrite,this.memoryHighWriter[107]=this.memoryWriter[65387]=this.cartIgnoreWrite,this.memoryHighWriter[108]=this.memoryWriter[65388]=this.cartIgnoreWrite,this.memoryHighWriter[112]=this.memoryWriter[65392]=this.cartIgnoreWrite,this.memoryHighWriter[116]=this.memoryWriter[65396]=this.cartIgnoreWrite)},GameBoyCore.prototype.recompileBootIOWriteHandling=function(){this.inBootstrap?(this.memoryHighWriter[80]=this.memoryWriter[65360]=function(e,t,r){cout("Boot ROM reads blocked: Bootstrap process has ended.",0),e.inBootstrap=!1,e.disableBootROM(),e.memory[65360]=r},this.cGBC&&(this.memoryHighWriter[108]=this.memoryWriter[65388]=function(e,t,r){e.inBootstrap&&(e.cGBC=(1&r)==0,e.name+e.gameCode+e.ROM[323]=="Game and Watch 50"&&(e.cGBC=!0,cout("Created a boot exception for Game and Watch Gallery 2 (GBC ID byte is wrong on the cartridge).",1)),cout("Booted to GBC Mode: "+e.cGBC,0)),e.memory[65388]=r})):this.memoryHighWriter[80]=this.memoryWriter[65360]=this.cartIgnoreWrite},GameBoyCore.prototype.toTypedArray=function(e,t){try{if(settings[5])return e;if(!e||!e.length)return[];var r=e.length;switch(t){case"uint8":var i=new Uint8Array(r);break;case"int8":var i=new Int8Array(r);break;case"int32":var i=new Int32Array(r);break;case"float32":var i=new Float32Array(r)}for(var s=0;s<r;s++)i[s]=e[s];return i}catch(a){return cout("Could not convert an array to a typed array: "+a.message,1),e}},GameBoyCore.prototype.fromTypedArray=function(e){try{if(!e||!e.length)return[];for(var t=[],r=0;r<e.length;++r)t[r]=e[r];return t}catch(i){return cout("Conversion from a typed array failed: "+i.message,1),e}},GameBoyCore.prototype.getTypedArray=function(e,t,r){try{if(settings[5])throw Error("Settings forced typed arrays to be disabled.");switch(r){case"int8":var i=new Int8Array(e);break;case"uint8":var i=new Uint8Array(e);break;case"int32":var i=new Int32Array(e);break;case"float32":var i=new Float32Array(e)}if(0!=t)for(var s=0;s<e;)i[s++]=t}catch(a){cout("Could not convert an array to a typed array: "+a.message,1);for(var i=[],s=0;s<e;)i[s++]=t}return i};